var ripple=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){function n(t){var r=e[t];Object.keys(r.prototype).forEach(function(t){var e=/([A-Z]{1})[a-z]+/g;if(e.test(t)){var n=t.replace(e,function(t){return"_"+t.toLowerCase()});r.prototype[n]=r.prototype[t]}})}e.Remote=r(1).Remote,e.Request=r(2).Request,e.Amount=r(3).Amount,e.Account=r(4).Account,e.Transaction=r(5).Transaction,e.Currency=r(6).Currency,e.Base=r(7).Base,e.UInt160=r(8).UInt160,e.UInt256=r(9).UInt256,e.Seed=r(10).Seed,e.Meta=r(11).Meta,e.SerializedObject=r(12).SerializedObject,e.RippleError=r(13).RippleError,e.Message=r(14).Message,e.VaultClient=r(15).VaultClient,e.AuthInfo=r(16).AuthInfo,e.RippleTxt=r(17).RippleTxt,e.binformat=r(18),e.utils=r(19),e.Server=r(20).Server,e.Wallet=r(33),e.sjcl=r(19).sjcl,e.config=r(21),["Remote","Request","Transaction","Account","Server"].forEach(n)},function(t,e,r){function n(t){function e(t){"transaction_all"===t&&(!s._transaction_subs&&s._connected&&s.request_subscribe("transactions").request(),s._transaction_subs+=1)}function r(t){"transaction_all"===t&&(s._transaction_subs-=1,!s._transaction_subs&&s._connected&&s.request_unsubscribe("transactions").request())}function n(){var t=s.requestPing();t.on("error",function(){}),t.broadcast()}i.call(this);var s=this,t=t||{};if(this.trusted=Boolean(t.trusted),this.state="offline",this._server_fatal=!1,this.local_sequence=Boolean(t.local_sequence),this.local_fee="boolean"==typeof t.local_fee?t.local_fee:!0,this.local_signing="boolean"==typeof t.local_signing?t.local_signing:!0,this.canonical_signing="boolean"==typeof t.canonical_signing?t.canonical_signing:!0,this.fee_cushion="number"==typeof t.fee_cushion?t.fee_cushion:1.2,this.max_fee="number"==typeof t.max_fee?t.max_fee:1/0,this._ledger_current_index=void 0,this._ledger_hash=void 0,this._ledger_time=void 0,this._stand_alone=void 0,this._testnet=void 0,this.trace=Boolean(t.trace),this._transaction_subs=0,this._connection_count=0,this._connected=!1,this._connection_offset=1e3*("number"==typeof t.connection_offset?t.connection_offset:0),this._submission_timeout=1e3*("number"==typeof t.submission_timeout?t.submission_timeout:10),this._received_tx=o({max:100}),this._cur_path_find=null,this.local_signing&&(this.local_sequence=!0,this.local_fee=!0),this._servers=[],this._primary_server=void 0,this.accounts={},this._accounts={},this._books={},this.secrets={},this.ledgers={current:{account_root:{}}},"number"!=typeof this._connection_offset)throw new TypeError('Remote "connection_offset" configuration is not a Number');if("number"!=typeof this._submission_timeout)throw new TypeError('Remote "submission_timeout" configuration is not a Number');if("number"!=typeof this.max_fee)throw new TypeError('Remote "max_fee" configuration is not a Number');if("number"!=typeof this.fee_cushion)throw new TypeError('Remote "fee_cushion" configuration is not a Number');if(!/^(undefined|boolean)$/.test(typeof t.trace))throw new TypeError('Remote "trace" configuration is not a Boolean');if("boolean"!=typeof this.local_signing)throw new TypeError('Remote "local_signing" configuration is not a Boolean');if("boolean"!=typeof this.local_fee)throw new TypeError('Remote "local_fee" configuration is not a Boolean');if("boolean"!=typeof this.local_sequence)throw new TypeError('Remote "local_sequence" configuration is not a Boolean');if(!/^(undefined|number)$/.test(typeof t.ping))throw new TypeError('Remote "ping" configuration is not a Number');if(!/^(undefined|object)$/.test(typeof t.storage))throw new TypeError('Remote "storage" configuration is not an Object');!t.hasOwnProperty("servers")&&t.websocket_ip&&(t.servers=[{host:t.websocket_ip,port:t.websocket_port,secure:t.websocket_ssl,trusted:t.trusted}]),(t.servers||[]).forEach(function(t){for(var e=Number(t.pool)||1;e--;)s.addServer(t)});var a=t.maxListeners||t.max_listeners||0;this._servers.concat(this).forEach(function(t){t instanceof i&&t.setMaxListeners(a)}),this.on("newListener",e),this.on("removeListener",r),t.storage&&(this.storage=t.storage,this.once("connect",this.getPendingTransactions.bind(this))),t.ping&&this.once("connect",function(){s._pingInterval=setInterval(n,1e3*t.ping)})}var i=r(37).EventEmitter,s=r(38),o=r(52),a=r(2).Request,c=r(20).Server,u=r(3).Amount,h=r(6).Currency,f=r(8).UInt160,l=r(5).Transaction,p=r(4).Account,_=r(11).Meta,d=r(22).OrderBook,y=r(23).PathFind,m=r(13).RippleError,v=r(19),g=r(19).sjcl,b=r(21),w=r(24).internal.sub("remote");s.inherits(n,i),n.flags={account_root:{PasswordSpent:65536,RequireDestTag:131072,RequireAuth:262144,DisallowXRP:524288,DisableMaster:1048576},offer:{Passive:65536,Sell:131072},state:{LowReserve:65536,HighReserve:131072,LowAuth:262144,HighAuth:524288,LowNoRipple:1048576,HighNoRipple:2097152}},n.from_config=function(t,e){function r(t){var e=b.accounts[t];"object"==typeof e&&e.secret&&(s.setSecret(t,e.secret),s.setSecret(e.account,e.secret))}var i="string"==typeof t?b.servers[t]:t,s=new n(i,e);return b.accounts&&Object.keys(b.accounts).forEach(r),s},n.isValidMessage=function(t){return"object"==typeof t&&"string"==typeof t.type},n.isValidLedgerData=function(t){return"object"==typeof t&&"number"==typeof t.fee_base&&"number"==typeof t.fee_ref&&"number"==typeof t.fee_base&&"string"==typeof t.ledger_hash&&"number"==typeof t.ledger_index&&"number"==typeof t.ledger_time&&"number"==typeof t.reserve_base&&"number"==typeof t.reserve_inc&&"number"==typeof t.txn_count},n.isValidLoadStatus=function(t){return"number"==typeof t.load_base&&"number"==typeof t.load_factor},n.prototype._setState=function(t){if(this.state!==t)switch(this.trace&&w.info("set_state:",t),this.state=t,this.emit("state",t),t){case"online":this._online_state="open",this._connected=!0,this.emit("connect"),this.emit("connected");break;case"offline":this._online_state="closed",this._connected=!1,this.emit("disconnect"),this.emit("disconnected")}},n.prototype.setServerFatal=function(){this._server_fatal=!0},n.prototype.setTrace=function(t){return this.trace=void 0===t||t,this},n.prototype._trace=function(){this.trace&&w.info.apply(w,arguments)},n.prototype.setSecret=function(t,e){this.secrets[t]=e},n.prototype.getPendingTransactions=function(){function t(t){if("object"==typeof t){var r=e.transaction();r.parseJson(t.tx_json),r.clientID(t.clientID),Object.keys(t).forEach(function(e){switch(e){case"secret":case"submittedIDs":case"submitIndex":r[e]=t[e]}}),r.submit()}}var e=this;this.storage.getPendingTransactions(function(e,r){!e&&Array.isArray(r)&&r.forEach(t)})},n.prototype.addServer=function(t){function e(t){i._handleMessage(t,s)}function r(){i._connection_count+=1,t.primary&&i._setPrimaryServer(s),1===i._connection_count&&i._setState("online"),i._connection_count===i._servers.length&&i.emit("ready")}function n(){i._connection_count--,0===i._connection_count&&i._setState("offline")}var i=this,s=new c(this,t);return s.on("message",e),s.on("connect",r),s.on("disconnect",n),this._servers.push(s),this},n.prototype.connect=function(t){if(!this._servers.length)throw new Error("No servers available.");switch(typeof t){case"undefined":break;case"function":this.once("connect",t);break;default:if(!Boolean(t))return this.disconnect()}var e=this;return function r(t){e._servers[t].connect();var n=r.bind(this,++t);t<e._servers.length&&setTimeout(n,e._connection_offset)}(0),this},n.prototype.disconnect=function(t){if(!this._servers.length)throw new Error("No servers available, not disconnecting");return"function"==typeof t&&this.once("disconnect",t),this._servers.forEach(function(t){t.disconnect()}),this._set_state("offline"),this},n.prototype._handleMessage=function(t){try{t=JSON.parse(t)}catch(e){}if(!n.isValidMessage(t))return void this.emit("error",new m("remoteUnexpected","Unexpected response from remote"));switch(t.type){case"ledgerClosed":this._handleLedgerClosed(t);break;case"serverStatus":this._handleServerStatus(t);break;case"transaction":this._handleTransaction(t);break;case"path_find":this._handlePathFind(t);break;default:this.trace&&w.info(t.type+": ",t)}},n.prototype._handleLedgerClosed=function(t){if(n.isValidLedgerData(t)){var e=t.ledger_index>=this._ledger_current_index;e&&(this._ledger_time=t.ledger_time,this._ledger_hash=t.ledger_hash,this._ledger_current_index=t.ledger_index+1,this.emit("ledger_closed",t))}},n.prototype._handleServerStatus=function(t){this.emit("server_status",t)},n.prototype._handleTransaction=function(t){function e(e){var r=this[e];r&&"function"==typeof r.notify&&r.notify(t)}var r=this,n=t.transaction.hash;if(!this._received_tx.get(n)){t.validated&&this._received_tx.set(n,!0),this.trace&&w.info("tx:",t);var i=t.meta||t.metadata;if(i){t.mmeta=new _(i);var s=t.mmeta.getAffectedAccounts();s.forEach(e.bind(this._accounts));var o=t.mmeta.getAffectedBooks();o.forEach(e.bind(this._books))}else["Account","Destination"].forEach(function(n){e.call(r._accounts,t.transaction[n])});this.emit("transaction",t),this.emit("transaction_all",t)}},n.prototype._handlePathFind=function(t){this._cur_path_find&&this._cur_path_find.notify_update(t),this.emit("path_find_all",t)},n.prototype.getLedgerHash=function(){return this._ledger_hash},n.prototype._setPrimaryServer=n.prototype.setPrimaryServer=function(t){this._primary_server&&(this._primary_server._primary=!1),this._primary_server=t,this._primary_server._primary=!0},n.prototype._getServer=n.prototype.getServer=function(){function t(t,e){var r=t._score+t._fee,n=e._score+e._fee;return r>n?1:n>r?-1:0}if(this._primary_server&&this._primary_server._connected)return this._primary_server;this._servers.sort(t);for(var e=0,r=this._servers[e];!r._connected;)r=this._servers[++e];return r},n.prototype.request=function(t){if("string"==typeof t){if(/^request_/.test(t)||(t="request_"+t),"function"==typeof this[t]){var e=Array.prototype.slice.call(arguments,1);return this[t].apply(this,e)}throw new Error("Command does not exist: "+t)}if(!(t instanceof a))throw new Error("Argument is not a Request");if(this._servers.length)if(this._connected)if(null===t.server)t.emit("error",new Error("Server does not exist"));else{var r=t.server||this.getServer();r?r._request(t):t.emit("error",new Error("No servers available"))}else this.once("connect",this.request.bind(this,t));else t.emit("error",new Error("No servers available"))},n.prototype.ping=n.prototype.requestPing=function(t,e){var r=new a(this,"ping");switch(typeof t){case"function":e=t;break;case"string":r.setServer(t)}var n=Date.now();return r.once("success",function(){r.emit("pong",Date.now()-n)}),r.callback(e,"pong"),r},n.prototype.requestServerInfo=function(t){return new a(this,"server_info").callback(t)},n.prototype.requestLedger=function(t,e,r){var n=new a(this,"ledger");switch(t&&(n.message.ledger=t),typeof e){case"object":Object.keys(e).forEach(function(t){switch(t){case"full":case"expand":case"transactions":case"accounts":n.message[t]=!0}},e);break;case"function":r=e,e=void 0;break;default:this.trace&&w.info("request_ledger: full parameter is deprecated"),n.message.full=!0}return n.callback(r),n},n.prototype.requestLedgerClosed=n.prototype.requestLedgerHash=function(t){return new a(this,"ledger_closed").callback(t)},n.prototype.requestLedgerHeader=function(t){return new a(this,"ledger_header").callback(t)},n.prototype.requestLedgerCurrent=function(t){return new a(this,"ledger_current").callback(t)},n.prototype.requestLedgerEntry=function(t,e){var r=this,n=new a(this,"ledger_entry");return"function"==typeof t&&(e=t),"account_root"===t&&(n.request_default=n.request,n.request=function(){var e=!0;if(!r._ledger_hash&&"account_root"===t){var i=r.ledgers.current.account_root;i||(i=r.ledgers.current.account_root={});var s=r.ledgers.current.account_root[n.message.account_root];if(s)n.emit("success",{node:s}),e=!1;else switch(t){case"account_root":n.once("success",function(t){r.ledgers.current.account_root[t.node.Account]=t.node})}}e&&n.request_default()}),n.callback(e),n},n.prototype.requestSubscribe=function(t,e){var r=new a(this,"subscribe");return t&&(r.message.streams=Array.isArray(t)?t:[t]),r.callback(e),r},n.prototype.requestUnsubscribe=function(t,e){var r=new a(this,"unsubscribe");return t&&(r.message.streams=Array.isArray(t)?t:[t]),r.callback(e),r},n.prototype.requestTransactionEntry=function(t,e,r){var n=new a(this,"transaction_entry");switch(n.txHash(t),typeof e){case"string":case"number":n.ledgerSelect(e);break;case"undefined":case"function":n.ledgerIndex("validated"),r=e;break;default:throw new Error("Invalid ledger_hash type")}return n.callback(r),n},n.prototype.requestTransaction=n.prototype.requestTx=function(t,e){var r=new a(this,"tx");return r.message.transaction=t,r.callback(e),r},n.accountRequest=function(t,e,r,n,i,s){if("object"==typeof e){var o=e;s=r,n=o.ledger,r=o.account_index||o.accountIndex,e=o.accountID||o.account,i=o.peer}var c=arguments[arguments.length-1];"function"==typeof c&&(s=c);var u=new a(this,t),e=f.json_rewrite(e);return u.message.ident=e,u.message.account=e,"number"==typeof r&&(u.message.index=r),/^(undefined|function)$/.test(typeof n)||u.ledgerChoose(n),/^(undefined|function)$/.test(typeof i)||(u.message.peer=f.json_rewrite(i)),u.callback(s),u},n.prototype.requestAccountInfo=function(){var t=Array.prototype.concat.apply(["account_info"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountCurrencies=function(){var t=Array.prototype.concat.apply(["account_currencies"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountLines=function(){var t=Array.prototype.concat.apply(["account_lines"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountOffers=function(){var t=Array.prototype.concat.apply(["account_offers"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountTransactions=n.prototype.requestAccountTx=function(t,e){function n(t){var e=Object.keys(t);return function(r){var n=e.every(function(e){return r.tx[e]===t[e]});return n}}function i(t){var e={validated:t.validated};return e.meta=new c(t.meta).to_json(),e.tx=new c(t.tx_blob).to_json(),e.tx.ledger_index=t.ledger_index,e.tx.hash=l.from_json(e.tx).hash(),e}function s(e){function r(){var r=n.listeners("success");n.removeAllListeners("success"),n.once("success",function(s){t.parseBinary&&(s.transactions=s.transactions.map(i)),e!==Boolean&&(s.transactions=s.transactions.filter(e)),"function"==typeof t.map&&(s.transactions=s.transactions.map(t.map)),"function"==typeof t.reduce&&(s.transactions=s.transactions.reduce(t.reduce)),"string"==typeof t.pluck&&(s=s[t.pluck]),r.forEach(function(t){t.call(n,s)})})}if("function"!=typeof e)throw new Error("Missing filter function");var n=this;return this.once("request",r),this}var o=new a(this,"account_tx");void 0!==t.min_ledger&&(t.ledger_index_min=t.min_ledger),void 0!==t.max_ledger&&(t.ledger_index_max=t.max_ledger),Object.keys(t).forEach(function(t){switch(t){case"account":case"ledger_index_min":case"ledger_index_max":case"binary":case"count":case"descending":case"offset":case"limit":case"forward":case"marker":o.message[t]=this[t]}},t);var c=r(12).SerializedObject;if(o.filter=s,"boolean"!=typeof t.parseBinary&&(t.parseBinary=!0),(t.binary||t.map||t.reduce)&&(t.filter=t.filter||Boolean),t.filter)switch(t.filter){case"inbound":o.filter(n({Destination:t.account}));break;case"outbound":o.filter(n({Account:t.account}));break;default:"object"==typeof t.filter&&(t.filter=n(t.filter)),o.filter(t.filter)}return o.callback(e),o},n.prototype.requestTxHistory=function(t,e){var r=new a(this,"tx_history");return r.message.start=t,r.callback(e),r},n.prototype.requestBookOffers=function(t,e,r,n){if(t.hasOwnProperty("pays")){var i=t;n=e,r=i.taker,e=i.pays,t=i.gets}var s=arguments[arguments.length-1];"function"==typeof s&&(n=s);var o=new a(this,"book_offers");return o.message.taker_gets={currency:h.json_rewrite(t.currency)},"XRP"!==o.message.taker_gets.currency&&(o.message.taker_gets.issuer=f.json_rewrite(t.issuer)),o.message.taker_pays={currency:h.json_rewrite(e.currency)},"XRP"!==o.message.taker_pays.currency&&(o.message.taker_pays.issuer=f.json_rewrite(e.issuer)),o.message.taker=r?r:f.ACCOUNT_ONE,o.callback(n),o},n.prototype.requestWalletAccounts=function(t,e){v.assert(this.trusted);var r=new a(this,"wallet_accounts");return r.message.seed=t,r.callback(e),r},n.prototype.requestSign=function(t,e,r){v.assert(this.trusted);var n=new a(this,"sign");return n.message.secret=t,n.message.tx_json=e,n.callback(r),n},n.prototype.requestSubmit=function(t){return new a(this,"submit").callback(t)},n.prototype._serverPrepareSubscribe=function(t){function e(t){if(r._stand_alone=!!t.stand_alone,r._testnet=!!t.testnet,"string"==typeof t.random){for(var e=t.random.match(/[0-9A-F]{8}/gi);e&&e.length;)g.random.addEntropy(parseInt(e.pop(),16));r.emit("random",v.hexToArray(t.random))}t.ledger_hash&&t.ledger_index&&(r._ledger_time=t.ledger_time,r._ledger_hash=t.ledger_hash,r._ledger_current_index=t.ledger_index+1,r.emit("ledger_closed",t)),r.emit("subscribed")}var r=this,n=["ledger","server"];this._transaction_subs&&n.push("transactions");var i=this.requestSubscribe(n);return i.once("success",e),r.emit("prepare_subscribe",i),i.callback(t,"subscribed"),i},n.prototype.ledgerAccept=n.prototype.requestLedgerAccept=function(t){if(!this._stand_alone)return void this.emit("error",new m("notStandAlone"));var e=new a(this,"ledger_accept");return this.once("ledger_closed",function(t){e.emit("ledger_closed",t)}),e.callback(t,"ledger_closed"),e.request(),this},n.accountRootRequest=function(t,e,r,n,i){"object"==typeof r&&(i=n,n=r.ledger,r=r.account);var s=arguments[arguments.length-1];"function"==typeof s&&(i=s);var o=this.requestLedgerEntry("account_root");return o.accountRoot(r),o.ledgerChoose(n),o.once("success",function(r){o.emit(t,e(r))}),o.callback(i,t),o},n.prototype.requestAccountBalance=function(){function t(t){return u.from_json(t.node.Balance)}var e=Array.prototype.concat.apply(["account_balance",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.requestAccountFlags=function(){function t(t){return t.node.Flags}var e=Array.prototype.concat.apply(["account_flags",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.requestOwnerCount=function(){function t(t){return t.node.OwnerCount}var e=Array.prototype.concat.apply(["owner_count",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.getAccount=function(t){return this._accounts[f.json_rewrite(t)]},n.prototype.addAccount=function(t){var e=new p(this,t);return e.isValid()&&(this._accounts[t]=e),e},n.prototype.account=n.prototype.findAccount=function(t){var e=this.getAccount(t);return e?e:this.addAccount(t)},n.prototype.pathFind=n.prototype.createPathFind=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.src_currencies,r=i.dst_amount,e=i.dst_account,t=i.src_account}var s=new y(this,t,e,r,n);return this._cur_path_find&&this._cur_path_find.notify_superceded(),s.create(),this._cur_path_find=s,s},n.prepareTrade=function(t,e){return t+("XRP"===t?"":"/"+e)},n.prototype.book=n.prototype.createOrderBook=function(t,e,r,i){if("object"==typeof t){var s=t;i=s.issuer_pays,r=s.currency_pays,e=s.issuer_gets,t=s.currency_gets}var o=n.prepareTrade(t,e),a=n.prepareTrade(r,i),c=o+":"+a;if(this._books.hasOwnProperty(c))return this._books[c];var u=new d(this,t,e,r,i,c);return u.is_valid()&&(this._books[c]=u),u},n.prototype.accountSeq=n.prototype.getAccountSequence=function(t,e){var t=f.json_rewrite(t),r=this.accounts[t];if(r){var n=r.seq,i={ADVANCE:1,REWIND:-1}[e.toUpperCase()]||0;return r.seq+=i,n}},n.prototype.setAccountSeq=function(t,e){var t=f.json_rewrite(t);this.accounts.hasOwnProperty(t)||(this.accounts[t]={}),this.accounts[t].seq=e},n.prototype.accountSeqCache=function(t,e,r){function n(t){delete o.caching_seq_request;var e=t.node.Sequence;o.seq=e,a.emit("success_account_seq_cache",t)}function i(t){delete o.caching_seq_request,a.emit("error_account_seq_cache",t)}if("object"==typeof t){var s=t;r=e,e=s.ledger,t=s.account}this.accounts.hasOwnProperty(t)||(this.accounts[t]={});var o=this.accounts[t],a=o.caching_seq_request;return a||(a=this.requestLedgerEntry("account_root"),a.accountRoot(t),a.ledgerChoose(e),a.once("success",n),a.once("error",i),o.caching_seq_request=a),a.callback(r,"success_account_seq_cache","error_account_seq_cache"),a},n.prototype.dirtyAccountRoot=function(t){var t=f.json_rewrite(t);delete this.ledgers.current.account_root[t]},n.prototype.requestRippleBalance=function(t,e,r,n,i){function s(r){var n=r.node,i=u.from_json(n.LowLimit),s=u.from_json(n.HighLimit),o=u.from_json(n.Balance),c=f.from_json(t).equals(s.issuer());a.emit("ripple_state",{account_balance:(c?o.negate():o.clone()).parse_issuer(t),peer_balance:(c?o.clone():o.negate()).parse_issuer(e),account_limit:(c?s:i).clone().parse_issuer(e),peer_limit:(c?i:s).clone().parse_issuer(t),account_quality_in:c?n.HighQualityIn:n.LowQualityIn,peer_quality_in:c?n.LowQualityIn:n.HighQualityIn,account_quality_out:c?n.HighQualityOut:n.LowQualityOut,peer_quality_out:c?n.LowQualityOut:n.HighQualityOut})}if("object"==typeof t){var o=t;i=e,n=o.ledger,r=o.currency,e=o.issuer,t=o.account}var a=this.requestLedgerEntry("ripple_state");return a.rippleState(t,e,r),a.ledgerChoose(n),a.once("success",s),a.callback(i,"ripple_state"),a},n.prepareCurrencies=function(t){var e={};return t.hasOwnProperty("issuer")&&(e.issuer=f.json_rewrite(t.issuer)),t.hasOwnProperty("currency")&&(e.currency=h.json_rewrite(t.currency)),e},n.prototype.requestRipplePathFind=function(t,e,r,i,s){if("object"==typeof t){var o=t;s=e,i=o.src_currencies,r=o.dst_amount,e=o.dst_account,t=o.src_account}var c=new a(this,"ripple_path_find");return c.message.source_account=f.json_rewrite(t),c.message.destination_account=f.json_rewrite(e),c.message.destination_amount=u.json_rewrite(r),i&&(c.message.source_currencies=i.map(n.prepareCurrencies)),c.callback(s),c},n.prototype.requestPathFindCreate=function(t,e,r,i,s){if("object"==typeof t){var o=t;s=e,i=o.src_currencies,r=o.dst_amount,e=o.dst_account,t=o.src_account}var c=new a(this,"path_find");return c.message.subcommand="create",c.message.source_account=f.json_rewrite(t),c.message.destination_account=f.json_rewrite(e),c.message.destination_amount=u.json_rewrite(r),i&&(c.message.source_currencies=i.map(n.prepareCurrencies)),c.callback(s),c},n.prototype.requestPathFindClose=function(t){var e=new a(this,"path_find");return e.message.subcommand="close",e.callback(t),e},n.prototype.requestUnlList=function(t){return new a(this,"unl_list").callback(t)},n.prototype.requestUnlAdd=function(t,e,r){var n=new a(this,"unl_add");return n.message.node=t,e&&(n.message.comment=void 0),n.callback(r),n},n.prototype.requestUnlDelete=function(t,e){var r=new a(this,"unl_delete");return r.message.node=t,r.callback(e),r},n.prototype.requestPeers=function(t){return new a(this,"peers").callback(t)},n.prototype.requestConnect=function(t,e,r){var n=new a(this,"connect");return n.message.ip=t,e&&(n.message.port=e),n.callback(r),n},n.prototype.transaction=n.prototype.createTransaction=function(t,e){var r,n=new l(this),i={payment:"payment",accountset:"accountSet",trustset:"trustSet",offercreate:"offerCreate",offercancel:"offerCancel",claim:"claim",passwordfund:"passwordFund",passwordset:"passwordSet",setregularkey:"setRegularKey",walletadd:"walletAdd",sign:"sign"};switch(typeof t){case"object":if("string"!=typeof t.type)throw new Error("Missing transaction type");if(r=i[t.type.toLowerCase()],!r)throw new Error("Invalid transaction type: "+r);n=n[r](t);break;case"string":if(r=i[t.toLowerCase()],!r)throw new Error("Invalid transaction type: "+r);n=n[r](e)}var s=arguments[arguments.length-1];return"function"==typeof s&&n.submit(s),n},n.prototype.feeTx=function(t){var e=this._getServer();if(!e)throw new Error("No connected servers");return e._feeTx(t)},n.prototype.feeTxUnit=function(){var t=this._getServer();if(!t)throw new Error("No connected servers");return t._feeTxUnit()},n.prototype.reserve=function(t){var e=this._getServer();if(!e)throw new Error("No connected servers");return e._reserve(t)},e.Remote=n},function(t,e,r){function n(t,e){i.call(this),this.remote=t,this.requested=!1,this.message={command:e,id:void 0}}var i=r(37).EventEmitter,s=r(38),o=r(8).UInt160,a=r(6).Currency,c=r(13).RippleError,u=r(20).Server;s.inherits(n,i),n.prototype.broadcast=function(){return this._broadcast=!0,this.request()},n.prototype.request=function(t){return this.requested?void 0:(this.requested=!0,this.on("error",function(){}),this.emit("request",t),this._broadcast?this.remote._servers.forEach(function(t){this.setServer(t),this.remote.request(this)},this):this.remote.request(this),this)},n.prototype.callback=function(t,e,r){function n(e){o||(o=!0,t.call(s,null,e))}function i(e){o||(o=!0,e instanceof c||(e=new c(e)),t.call(s,e))}var s=this;if(this.requested||"function"!=typeof t)return this;var o=!1;return this.once(e||"success",n),this.once(r||"error",i),this.request(),this},n.prototype.timeout=function(t,e){function r(){n.timeout(t,e)}var n=this;if(!this.requested)return this.once("request",r);var i=this.emit,s=!1,o=setTimeout(function(){s=!0,"function"==typeof e&&e(),i.call(n,"timeout")},t);return this.emit=function(){s||(clearTimeout(o),i.apply(n,arguments))},this},n.prototype.setServer=function(t){var e=null;switch(typeof t){case"object":e=t;break;case"string":for(var r,n=this.remote._servers,i=0;r=n[i];i++)if(r._url===t){e=r;break}}return e instanceof u&&(this.server=e),this},n.prototype.buildPath=function(t){if(this.remote.local_signing)throw new Error("`build_path` is completely ignored when doing local signing as `Paths` is a component of the signed blob. The `tx_blob` is signed,sealed and delivered, and the txn unmodified after");return t?this.message.build_path=!0:delete this.message.build_path,this},n.prototype.ledgerChoose=function(t){return t?this.message.ledger_index=this.remote._ledger_current_index:this.message.ledger_hash=this.remote._ledger_hash,this},n.prototype.ledgerHash=function(t){return this.message.ledger_hash=t,this},n.prototype.ledgerIndex=function(t){return this.message.ledger_index=t,this},n.prototype.ledgerSelect=function(t){switch(t){case"current":case"closed":case"validated":this.message.ledger_index=t;break;default:isNaN(t)?this.message.ledger_hash=t:(t=Number(t))&&(this.message.ledger_index=t)}return this},n.prototype.accountRoot=function(t){return this.message.account_root=o.json_rewrite(t),this},n.prototype.index=function(t){return this.message.index=t,this},n.prototype.offerId=function(t,e){return this.message.offer={account:o.json_rewrite(t),seq:e},this},n.prototype.offerIndex=function(t){return this.message.offer=t,this},n.prototype.secret=function(t){return t&&(this.message.secret=t),this},n.prototype.txHash=function(t){return this.message.tx_hash=t,this},n.prototype.txJson=function(t){return this.message.tx_json=t,this},n.prototype.txBlob=function(t){return this.message.tx_blob=t,this},n.prototype.rippleState=function(t,e,r){return this.message.ripple_state={currency:r,accounts:[o.json_rewrite(t),o.json_rewrite(e)]},this},n.prototype.accounts=function(t,e){Array.isArray(t)||(t=[t]);var r=t.map(function(t){return o.json_rewrite(t)});return e?this.message.accounts_proposed=r:this.message.accounts=r,this},n.prototype.addAccount=function(t,e){var r=o.json_rewrite(t);return e?this.message.accounts_proposed=(this.message.accounts_proposed||[]).concat(r):this.message.accounts=(this.message.accounts||[]).concat(r),this},n.prototype.rtAccounts=n.prototype.accountsProposed=function(t){return this.accounts(t,!0)},n.prototype.addAccountProposed=function(t){return this.addAccount(t,!0)},n.prototype.books=function(t,e){this.message.books=[];for(var r=0,n=t.length;n>r;r++){var i=t[r];this.addBook(i,e)}return this},n.prototype.addBook=function(t,e){function r(e){if(!t[e])throw new Error("Missing "+e);var r=n[e]={currency:a.json_rewrite(t[e].currency)};"XRP"!==r.currency&&(r.issuer=o.json_rewrite(t[e].issuer))}Array.isArray(this.message.books)||(this.message.books=[]);var n={};["taker_gets","taker_pays"].forEach(r),e&&(n.snapshot=!0),t.both&&(n.both=!0),this.message.books.push(n)},e.Request=n},function(t,e,r){function n(){this._value=new o,this._offset=0,this._is_native=!0,this._is_negative=!1,this._currency=new u,this._issuer=new a}var i=r(19),s=i.sjcl,o=(s.bn,i.jsbn.BigInteger),a=r(8).UInt160,c=r(10).Seed,u=r(6).Currency,h=e.consts={currency_xns:0,currency_one:1,xns_precision:6,bi_5:new o("5"),bi_7:new o("7"),bi_10:new o("10"),bi_1e14:new o(String(1e14)),bi_1e16:new o(String(1e16)),bi_1e17:new o(String(1e17)),bi_1e32:new o("100000000000000000000000000000000"),bi_man_max_value:new o("9999999999999999"),bi_man_min_value:new o("1000000000000000"),bi_xns_max:new o("9000000000000000000"),bi_xns_min:new o("-9000000000000000000"),bi_xns_unit:new o("1000000"),cMinOffset:-96,cMaxOffset:80};n.text_full_rewrite=function(t){return n.from_json(t).to_text_full()},n.json_rewrite=function(t){return n.from_json(t).to_json()},n.from_number=function(t){return(new n).parse_number(t)},n.from_json=function(t){return(new n).parse_json(t)},n.from_quality=function(t,e,r,i){return(new n).parse_quality(t,e,r,i)},n.from_human=function(t,e){return(new n).parse_human(t,e)},n.is_valid=function(t){return n.from_json(t).is_valid()},n.is_valid_full=function(t){return n.from_json(t).is_valid_full()},n.NaN=function(){var t=new n;return t._value=0/0,t},n.prototype.abs=function(){return this.clone(this.is_negative())},n.prototype.add=function(t){var e;if(t=n.from_json(t),this.is_comparable(t))if(t.is_zero())e=this;else if(this.is_zero())e=t.clone(),e._is_native=this._is_native,e._currency=this._currency,e._issuer=this._issuer;else if(this._is_native){e=new n;var r=this._is_negative?this._value.negate():this._value,i=t._is_negative?t._value.negate():t._value,s=r.add(i);e._is_negative=s.compareTo(o.ZERO)<0,e._value=e._is_negative?s.negate():s,e._currency=this._currency,e._issuer=this._issuer}else{for(var r=this._is_negative?this._value.negate():this._value,a=this._offset,i=t._is_negative?t._value.negate():t._value,c=t._offset;c>a;)r=r.divide(h.bi_10),a+=1;for(;a>c;)i=i.divide(h.bi_10),c+=1;e=new n,e._is_native=!1,e._offset=a,e._value=r.add(i),e._is_negative=e._value.compareTo(o.ZERO)<0,e._is_negative&&(e._value=e._value.negate()),e._currency=this._currency,e._issuer=this._issuer,e.canonicalize()}else e=n.NaN();return e},n.prototype._invert=function(){return this._value=h.bi_1e32.divide(this._value),this._offset=-32-this._offset,this.canonicalize(),this},n.prototype.invert=function(){return this.copy()._invert()},n.prototype.canonicalize=function(){if(this._value instanceof o)if(this._is_native)if(this._value.equals(o.ZERO))this._offset=0,this._is_negative=!1;else{for(;this._offset<0;)this._value=this._value.divide(h.bi_10),this._offset+=1;for(;this._offset>0;)this._value=this._value.multiply(h.bi_10),this._offset-=1}else if(this.is_zero())this._offset=-100,this._is_negative=!1;else{for(;this._value.compareTo(h.bi_man_min_value)<0;)this._value=this._value.multiply(h.bi_10),this._offset-=1;for(;this._value.compareTo(h.bi_man_max_value)>0;)this._value=this._value.divide(h.bi_10),this._offset+=1}else;return this},n.prototype.clone=function(t){return this.copyTo(new n,t)},n.prototype.compareTo=function(t){var e;return this.is_comparable(t)?this._is_negative!==t._is_negative?e=this._is_negative?-1:1:this._value.equals(o.ZERO)?e=t._value.equals(o.ZERO)?0:-1:t._value.equals(o.ZERO)?e=1:!this._is_native&&this._offset>t._offset?e=this._is_negative?-1:1:!this._is_native&&this._offset<t._offset?e=this._is_negative?1:-1:(e=this._value.compareTo(t._value),e>0?e=this._is_negative?-1:1:0>e&&(e=this._is_negative?1:-1)):e=n.NaN(),e},n.prototype.copyTo=function(t,e){return"object"==typeof this._value?this._value.copyTo(t._value):t._value=this._value,t._offset=this._offset,t._is_native=this._is_native,t._is_negative=e?!this._is_negative:this._is_negative,t._currency=this._currency,t._issuer=this._issuer,t.is_zero()&&(t._is_negative=!1),t
},n.prototype.currency=function(){return this._currency},n.prototype.equals=function(t,e){if("string"==typeof t)return this.equals(n.from_json(t));var r=!0;return r=!!(this.is_valid()&&t.is_valid()&&this._is_native===t._is_native&&this._value.equals(t._value)&&this._offset===t._offset&&this._is_negative===t._is_negative&&(this._is_native||this._currency.equals(t._currency)&&(e||this._issuer.equals(t._issuer))))},n.prototype.divide=function(t){var e;if(t.is_zero())throw new Error("divide by zero");if(this.is_zero())e=this;else{if(!this.is_valid())throw new Error("Invalid dividend");if(!t.is_valid())throw new Error("Invalid divisor");var r=this;if(r.is_native())for(r=r.clone();r._value.compareTo(h.bi_man_min_value)<0;)r._value=r._value.multiply(h.bi_10),r._offset-=1;var i=t;if(i.is_native())for(i=i.clone();i._value.compareTo(h.bi_man_min_value)<0;)i._value=i._value.multiply(h.bi_10),i._offset-=1;e=new n,e._offset=r._offset-i._offset-17,e._value=r._value.multiply(h.bi_1e17).divide(i._value).add(h.bi_5),e._is_native=r._is_native,e._is_negative=r._is_negative!==i._is_negative,e._currency=r._currency,e._issuer=r._issuer,e.canonicalize()}return e},n.prototype.ratio_human=function(t,e){e=e||{},t=n.from_json("number"==typeof t&&parseInt(t,10)===t?""+t+".0":t);var r=this;return t=n.from_json(t),r.is_valid()&&t.is_valid()?(e.reference_date&&(t=t.applyInterest(e.reference_date)),t._is_native&&(r=r.clone(),r._value=r._value.multiply(h.bi_xns_unit),r.canonicalize()),r.divide(t)):n.NaN()},n.prototype.product_human=function(t,e){if(e=e||{},t=n.from_json("number"==typeof t&&parseInt(t,10)===t?String(t)+".0":t),!this.is_valid()||!t.is_valid())return n.NaN();e.reference_date&&(t=t.applyInterest(e.reference_date));var r=this.multiply(t);return t._is_native&&(r._value=r._value.divide(h.bi_xns_unit),r.canonicalize()),r},n.prototype.is_comparable=function(t){return this._value instanceof o&&t._value instanceof o&&this._is_native===t._is_native},n.prototype.is_native=function(){return this._is_native},n.prototype.is_negative=function(){return this._value instanceof o?this._is_negative:!1},n.prototype.is_positive=function(){return!this.is_zero()&&!this.is_negative()},n.prototype.is_valid=function(){return this._value instanceof o},n.prototype.is_valid_full=function(){return this.is_valid()&&this._currency.is_valid()&&this._issuer.is_valid()},n.prototype.is_zero=function(){return this._value instanceof o?this._value.equals(o.ZERO):!1},n.prototype.issuer=function(){return this._issuer},n.prototype.multiply=function(t){var e;if(this.is_zero())e=this;else if(t.is_zero())e=this.clone(),e._value=o.ZERO;else{var r=this._value,i=this._offset,s=t._value,a=t._offset;if(this.is_native())for(;r.compareTo(h.bi_man_min_value)<0;)r=r.multiply(h.bi_10),i-=1;if(t.is_native())for(;s.compareTo(h.bi_man_min_value)<0;)s=s.multiply(h.bi_10),a-=1;e=new n,e._offset=i+a+14,e._value=r.multiply(s).divide(h.bi_1e14).add(h.bi_7),e._is_native=this._is_native,e._is_negative=this._is_negative!==t._is_negative,e._currency=this._currency,e._issuer=this._issuer,e.canonicalize()}return e},n.prototype.negate=function(){return this.clone("NEGATE")},n.prototype.invert=function(){var t=this.clone();return t._value=o.ONE,t._offset=0,t._is_negative=!1,t.canonicalize(),t.ratio_human(this)},n.human_RE=/^\s*([a-z]{3}|[0-9]{3})?\s*(-)?(\d+)(?:\.(\d*))?\s*([a-f0-9]{40}|[a-z0-9]{3})?\s*$/i,n.prototype.parse_human=function(t,e){e=e||{};var r=String(t).match(n.human_RE);if(r){var i=r[1]||r[5]||"XRP",s=r[3]||"0",a=r[4]||"",c=null;if(i=i.toUpperCase(),this._value=new o(s),this.set_currency(i),"XRP"===i){for(a=a.slice(0,6);a.length<6;)a+="0";this._is_native=!0,this._value=this._value.multiply(h.bi_xns_unit).add(new o(a))}else{a=a.replace(/0+$/,""),c=a.length,this._is_native=!1;var u=h.bi_10.clone().pow(c);this._value=this._value.multiply(u).add(new o(a)),this._offset=-c,this.canonicalize()}if(this._is_negative=!!r[2],e.reference_date&&this._currency.has_interest()){var f=this._currency.get_interest_at(e.reference_date),l=n.from_json(""+f+"/1/1");if(l.is_valid()){var p=this.divide(l);this._value=p._value,this._offset=p._offset}}}else this._value=0/0;return this},n.prototype.parse_issuer=function(t){return this._issuer=a.from_json(t),this},n.prototype.parse_quality=function(t,e,r,i){i=i||{};var s=u.from_json(i.base_currency);if(this._is_negative=!1,this._value=new o(t.substring(t.length-14),16),this._offset=parseInt(t.substring(t.length-16,t.length-14),16)-100,this._currency=u.from_json(e),this._issuer=a.from_json(r),this._is_native=this._currency.is_native(),!i.xrp_as_drops&&s.is_valid()&&s.is_native()&&(i.inverse?this._offset-=6:this._offset+=6),i.inverse&&this._invert(),this.canonicalize(),i.reference_date&&s.is_valid()&&s.has_interest()){var c=s.get_interest_at(i.reference_date),h=n.from_json(""+c+"/1/1");if(h.is_valid()){var f=this.divide(h);this._value=f._value,this._offset=f._offset}}return this},n.prototype.parse_number=function(t){return this._is_native=!1,this._currency=u.from_json(1),this._issuer=a.from_json(1),this._is_negative=0>t?!0:!1,this._value=new o(String(this._is_negative?-t:t)),this._offset=0,this.canonicalize(),this},n.prototype.parse_json=function(t){switch(typeof t){case"string":var e=t.match(/^([^/]+)\/([^/]+)(?:\/(.+))?$/);e?(this._currency=u.from_json(e[2]),this._issuer=a.from_json(e[3]?e[3]:"1"),this.parse_value(e[1])):(this.parse_native(t),this._currency=u.from_json("0"),this._issuer=a.from_json("0"));break;case"number":this.parse_json(String(t));break;case"object":if(null===t)break;t instanceof n?t.copyTo(this):t.hasOwnProperty("value")&&(this._currency.parse_json(t.currency,!0),"string"==typeof t.issuer&&this._issuer.parse_json(t.issuer),this.parse_value(t.value));break;default:this._value=0/0}return this},n.prototype.parse_native=function(t){var e;if("string"==typeof t&&(e=t.match(/^(-?)(\d*)(\.\d{0,6})?$/)),e){if(void 0===e[3])this._value=new o(e[2]);else{var r=new o(e[2]).multiply(h.bi_xns_unit),n=new o(e[3]).multiply(new o(String(Math.pow(10,1+h.xns_precision-e[3].length))));this._value=r.add(n)}this._is_native=!0,this._offset=0,this._is_negative=!!e[1]&&0!==this._value.compareTo(o.ZERO),this._value.compareTo(h.bi_xns_max)>0&&(this._value=0/0)}else this._value=0/0;return this},n.prototype.parse_value=function(t){switch(this._is_native=!1,typeof t){case"number":this._is_negative=0>t,this._value=new o(Math.abs(t)),this._offset=0,this.canonicalize();break;case"string":var e=t.match(/^(-?)(\d+)$/),r=!e&&t.match(/^(-?)(\d*)\.(\d*)$/),n=!n&&t.match(/^(-?)(\d*)e(-?\d+)$/);if(n)this._value=new o(n[2]),this._offset=parseInt(n[3]),this._is_negative=!!n[1],this.canonicalize();else if(r){var i=new o(r[2]),s=new o(r[3]),a=r[3].length;this._value=i.multiply(h.bi_10.clone().pow(a)).add(s),this._offset=-a,this._is_negative=!!r[1],this.canonicalize()}else e?(this._value=new o(e[2]),this._offset=0,this._is_negative=!!e[1],this.canonicalize()):this._value=0/0;break;default:this._value=t instanceof o?t:0/0}return this},n.prototype.set_currency=function(t){return this._currency=u.from_json(t),this._is_native=this._currency.is_native(),this},n.prototype.set_issuer=function(t){return this._issuer=t instanceof a?t:a.from_json(t),this},n.prototype.subtract=function(t){return this.add(n.from_json(t).negate())},n.prototype.to_number=function(t){var e=this.to_text(t);return"string"==typeof e?Number(e):e},n.prototype.to_text=function(t){var e=0/0;if(this._is_native)this.is_valid()&&this._value.compareTo(h.bi_xns_max)<=0&&(e=this._value.toString());else if(this.is_zero())e="0";else if(this._offset&&(this._offset<-25||this._offset>-4))e=this._value.toString()+"e"+this._offset;else{var r="000000000000000000000000000"+this._value.toString()+"00000000000000000000000",n=r.substring(0,this._offset+43),i=r.substring(this._offset+43),s=n.match(/[1-9].*$/),o=i.match(/[1-9]0*$/);e=""+(s?s[0]:"0")+(o?"."+i.substring(0,1+i.length-o[0].length):"")}return!t&&"number"==typeof e&&isNaN(e)?e="0":this._is_negative&&(e="-"+e),e},n.prototype.applyInterest=function(t){if(!this._currency.has_interest())return this;var e=this._currency.get_interest_at(t),r=n.from_json(String(e)+"/1/1");return r.is_valid()?this.multiply(r):void 0},n.prototype.to_human=function(t){if(t=t||{},!this.is_valid())return"";"undefined"==typeof t.signed&&(t.signed=!0),"undefined"==typeof t.group_sep&&(t.group_sep=!0),t.group_width=t.group_width||3;var e=this;t.reference_date&&(e=this.applyInterest(t.reference_date));for(var r=e._is_native?h.xns_precision:-e._offset,n=h.bi_10.clone().pow(r),s=e._value.divide(n).toString(),o=e._value.mod(n).toString();o.length<r;)o="0"+o;if(s=s.replace(/^0*/,""),o=o.replace(/0*$/,""),o.length||!t.skip_empty_fraction){if("number"==typeof t.precision&&(0===t.precision&&o.charCodeAt(0)>=53&&(s=(Number(s)+1).toString()),o=o.slice(0,t.precision)),"number"==typeof t.max_sig_digits){var a=0===+s,c=a?0:s.length,u=a?o.replace(/^0*/,""):o;c+=u.length;var f=c-t.max_sig_digits;f=Math.max(f,0),f=Math.min(f,o.length),f>0&&(o=o.slice(0,-f))}if("number"==typeof t.min_precision)for(;o.length<t.min_precision;)o+="0"}t.group_sep&&("string"!=typeof t.group_sep&&(t.group_sep=","),s=i.chunkString(s,t.group_width,!0).join(t.group_sep));var l="";return t.signed&&this._is_negative&&("string"!=typeof t.signed&&(t.signed="-"),l+=t.signed),l+=s.length?s:"0",l+=o.length?"."+o:""},n.prototype.to_human_full=function(t){t=t||{};var e=this.to_human(t),r=this._currency.to_human(),n=this._issuer.to_json(t),i=i=this.is_native?e+"/"+r:e+"/"+r+"/"+n;return i},n.prototype.to_json=function(){var t;if(this._is_native)t=this.to_text();else{var e={value:this.to_text(),currency:this._currency.to_json()};this._issuer.is_valid()&&(e.issuer=this._issuer.to_json()),t=e}return t},n.prototype.to_text_full=function(t){return this._value instanceof o?this._is_native?this.to_human()+"/XRP":this.to_text()+"/"+this._currency.to_json()+"/"+this._issuer.to_json(t):0/0},n.prototype.not_equals_why=function(t,e){if("string"==typeof t)return this.not_equals_why(n.from_json(t));if(!(t instanceof n))return"Not an Amount";var r=!1;if(this.is_valid()&&t.is_valid())if(this._is_native!==t._is_native)r="Native mismatch.";else{var i=this._is_native?"XRP":"Non-XRP";this._value.equals(t._value)&&this._offset===t._offset?this._is_negative!==t._is_negative?r=i+" sign differs.":this._is_native||(this._currency.equals(t._currency)?e||this._issuer.equals(t._issuer)||(r="Non-XRP issuer differs: "+t._issuer.to_json()+"/"+this._issuer.to_json()):r="Non-XRP currency differs."):r=i+" value differs."}else r="Invalid amount.";return r},e.Amount=n,e.Currency=u,e.Seed=c,e.UInt160=a},function(t,e,r){function n(t,e){function r(t){~n.subscribeEvents.indexOf(t)&&(!f._subs&&f._remote._connected&&f._remote.request_subscribe().add_account(f._account_id).broadcast(),f._subs+=1)}function i(t){~n.subscribeEvents.indexOf(t)&&(f._subs-=1,!f._subs&&f._remote._connected&&f._remote.request_unsubscribe().add_account(f._account_id).broadcast())}function s(t){f._account.is_valid()&&f._subs&&t.add_account(f._account_id)}function h(t){if(t.mmeta){var e=!1;t.mmeta.each(function(t){var r=t.fields.Account===f._account_id,n=r&&"AccountRoot"===t.entryType;n&&(o(f._entry,t.fieldsNew,t.fieldsFinal),e=!0)}),e&&f.emit("entry",f._entry)}}a.call(this);var f=this;return this._remote=t,this._account=c.from_json(e),this._account_id=this._account.to_json(),this._subs=0,this._entry={},this.on("newListener",r),this.on("removeListener",i),this._remote.on("prepare_subscribe",s),this.on("transaction",h),this._transactionManager=new u(this),this}var i=r(53),s=r(38),o=r(44),a=r(37).EventEmitter,c=(r(3).Amount,r(8).UInt160),u=r(25).TransactionManager,h=r(19).sjcl,f=r(7).Base;s.inherits(n,a),n.subscribeEvents=["transaction","entry"],n.prototype.toJson=function(){return this._account.to_json()},n.prototype.isValid=function(){return this._account.is_valid()},n.prototype.getInfo=function(t){return this._remote.request_account_info(this._account_id,t)},n.prototype.entry=function(t){function e(e,n){e?t(e):(o(r._entry,n.account_data),r.emit("entry",r._entry),t(null,n))}var r=this,t="function"==typeof t?t:function(){};return this.getInfo(e),this},n.prototype.getNextSequence=function(t){function e(t){return t&&"object"==typeof t&&"object"==typeof t.remote&&"actNotFound"===t.remote.error}function r(r,n){e(r)?t(null,0):r?t(r):t(null,n.account_data.Sequence)}var t="function"==typeof t?t:function(){};return this.getInfo(r),this},n.prototype.lines=function(t){function e(e,n){e?t(e):(r._lines=n.lines,r.emit("lines",r._lines),t(null,n))}var r=this,t="function"==typeof t?t:function(){};return this._remote.requestAccountLines(this._account_id,e),this},n.prototype.line=function(t,e,r){var n=this,r="function"==typeof r?r:function(){};return n.lines(function(n,i){if(n)return r(n);var s;t:for(var o=0;o<i.lines.length;o++){var a=i.lines[o];if(a.account===e&&a.currency===t){s=a;break t}}r(null,s)}),this},n.prototype.notify=n.prototype.notifyTx=function(t){if(this._subs){this.emit("transaction",t);var e=t.transaction.Account;if(e){var r=e===this._account_id;this.emit(r?"transaction-outbound":"transaction-inbound",t)}}},n.prototype.submit=function(t){this._transactionManager.submit(t)},n.prototype.publicKeyIsActive=function(t,e){function r(t){a.getInfo(function(e,r){e&&e.remote&&"actNotFound"===e.remote.error?t(null,null):t(e,r)})}function s(t,e){if(!t)return void(o===a._account_id?e(null,!0):e(null,!1));var r=t.account_data;r.RegularKey&&r.RegularKey===o?e(null,!0):r.Account===o&&0===(1048576&r.Flags)?e(null,!0):e(null,!1)}var o,a=this;try{o=n._publicKeyToAddress(t)}catch(c){return e(c)}var u=[r,s];i.waterfall(u,e)},n._publicKeyToAddress=function(t){function e(t){var e=h.codec.hex.toBits(t),r=h.hash.ripemd160.hash(h.hash.sha256.hash(e)),n=c.from_bits(r);return n.set_version(f.VER_ACCOUNT_ID),n.to_json()}if(c.is_valid(t))return t;if(/^[0-9a-fA-F]+$/.test(t))return e(t);throw new Error("Public key is invalid. Must be a UInt160 or a hex string")},e.Account=n},function(t,e,r){function n(t){i.call(this);var e=this,t=t||{};this.remote=t,this.tx_json={Flags:0},this._secret=void 0,this._build_path=!1,this._maxFee=this.remote.max_fee,this.state="unsubmitted",this.finalized=!1,this.previousSigningHash=void 0,this.submitIndex=void 0,this.canonical="object"==typeof t?!!t.canonical_signing:!0,this.submittedIDs=[],this.once("success",function(t){e.finalize(t),e.setState("validated"),e.emit("cleanup",t)}),this.once("error",function(t){e.finalize(t),e.setState("failed"),e.emit("cleanup",t)}),this.once("submitted",function(){e.setState("submitted")}),this.once("proposed",function(){e.setState("pending")})}var i=r(37).EventEmitter,s=r(38),o=r(19),a=r(19).sjcl,c=r(3).Amount,u=r(3).Currency,h=r(3).UInt160,f=r(10).Seed,l=r(12).SerializedObject,p=r(13).RippleError,_=r(27),d=r(21);s.inherits(n,i),n.fee_units={"default":10},n.flags={Universal:{FullyCanonicalSig:2147483648},AccountSet:{RequireDestTag:65536,OptionalDestTag:131072,RequireAuth:262144,OptionalAuth:524288,DisallowXRP:1048576,AllowXRP:2097152},TrustSet:{SetAuth:65536,NoRipple:131072,ClearNoRipple:262144},OfferCreate:{Passive:65536,ImmediateOrCancel:131072,FillOrKill:262144,Sell:524288},Payment:{NoRippleDirect:65536,PartialPayment:131072,LimitQuality:262144}},n.set_clear_flags={AccountSet:{asfRequireDest:1,asfRequireAuth:2,asfDisallowXRP:3,asfDisableMaster:4}},n.formats=r(18).tx,n.prototype.consts={telLOCAL_ERROR:-399,temMALFORMED:-299,tefFAILURE:-199,terRETRY:-99,tesSUCCESS:0,tecCLAIMED:100},n.from_json=function(t){return(new n).parseJson(t)},n.prototype.parseJson=function(t){return this.tx_json=t,this},n.prototype.isTelLocal=function(t){return t>=this.consts.telLOCAL_ERROR&&t<this.consts.temMALFORMED},n.prototype.isTemMalformed=function(t){return t>=this.consts.temMALFORMED&&t<this.consts.tefFAILURE},n.prototype.isTefFailure=function(t){return t>=this.consts.tefFAILURE&&t<this.consts.terRETRY},n.prototype.isTerRetry=function(t){return t>=this.consts.terRETRY&&t<this.consts.tesSUCCESS},n.prototype.isTepSuccess=function(t){return t>=this.consts.tesSUCCESS},n.prototype.isTecClaimed=function(t){return t>=this.consts.tecCLAIMED},n.prototype.isRejected=function(t){return this.isTelLocal(t)||this.isTemMalformed(t)||this.isTefFailure(t)},n.prototype.setState=function(t){this.state!==t&&(this.state=t,this.emit("state",t),this.emit("save"))},n.prototype.finalize=function(t){return this.finalized=!0,this.result?(this.result.ledger_index=t.ledger_index,this.result.ledger_hash=t.ledger_hash):(this.result=t,this.result.tx_json=this.tx_json),this},n.prototype._accountSecret=function(t){return this.remote.secrets[t]},n.prototype._getFeeUnits=n.prototype.feeUnits=function(){return n.fee_units["default"]},n.prototype._computeFee=function(){for(var t=this.remote._servers,e=[],r=0;r<t.length;r++){var n=t[r];n._connected&&e.push(Number(n._computeFee(this)))}switch(e.length){case 0:return;case 1:return String(e[0])}e.sort(function(t,e){return t>e?1:e>t?-1:0});var i=Math.floor(e.length/2),s=e.length%2===0?Math.floor(.5+(e[i]+e[i-1])/2):e[i];return String(s)},n.prototype.complete=function(){if(this.remote&&!this.remote.trusted&&!this.remote.local_signing)return this.emit("error",new p("tejServerUntrusted","Attempt to give secret to untrusted server")),!1;if(!this._secret&&!(this._secret=this._accountSecret(this.tx_json.Account)))return this.emit("error",new p("tejSecretUnknown","Missing secret")),!1;if("undefined"==typeof this.tx_json.SigningPubKey)try{var t=f.from_json(this._secret),e=t.get_key(this.tx_json.Account);this.tx_json.SigningPubKey=e.to_hex_pub()}catch(r){return this.emit("error",new p("tejSecretInvalid","Invalid secret")),!1}return!this.remote||"undefined"!=typeof this.tx_json.Fee||!this.remote.local_fee&&this.remote.trusted||(this.tx_json.Fee=this._computeFee())?Number(this.tx_json.Fee)>this._maxFee?(this.emit("error",new p("tejMaxFeeExceeded","Max fee exceeded")),!1):(this.remote&&this.remote.local_signing&&this.canonical&&(this.tx_json.Flags|=n.flags.Universal.FullyCanonicalSig,this.tx_json.Flags=this.tx_json.Flags>>>0),this.tx_json):void this.emit("error",new p("tejUnconnected"))},n.prototype.serialize=function(){return l.from_json(this.tx_json)},n.prototype.signingHash=function(){return this.hash(d.testnet?"HASH_TX_SIGN_TESTNET":"HASH_TX_SIGN")},n.prototype.hash=function(t,e){if("string"==typeof t){if("undefined"==typeof _[t])throw new Error("Unknown hashing prefix requested.");t=_[t]}else t||(t=_.HASH_TX_ID);var r=l.from_json(this.tx_json).hash(t);return e?r:r.to_hex()},n.prototype.sign=function(t){var t="function"==typeof t?t:function(){},e=f.from_json(this._secret),r=this.tx_json.TxnSignature;delete this.tx_json.TxnSignature;var n=this.signingHash();if(r&&n===this.previousSigningHash)return this.tx_json.TxnSignature=r,t(),this;var i=e.get_key(this.tx_json.Account),s=i.sign(n,0),o=a.codec.hex.fromBits(s).toUpperCase();return this.tx_json.TxnSignature=o,this.previousSigningHash=n,t(),this},n.prototype.addId=function(t){-1===this.submittedIDs.indexOf(t)&&(this.submittedIDs.unshift(t),this.emit("signed",t),this.emit("save"))},n.prototype.findId=function(t){for(var e,r=0;r<this.submittedIDs.length;r++){var n=this.submittedIDs[r];if(e=t[n])break}return e},n.prototype.buildPath=function(t){return this._build_path=t,this},n.prototype.destinationTag=function(t){return void 0!==t&&(this.tx_json.DestinationTag=t),this},n.prototype.invoiceID=function(t){if("string"==typeof t){for(;t.length<64;)t+="0";this.tx_json.InvoiceID=t}return this},n.prototype.clientID=function(t){return"string"==typeof t&&(this._clientID=t),this},n.prototype.lastLedger=function(t){return"number"==typeof t&&(this._setLastLedger=!0,this.tx_json.LastLedgerSequence=t),this},n._pathRewrite=function(t){if(Array.isArray(t)){var e=t.map(function(t){var e={};return t.hasOwnProperty("account")&&(e.account=h.json_rewrite(t.account)),t.hasOwnProperty("issuer")&&(e.issuer=h.json_rewrite(t.issuer)),t.hasOwnProperty("currency")&&(e.currency=u.json_rewrite(t.currency)),t.hasOwnProperty("type_hex")&&(e.type_hex=t.type_hex),e});return e}},n.prototype.pathAdd=function(t){return Array.isArray(t)&&(this.tx_json.Paths=this.tx_json.Paths||[],this.tx_json.Paths.push(n._pathRewrite(t))),this},n.prototype.paths=function(t){if(Array.isArray(t))for(var e=0,r=t.length;r>e;e++)this.pathAdd(t[e]);return this},n.prototype.secret=function(t){return this._secret=t,this},n.prototype.sendMax=function(t){return t&&(this.tx_json.SendMax=c.json_rewrite(t)),this},n.prototype.sourceTag=function(t){return t&&(this.tx_json.SourceTag=t),this},n.prototype.transferRate=function(t){if(this.tx_json.TransferRate=Number(t),this.tx_json.TransferRate<1e9)throw new Error("invalidTransferRate");return this},n.prototype.setFlags=function(t){if(void 0===t)return this;if("number"==typeof t)return this.tx_json.Flags=t,this;for(var e=Array.isArray(t)?t:Array.prototype.slice.call(arguments),r=n.flags[this.tx_json.TransactionType]||{},i=0,s=e.length;s>i;i++){var o=e[i];if(!r.hasOwnProperty(o))return this.emit("error",new p("tejInvalidFlag"));this.tx_json.Flags+=r[o]}return this},n.prototype.accountSet=function(t,e,r){function i(t){return"number"==typeof t?t:o[t]||o["asf"+t]}if("object"==typeof t){var s=t;t=s.source||s.from||s.account,e=s.set_flag||s.set,r=s.clear_flag||s.clear}if(!h.is_valid(t))throw new Error("Source address invalid");this.tx_json.TransactionType="AccountSet",this.tx_json.Account=h.json_rewrite(t);var o=n.set_clear_flags.AccountSet;return e&&(e=i(e))&&(this.tx_json.SetFlag=e),r&&(r=i(r))&&(this.tx_json.ClearFlag=r),this},n.prototype.claim=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.signature,r=i.public_key,e=i.generator,t=i.source||i.from||i.account}return this.tx_json.TransactionType="Claim",this.tx_json.Generator=e,this.tx_json.PublicKey=r,this.tx_json.Signature=n,this},n.prototype.offerCancel=function(t,e){if("object"==typeof t){var r=t;e=r.sequence,t=r.source||r.from||r.account}if(!h.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="OfferCancel",this.tx_json.Account=h.json_rewrite(t),this.tx_json.OfferSequence=Number(e),this},n.prototype.offerCreate=function(t,e,r,n,i){if("object"==typeof t){var s=t;i=s.cancel_sequence,n=s.expiration,r=s.taker_gets||s.sell,e=s.taker_pays||s.buy,t=s.source||s.from||s.account}if(!h.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="OfferCreate",this.tx_json.Account=h.json_rewrite(t),this.tx_json.TakerPays=c.json_rewrite(e),this.tx_json.TakerGets=c.json_rewrite(r),n&&(this.tx_json.Expiration=o.time.toRipple(n)),i&&(this.tx_json.OfferSequence=Number(i)),this},n.prototype.setRegularKey=function(t,e){if("object"==typeof t){var r=t;t=r.address||r.account||r.from,e=r.regular_key}if(!h.is_valid(t))throw new Error("Source address invalid");if(!h.is_valid(e))throw new Error("RegularKey must be a valid Ripple Address (a Hash160 of the public key)");return this.tx_json.TransactionType="SetRegularKey",this.tx_json.Account=h.json_rewrite(t),this.tx_json.RegularKey=h.json_rewrite(e),this},n.prototype.payment=function(t,e,r){if("object"==typeof t){var n=t;r=n.amount,e=n.destination||n.to,t=n.source||n.from||n.account}if(!h.is_valid(t))throw new Error("Payment source address invalid");if(!h.is_valid(e))throw new Error("Payment destination address invalid");return this.tx_json.TransactionType="Payment",this.tx_json.Account=h.json_rewrite(t),this.tx_json.Amount=c.json_rewrite(r),this.tx_json.Destination=h.json_rewrite(e),this},n.prototype.trustSet=n.prototype.rippleLineSet=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.quality_out,r=i.quality_in,e=i.limit,t=i.source||i.from||i.account}if(!h.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="TrustSet",this.tx_json.Account=h.json_rewrite(t),void 0!==e&&(this.tx_json.LimitAmount=c.json_rewrite(e)),r&&(this.tx_json.QualityIn=r),n&&(this.tx_json.QualityOut=n),this},n.prototype.submit=function(t){function e(t,e){t instanceof p||(t=new p(t,e)),n.callback(t)}function r(t){n.callback(null,t)}var n=this;this.callback="function"==typeof t?t:function(){},this._errorHandler=e,this._successHandler=r,this.on("error",function(){});var i=this.tx_json.Account;return h.is_valid(i)?(this.remote.account(i).submit(this),this):this.emit("error",new p("tejInvalidAccount","Account is missing or invalid"))},n.prototype.abort=function(t){var t="function"==typeof t?t:function(){};this.finalized||(this.once("final",t),this.emit("abort"))},n.prototype.summary=function(){return n.summary.call(this)},n.summary=function(){var t={tx_json:this.tx_json,clientID:this._clientID,submittedIDs:this.submittedIDs,submissionAttempts:this.attempts,submitIndex:this.submitIndex,initialSubmitIndex:this.initialSubmitIndex,lastLedgerSequence:this.lastLedgerSequence,state:this.state,server:this._server?this._server._opts.url:void 0,finalized:this.finalized};return this.result&&(t.result={engine_result:this.result.engine_result,engine_result_message:this.result.engine_result_message,ledger_hash:this.result.ledger_hash,ledger_index:this.result.ledger_index,transaction_hash:this.result.tx_json.hash}),t},e.Transaction=n},function(t,e,r){var n=r(44),i=r(8).UInt160,s=r(19),o=r(26).Float,a=n(function(){this._value=0/0,this._update()},i);a.prototype=n({},i.prototype),a.prototype.constructor=a,a.HEX_CURRENCY_BAD="0000000000000000000000005852500000000000",a.prototype.human_RE=/^\s*([a-zA-Z]{3}|[0-9]{3})(\s*-\s*[- \w]+)?(\s*\(-?\d+\.?\d*%pa\))?\s*$/,a.from_json=function(t,e){return t instanceof this?t.clone():(new this).parse_json(t,e)},a.from_human=function(t,e){return(new a).parse_human(t,e)},a.prototype.parse_json=function(t,e){switch(this._value=0/0,typeof t){case"string":if(!t||/^(0|XRP)$/.test(t)){this.parse_hex(e?a.HEX_CURRENCY_BAD:a.HEX_ZERO);break}var r=String(t).match(this.human_RE);if(r){var n=r[1],i=r[3]||"",c=i.match(/(-?\d+\.?\d+)/);n=n.toUpperCase();var u=s.arraySet(20,0);if(c){u[0]=1,u[1]=255&n.charCodeAt(0),u[2]=255&n.charCodeAt(1),u[3]=255&n.charCodeAt(2),c=parseFloat(c[0]);for(var h=31536e3,f=h/Math.log(1+c/100),l=o.toIEEE754Double(f),p=0;p<=l.length;p++)u[8+p]=255&l[p]}else u[12]=255&n.charCodeAt(0),u[13]=255&n.charCodeAt(1),u[14]=255&n.charCodeAt(2);this.parse_bytes(u)}else this.parse_hex(t);break;case"number":isNaN(t)||this.parse_number(t);break;case"object":t instanceof a&&(this._value=t.copyTo({})._value,this._update())}return this},a.prototype.parse_human=function(t){return this.parse_json(t)},a.prototype._update=function(){var t=this.to_bytes(),e=!0;if(!t)return"XRP";this._native=!1,this._type=-1,this._interest_start=0/0,this._interest_period=0/0,this._iso_code="";for(var r=0;20>r;r++)e=e&&(12===r||13===r||14===r||0===t[r]);e?(this._iso_code=String.fromCharCode(t[12])+String.fromCharCode(t[13])+String.fromCharCode(t[14]),"\x00\x00\x00"===this._iso_code&&(this._native=!0,this._iso_code="XRP"),this._type=0):1===t[0]&&(this._iso_code=String.fromCharCode(t[1])+String.fromCharCode(t[2])+String.fromCharCode(t[3]),this._type=1,this._interest_start=(t[4]<<24)+(t[5]<<16)+(t[6]<<8)+t[7],this._interest_period=o.fromIEEE754Double(t.slice(8,16)))},a.prototype.is_native=function(){return this._native},a.prototype.has_interest=function(){return 1===this._type&&!isNaN(this._interest_start)&&!isNaN(this._interest_period)},a.prototype.get_interest_at=function(t){return this.has_interest?(t||(t=this._interest_start+31536e3),t instanceof Date&&(t=s.fromTimestamp(t.getTime())),Math.exp((t-this._interest_start)/this._interest_period)):0},a.prototype.get_interest_percentage_at=function(t,e){var r=this.get_interest_at(t,e),r=100*r-100,n=e?Math.pow(10,e):100;return Math.round(r*n)/n},a.prototype.to_json=function(t){if(!this.is_valid())return"XRP";var e,r=t&&t.full_name?" - "+t.full_name:"";if(/^[A-Z0-9]{3}$/.test(this._iso_code)&&!this.has_interest())e=this._iso_code+r;else if(this.has_interest()){var n=t?t.decimals:void 0;e=this._iso_code+r+" ("+this.get_interest_percentage_at(this._interest_start+31536e3,n)+"%pa)"}else e=this.to_hex(),e===a.HEX_ONE&&(e=1);return e},a.prototype.to_human=function(t){return this.to_json(t)},a.prototype.get_iso=function(){return this._iso_code},e.Currency=a},function(t,e,r){function n(t){return s.codec.bytes.fromBits(s.hash.sha256.hash(s.codec.bytes.toBits(t)))}function i(t){return n(n(t))}var s=r(19).sjcl,o=r(19),a=r(44),c=o.jsbn.BigInteger,u={},h=u.alphabets={ripple:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz",tipple:"RPShNAF39wBUDnEGHJKLM4pQrsT7VWXYZ2bcdeCg65jkm8ofqi1tuvaxyz",bitcoin:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"};a(u,{VER_NONE:1,VER_NODE_PUBLIC:28,VER_NODE_PRIVATE:32,VER_ACCOUNT_ID:0,VER_ACCOUNT_PUBLIC:35,VER_ACCOUNT_PRIVATE:34,VER_FAMILY_GENERATOR:41,VER_FAMILY_SEED:33}),u.encode=function(t,e){for(var r=h[e||"ripple"],n=new c(String(r.length)),i=new c,s=new c,o=new c(t),a=[];o.compareTo(c.ZERO)>0;)o.divRemTo(n,i,s),i.copyTo(o),a.push(r[s.intValue()]);for(var u=0;u!==t.length&&!t[u];u+=1)a.push(r[0]);return a.reverse().join("")},u.decode=function(t,e){if("string"!=typeof t)return void 0;var r,n=h[e||"ripple"],i=new c(String(n.length)),s=new c;for(r=0;r!==t.length&&t[r]===n[0];r+=1);for(;r!==t.length;r+=1){var a=n.indexOf(t[r]);if(0>a)return void 0;var u=new c;u.fromInt(a),s=s.multiply(i).add(u)}for(var f=s.toByteArray().map(function(t){return t?0>t?256+t:t:0}),l=0;l!==f.length&&!f[l];)l+=1;l&&(f=f.slice(l));for(var p=0;p!==t.length&&t[p]===n[0];)p+=1;return[].concat(o.arraySet(p,0),f)},u.verify_checksum=function(t){for(var e=i(t.slice(0,-4)).slice(0,4),r=t.slice(-4),n=!0,s=0;4>s;s++)if(e[s]!==r[s]){n=!1;break}return n},u.encode_check=function(t,e,r){var i=[].concat(t,e),s=n(n(i)).slice(0,4);return u.encode([].concat(i,s),r)},u.decode_check=function(t,e,r){var n=u.decode(e,r);if(!n||n.length<5)return 0/0;if("number"==typeof t&&n[0]!==t)return 0/0;if(Array.isArray(t)){for(var i=!1,s=0,o=t.length;o>s;s++)i|=t[s]===n[0];if(!i)return 0/0}return u.verify_checksum(n)?(n[0]=0,new c(n.slice(0,-4),256)):0/0},e.Base=u},function(t,e,r){var n=r(19),i=r(21),s=r(44),o=n.jsbn.BigInteger,a=r(28).UInt,c=r(7).Base,u=s(function(){this._value=0/0,this._version_byte=void 0,this._update()},a);u.width=20,u.prototype=s({},a.prototype),u.prototype.constructor=u;{var h=(u.ACCOUNT_ZERO="rrrrrrrrrrrrrrrrrrrrrhoLvTp",u.ACCOUNT_ONE="rrrrrrrrrrrrrrrrrrrrBZbvji",u.HEX_ZERO="0000000000000000000000000000000000000000"),f=u.HEX_ONE="0000000000000000000000000000000000000001";u.STR_ZERO=n.hexToString(h),u.STR_ONE=n.hexToString(f)}u.prototype.set_version=function(t){return this._version_byte=t,this},u.prototype.get_version=function(){return this._version_byte},u.prototype.parse_json=function(t){return i.accounts&&t in i.accounts&&(t=i.accounts[t].account),"number"!=typeof t||isNaN(t)?"string"!=typeof t?this._value=0/0:"r"===t[0]?(this._value=c.decode_check(c.VER_ACCOUNT_ID,t),this._version_byte=c.VER_ACCOUNT_ID):this.parse_hex(t):(this._value=new o(String(t)),this._version_byte=c.VER_ACCOUNT_ID),this._update(),this},u.prototype.parse_generic=function(t){return a.prototype.parse_generic.call(this,t),isNaN(this._value)&&"string"==typeof t&&"r"===t[0]&&(this._value=c.decode_check(c.VER_ACCOUNT_ID,t)),this._update(),this},u.prototype.to_json=function(t){if(t=t||{},this._value instanceof o){if("number"==typeof this._version_byte){var e=c.encode_check(this._version_byte,this.to_bytes());return t.gateways&&e in t.gateways&&(e=t.gateways[e]),e}return this.to_hex()}return 0/0},e.UInt160=u},function(t,e,r){var n=r(19),i=r(44),s=r(28).UInt,o=i(function(){this._value=0/0},s);o.width=32,o.prototype=i({},s.prototype),o.prototype.constructor=o;{var a=o.HEX_ZERO="0000000000000000000000000000000000000000000000000000000000000000",c=o.HEX_ONE="0000000000000000000000000000000000000000000000000000000000000001";o.STR_ZERO=n.hexToString(a),o.STR_ONE=n.hexToString(c)}e.UInt256=o},function(t,e,r){function n(t,e){return[].concat(t,e>>24,e>>16&255,e>>8&255,255&e)}function i(t){return a.bitArray.bitSlice(a.hash.sha512.hash(a.codec.bytes.toBits(t)),0,256)
}var s=r(44),o=r(19),a=o.sjcl,c=o.jsbn.BigInteger,u=r(7).Base,h=r(28).UInt,f=(r(9).UInt256,r(8).UInt160),l=r(29).KeyPair,p=s(function(){this._curve=a.ecc.curves.c256,this._value=0/0},h);p.width=16,p.prototype=s({},h.prototype),p.prototype.constructor=p,p.prototype.parse_json=function(t){return"string"==typeof t&&t.length?"s"===t[0]?this._value=u.decode_check(u.VER_FAMILY_SEED,t):32===t.length?this._value=this.parse_hex(t):this.parse_passphrase(t):this._value=0/0,this},p.prototype.parse_passphrase=function(t){if("string"!=typeof t)throw new Error("Passphrase must be a string");var e=a.hash.sha512.hash(a.codec.utf8String.toBits(t)),r=a.bitArray.bitSlice(e,0,128);return this.parse_bits(r),this},p.prototype.to_json=function(){if(!(this._value instanceof c))return 0/0;var t=u.encode_check(u.VER_FAMILY_SEED,this.to_bytes());return t},p.prototype.get_key=function(t){var e,r=0;if(!this.is_valid())throw new Error("Cannot generate keys from invalid seed!");t&&("number"==typeof t?r=t:e=f.from_json(t));var s,o,c=this._curve,u=0;do s=a.bn.fromBits(i(n(this.to_bytes(),u))),u++;while(!c.r.greaterEquals(s));o=c.G.mult(s);var h,p,_=1e3;do{u=0;do h=a.bn.fromBits(i(n(n(o.toBytesCompressed(),r),u))),u++;while(!c.r.greaterEquals(h));if(r++,h=h.add(s).mod(c.r),p=l.from_bn_secret(h),--_<=0)throw new Error("Too many loops looking for KeyPair yielding "+e.to_json()+" from "+this.to_json())}while(e&&!p.get_address().equals(e));return p},e.Seed=p},function(t,e,r){function n(t){var e=this;this.nodes=[],t.AffectedNodes.forEach(function(t){var r={};(r.diffType=e.diffType(t))&&(t=t[r.diffType],r.entryType=t.LedgerEntryType,r.ledgerIndex=t.LedgerIndex,r.fields=i({},t.PreviousFields,t.NewFields,t.FinalFields),r.fieldsPrev=t.PreviousFields||{},r.fieldsNew=t.NewFields||{},r.fieldsFinal=t.FinalFields||{},e.nodes.push(r))})}var i=r(44),s=r(19),o=r(8).UInt160,a=r(3).Amount;n.node_types=["CreatedNode","ModifiedNode","DeletedNode"],n.prototype.diffType=function(t){for(var e=!1,r=0;r<n.node_types.length;r++){var i=n.node_types[r];if(t.hasOwnProperty(i)){e=i;break}}return e},n.prototype.each=function(t){for(var e=0,r=this.nodes.length;r>e;e++)t(this.nodes[e],e)},["forEach","map","filter","every","reduce"].forEach(function(t){n.prototype[t]=function(){return Array.prototype[t].apply(this.nodes,arguments)}});var c=["LowLimit","HighLimit","TakerPays","TakerGets"];n.prototype.getAffectedAccounts=function(){var t=[];return this.nodes.forEach(function(e){var r="CreatedNode"===e.diffType?e.fieldsNew:e.fieldsFinal;for(var n in r){var i=r[n];if("string"==typeof i&&o.is_valid(i))t.push(i);else if(-1!==c.indexOf(n)){var s=a.from_json(i),u=s.issuer();u.is_valid()&&!u.is_zero()&&t.push(u.to_json())}}}),s.arrayUnique(t)},n.prototype.getAffectedBooks=function(){var t=[];return this.nodes.forEach(function(e){if("Offer"===e.entryType){var r=a.from_json(e.fields.TakerGets),n=a.from_json(e.fields.TakerPays),i=r.currency().to_json();"XRP"!==i&&(i+="/"+r.issuer().to_json());var s=n.currency().to_json();"XRP"!==s&&(s+="/"+n.issuer().to_json());var o=[i,s].join(":");e.bookKey=o,t.push(o)}}),s.arrayUnique(t)},e.Meta=n},function(t,e,r){(function(t){function n(e){if(Array.isArray(e)||t&&t.isBuffer(e))this.buffer=e;else if("string"==typeof e)this.buffer=f.codec.bytes.fromBits(f.codec.hex.toBits(e));else{if(e)throw new Error("Invalid buffer passed.");this.buffer=[]}this.pointer=0}function i(t){return function(e){var r=this.pointer,n=r+e;if(n>this.buffer.length)throw new Error("Buffer length exceeded");var i=this.buffer.slice(r,n);return t&&(this.pointer=n),i}}var s=r(40),o=r(44),a=r(18),c=r(30),u=(r(9).UInt256,r(31).Crypt),h=r(19),f=h.sjcl,l=h.jsbn.BigInteger,p={};Object.keys(a.tx).forEach(function(t){p[a.tx[t][0]]=t});var _={};Object.keys(a.ledger).forEach(function(t){_[a.ledger[t][0]]=t});var d={};Object.keys(a.ter).forEach(function(t){d[a.ter[t]]=t}),n.from_json=function(t){var e,t=o({},t),r=new n;if("number"==typeof t.TransactionType&&(t.TransactionType=n.lookup_type_tx(t.TransactionType),!t.TransactionType))throw new Error("Transaction type ID is invalid.");if("number"==typeof t.LedgerEntryType&&(t.LedgerEntryType=n.lookup_type_le(t.LedgerEntryType),!t.LedgerEntryType))throw new Error("LedgerEntryType ID is invalid.");if("string"==typeof t.TransactionType){if(e=a.tx[t.TransactionType],!Array.isArray(e))throw new Error("Transaction type is invalid");e=e.slice(),t.TransactionType=e.shift()}else if("string"==typeof t.LedgerEntryType){if(e=a.ledger[t.LedgerEntryType],!Array.isArray(e))throw new Error("LedgerEntryType is invalid");e=e.slice(),t.LedgerEntryType=e.shift()}else{if("object"!=typeof t.AffectedNodes)throw new Error("Object to be serialized must contain either TransactionType, LedgerEntryType or AffectedNodes.");e=a.metadata}return n.check_no_missing_fields(e,t),r.serialize(e,t),r},n.check_no_missing_fields=function(t,e){for(var r=[],i=t.length-1;i>=0;i--){var s=t[i],o=s[0],c=s[1];a.REQUIRED===c&&void 0===e[o]&&r.push(o)}if(r.length>0){var u;throw u=void 0!==e.TransactionType?n.lookup_type_tx(e.TransactionType):null!=e.LedgerEntryType?n.lookup_type_le(e.LedgerEntryType):"TransactionMetaData",new Error(u+" is missing fields: "+JSON.stringify(r))}},n.prototype.append=function(t){t instanceof n&&(t=t.buffer),this.buffer=this.buffer.concat(t),this.pointer+=t.length},n.prototype.resetPointer=function(){this.pointer=0},n.prototype.read=i(!0),n.prototype.peek=i(!1),n.prototype.to_bits=function(){return f.codec.bytes.toBits(this.buffer)},n.prototype.to_hex=function(){return f.codec.hex.fromBits(this.to_bits()).toUpperCase()},n.prototype.to_json=function(){var t=this.pointer;this.resetPointer();for(var e={};this.pointer<this.buffer.length;){var r=c.parse(this),i=r[0],s=r[1];e[i]=n.jsonify_structure(s,i)}return this.pointer=t,e},n.jsonify_structure=function(t,e){var r;switch(typeof t){case"number":switch(e){case"LedgerEntryType":r=_[t];break;case"TransactionResult":r=d[t];break;case"TransactionType":r=p[t];break;default:r=t}break;case"object":if(null===t)break;if("function"==typeof t.to_json)r=t.to_json();else if(t instanceof l)r=t.toString(16).toUpperCase();else{r=new t.constructor;for(var i=Object.keys(t),s=0,o=i.length;o>s;s++){var a=i[s];r[a]=n.jsonify_structure(t[a],a)}}break;default:r=t}return r},n.prototype.serialize=function(t,e){c.Object.serialize(this,e,!0)},n.prototype.hash=function(t){var e=new n;"undefined"!=typeof t&&c.Int32.serialize(e,t),e.append(this.buffer);var r=f.codec.bytes.toBits(e.buffer);return u.hashSha512Half(r)},n.prototype.signing_hash=n.prototype.hash,n.prototype.serialize_field=function(t,e){{var r=t[0],n=t[1];t[2],c[t[3]]}if("undefined"!=typeof e[r])try{c.serialize(this,r,e[r])}catch(i){throw i.message='Error serializing "'+r+'": '+i.message,i}else if(n===a.REQUIRED)throw new Error("Missing required field "+r)},n.get_field_header=function(t,e){var r=[0];return t>15?r.push(255&t):r[0]+=(15&t)<<4,e>15?r.push(255&e):r[0]+=15&e,r},n.sort_typedef=function(t){function e(t,e){return t[3]!==e[3]?c[t[3]].id-c[e[3]].id:t[2]-e[2]}return s(Array.isArray(t)),t.sort(e)},n.lookup_type_tx=function(t){return s.strictEqual(typeof t,"number"),p[t]},n.lookup_type_le=function(t){return s("number"==typeof t),_[t]},e.SerializedObject=n}).call(e,r(41).Buffer)},function(t,e,r){function n(t,e){switch(typeof t){case"object":s(this,t);break;case"string":this.result=t,this.result_message=e}this.engine_result=this.result=this.result||this.engine_result||this.error||"Error",this.engine_result_message=this.result_message=this.result_message||this.engine_result_message||this.error_message||"Error",this.result_message=this.message=this.result_message;var r;Error.captureStackTrace?Error.captureStackTrace(this,t||this):(r=(new Error).stack)&&(this.stack=r)}var i=r(38),s=r(44);i.inherits(n,Error),n.prototype.name="RippleError",e.RippleError=n},function(t,e,r){var n=r(53),i=(r(42),r(19).sjcl),s=r(1).Remote,o=r(10).Seed,a=r(29).KeyPair,c=r(4).Account,u=r(8).UInt160,h={};h.HASH_FUNCTION=i.hash.sha512.hash,h.MAGIC_BYTES="Ripple Signed Message:\n";var f=/^[0-9a-fA-F]+$/,l=/^([A-Za-z0-9\+]{4})*([A-Za-z0-9\+]{2}==)|([A-Za-z0-9\+]{3}=)?$/;h.signMessage=function(t,e,r){return h.signHash(h.HASH_FUNCTION(h.MAGIC_BYTES+t),e,r)},h.signHash=function(t,e,r){if("string"==typeof t&&/^[0-9a-fA-F]+$/.test(t)&&(t=i.codec.hex.toBits(t)),"object"!=typeof t||t.length<=0||"number"!=typeof t[0])throw new Error("Hash must be a bitArray or hex-encoded string");e instanceof i.ecc.ecdsa.secretKey||(e=o.from_json(e).get_key(r)._secret);var n=e.signWithRecoverablePublicKey(t),s=i.codec.base64.fromBits(n);return s},h.verifyMessageSignature=function(t,e,r){return"string"!=typeof t.message?r(new Error("Data object must contain message field to verify signature")):(t.hash=h.HASH_FUNCTION(h.MAGIC_BYTES+t.message),h.verifyHashSignature(t,e,r))},h.verifyHashSignature=function(t,e,r){function o(t){var e;try{e=i.ecc.ecdsa.publicKey.recoverFromSignature(p,d)}catch(r){return t(r)}e?t(null,e):t(new Error("Could not recover public key from signature"))}function h(t,r){var n=new a;n._pubkey=t;var i=n.to_hex_pub(),s=new c(e,_);s.publicKeyIsActive(i,r)}var p,_,d;if("function"!=typeof r)throw new Error("Must supply callback function");if(p=t.hash,p&&"string"==typeof p&&f.test(p)&&(p=i.codec.hex.toBits(p)),"object"!=typeof p||p.length<=0||"number"!=typeof p[0])return r(new Error("Hash must be a bitArray or hex-encoded string"));if(_=t.account||t.address,!_||!u.from_json(_).is_valid())return r(new Error("Account must be a valid ripple address"));if(d=t.signature,"string"!=typeof d||!l.test(d))return r(new Error("Signature must be a Base64-encoded string"));if(d=i.codec.base64.toBits(d),!(e instanceof s)||"online"!==e.state)return r(new Error("Must supply connected Remote to verify signature"));var y=[o,h];n.waterfall(y,r)},e.Message=h},function(t,e,r){function n(t){t||(t={}),"string"==typeof t&&(t={domain:t}),this.domain=t.domain||"ripple.com",this.infos={}}var i=r(53),s=r(32).BlobClient,o=r(16).AuthInfo,a=r(31).Crypt,c=r(24).sub("vault");n.prototype.getAuthInfo=function(t,e){o.get(this.domain,t,function(t,r){return t?e(t):3!==r.version?e(new Error("This wallet is incompatible with this version of the vault-client.")):r.pakdf?"string"!=typeof r.blobvault?e(new Error("No blobvault specified in the authinfo.")):void e(null,r):e(new Error("No settings for PAKDF in auth packet."))})},n.prototype._deriveLoginKeys=function(t,e,r){a.derive(t.pakdf,"login",t.username.toLowerCase(),e,function(n,i){n?r(n):r(null,t,e,i)})},n.prototype._deriveUnlockKey=function(t,e,r,n){a.derive(t.pakdf,"unlock",t.username.toLowerCase(),e,function(e,i){return e?(c.error("derive:",e),n(e)):(r||(r={}),r.unlock=i.unlock,void n(null,t,r))})},n.prototype.getRippleName=function(t,e,r){e?s.getRippleName(e,t,r):r(new Error("Blob vault URL is required"))},n.prototype.exists=function(t,e){o.get(this.domain,t.toLowerCase(),function(t,r){t?e(t):e(null,!!r.exists)})},n.prototype.login=function(t,e,r){function n(r){h.getAuthInfo(t,function(t,n){return n&&!n.exists?r(new Error("User does not exist.")):r(t,n,e)})}function o(t,e,r,n){s.get(t.blobvault,r.id,r.crypt,function(i,s){return i?n(i):(h.infos[r.id]=t,s.missing_fields&&s.missing_fields.encrypted_blobdecrypt_key&&(c.info("migration: saving encrypted blob decrypt key"),t.blob=s,h._deriveUnlockKey(t,e,r,u)),void n(null,{blob:s,username:t.username,verified:t.emailVerified}))})}function u(t,e,r){if(!t&&r.unlock){var n;try{n=a.decrypt(r.unlock,e.blob.encrypted_secret)}catch(i){return c.error("decrypt:",i)}options={username:e.username,blob:e.blob,masterkey:n,keys:r},s.updateKeys(options,function(t){t&&c.error("updateKeys:",t)})}}var h=this,f=[n,h._deriveLoginKeys,o];i.waterfall(f,r)},n.prototype.relogin=function(t,e,r,n){return!t&&this.infos[e]&&(t=this.infos[e].blobvault),t?void s.get(t,e,r,function(t,e){t?n(t):n(null,{blob:e})}):n(new Error("Blob vault URL is required"))},n.prototype.unlock=function(t,e,r,n){function s(r){c.getAuthInfo(t,function(t,n){return n&&!n.exists?r(new Error("User does not exist.")):r(t,n,e,{})})}function o(t,e,n){var i;try{i=a.decrypt(e.unlock,r)}catch(s){return n(s)}n(null,{keys:e,secret:i})}var c=this,u=[s,c._deriveUnlockKey,o];i.waterfall(u,n)},n.prototype.loginAndUnlock=function(t,e,r){function n(r){c.login(t,e,function(t,n){if(t)return r(t);if(!n.blob||!n.blob.encrypted_secret)return r(new Error("Unable to retrieve blob and secret."));if(!n.blob.id||!n.blob.key)return r(new Error("Unable to retrieve keys."));var i=c.infos[n.blob.id];return i?void r(null,i,e,n.blob):r(new Error("Unable to find authInfo"))})}function s(t,e,r,n){c._deriveUnlockKey(t,e,null,function(t,e,i){n(t,i.unlock,e,r)})}function o(t,e,r,n){var i;try{i=a.decrypt(t,r.encrypted_secret)}catch(s){return n(s)}n(null,{blob:r,unlock:t,secret:i,username:e.username,verified:e.emailVerified})}var c=this,u=[n,s,o];i.waterfall(u,r)},n.prototype.verify=function(t,e,r){var n=this;n.getAuthInfo(t,function(n,i){return n?r(n):void s.verify(i.blobvault,t.toLowerCase(),e,r)})},n.prototype.resendEmail=function(t,e){s.resendEmail(t,e)},n.prototype.deleteBlob=function(t,e){s.deleteBlob(t,e)},n.prototype.updateProfile=function(t,e){s.updateProfile(t,e)},n.prototype.recoverBlob=function(t,e){s.recoverBlob(t,e)},n.prototype.changePassword=function(t,e){function r(e){o.getAuthInfo(t.username,function(t,r){return e(t,r,a)})}function n(e,r,n){t.keys=r,s.updateKeys(t,n)}var o=this,a=String(t.password).trim(),c=[r,o._deriveLoginKeys,o._deriveUnlockKey,n];i.waterfall(c,e)},n.prototype.rename=function(t,e){function r(t){o.getAuthInfo(a,function(e,r){return r&&r.exists?t(new Error("username already taken.")):(r.username=a,t(e,r,c))})}function n(e,r,n){t.keys=r,s.rename(t,n)}var o=this,a=String(t.new_username).trim(),c=String(t.password).trim(),u=[r,o._deriveLoginKeys,o._deriveUnlockKey,n];i.waterfall(u,e)},n.prototype.register=function(t,e){function r(t){o.getAuthInfo(c,function(e,r){return t(e,r,u)})}function n(e,r,n){var i={url:e.blobvault,id:r.id,crypt:r.crypt,unlock:r.unlock,username:c,email:t.email,masterkey:t.masterkey||a.createMaster(),activateLink:t.activateLink,oldUserBlob:t.oldUserBlob,domain:t.domain};s.create(i,function(t,e){t?n(t):n(null,{blob:e,username:c})})}var o=this,c=String(t.username).trim(),u=String(t.password).trim(),h=o.validateUsername(c);if(!h.valid)return e(new Error("invalid username."));var f=[r,o._deriveLoginKeys,o._deriveUnlockKey,n];i.waterfall(f,e)},n.prototype.validateUsername=function(t){t=String(t).trim();var e={valid:!1,reason:""};return t.length<2?e.reason="tooshort":t.length>20?e.reason="toolong":/^[a-zA-Z0-9\-]+$/.exec(t)?/^-/.exec(t)?e.reason="starthyphen":/-$/.exec(t)?e.reason="endhyphen":/--/.exec(t)?e.reason="multhyphen":e.valid=!0:e.reason="charset",e},e.VaultClient=n},function(t,e,r){var n=r(53),i=r(54),s=r(17).RippleTxt,o={};o._getRippleTxt=function(t,e){s.get(t,e)},o._getUser=function(t,e){i.get(t,e)},o.get=function(t,e,r){function i(r){o._getRippleTxt(t,function(n,i){if(n)return r(n);if(!i.authinfo_url)return r(new Error("Authentication is not supported on "+t));var s=Array.isArray(i.authinfo_url)?i.authinfo_url[0]:i.authinfo_url;s+="?domain="+t+"&username="+e,r(null,s)})}function s(t,e){o._getUser(t,function(t,r){t||r.error?e(new Error("Authentication info server unreachable")):e(null,r.body)})}var o=this;e=e.toLowerCase(),n.waterfall([i,s],r)},e.AuthInfo=o},function(t,e,r){var n=r(54),i=r(6).Currency,s={txts:{}};s.urlTemplates=["https://{{domain}}/ripple.txt","https://www.{{domain}}/ripple.txt","https://ripple.{{domain}}/ripple.txt","http://{{domain}}/ripple.txt","http://www.{{domain}}/ripple.txt","http://ripple.{{domain}}/ripple.txt"],s.get=function(t,e){var r=this;return r.txts[t]?e(null,r.txts[t]):void function i(o){var a=s.urlTemplates[o];return a?(a=a.replace("{{domain}}",t),void n.get(a,function(n,s){if(n||!s.text)return i(++o);var a=r.parse(s.text);r.txts[t]=a,e(null,a)})):e(new Error("No ripple.txt found"))}(0)},s.parse=function(t){var e="",r={};t=t.replace(/\r?\n/g,"\n").split("\n");for(var n=0,i=t.length;i>n;n++){var s=t[n];s.length&&"#"!==s[0]&&("["===s[0]&&"]"===s[s.length-1]?(e=s.slice(1,s.length-1),r[e]=[]):(s=s.replace(/^\s+|\s+$/g,""),r[e]&&r[e].push(s)))}return r},s.extractDomain=function(t){return match=/[^.]*\.[^.]{2,3}(?:\.[^.]{2,3})?([^.\?][^\?.]+?)?$/.exec(t),match&&match[0]?match[0]:t},s.getCurrencies=function(t,e){t=s.extractDomain(t),this.get(t,function(r,n){if(r)return e(r);if(r||!n.currencies||!n.accounts)return e(null,[]);var s=n.accounts[0],o=[];n.currencies.forEach(function(e){o.push({issuer:s,currency:i.from_json(e),domain:t})}),e(null,o)})},e.RippleTxt=s},function(t,e){var r=(e.types=[void 0,"Int16","Int32","Int64","Hash128","Hash256","Amount","VL","Account",void 0,void 0,void 0,void 0,void 0,"Object","Array","Int8","Hash160","PathSet","Vector256"],e.fields={1:{1:"LedgerEntryType",2:"TransactionType"},2:{2:"Flags",3:"SourceTag",4:"Sequence",5:"PreviousTxnLgrSeq",6:"LedgerSequence",7:"CloseTime",8:"ParentCloseTime",9:"SigningTime",10:"Expiration",11:"TransferRate",12:"WalletSize",13:"OwnerCount",14:"DestinationTag",16:"HighQualityIn",17:"HighQualityOut",18:"LowQualityIn",19:"LowQualityOut",20:"QualityIn",21:"QualityOut",22:"StampEscrow",23:"BondAmount",24:"LoadFee",25:"OfferSequence",26:"FirstLedgerSequence",27:"LastLedgerSequence",28:"TransactionIndex",29:"OperationLimit",30:"ReferenceFeeUnits",31:"ReserveBase",32:"ReserveIncrement",33:"SetFlag",34:"ClearFlag"},3:{1:"IndexNext",2:"IndexPrevious",3:"BookNode",4:"OwnerNode",5:"BaseFee",6:"ExchangeRate",7:"LowNode",8:"HighNode"},4:{1:"EmailHash"},5:{1:"LedgerHash",2:"ParentHash",3:"TransactionHash",4:"AccountHash",5:"PreviousTxnID",6:"LedgerIndex",7:"WalletLocator",8:"RootIndex",9:"AccountTxnID",16:"BookDirectory",17:"InvoiceID",18:"Nickname",19:"Feature"},6:{1:"Amount",2:"Balance",3:"LimitAmount",4:"TakerPays",5:"TakerGets",6:"LowLimit",7:"HighLimit",8:"Fee",9:"SendMax",16:"MinimumOffer",17:"RippleEscrow",18:"DeliveredAmount"},7:{1:"PublicKey",2:"MessageKey",3:"SigningPubKey",4:"TxnSignature",5:"Generator",6:"Signature",7:"Domain",8:"FundCode",9:"RemoveCode",10:"ExpireCode",11:"CreateCode",12:"MemoType",13:"MemoData"},8:{1:"Account",2:"Owner",3:"Destination",4:"Issuer",7:"Target",8:"RegularKey"},14:{1:void 0,2:"TransactionMetaData",3:"CreatedNode",4:"DeletedNode",5:"ModifiedNode",6:"PreviousFields",7:"FinalFields",8:"NewFields",9:"TemplateEntry",10:"Memo"},15:{1:void 0,2:"SigningAccounts",3:"TxnSignatures",4:"Signatures",5:"Template",6:"Necessary",7:"Sufficient",8:"AffectedNodes",9:"Memos"},16:{1:"CloseResolution",2:"TemplateEntryType",3:"TransactionResult"},17:{1:"TakerPaysCurrency",2:"TakerPaysIssuer",3:"TakerGetsCurrency",4:"TakerGetsIssuer"},18:{1:"Paths"},19:{1:"Indexes",2:"Hashes",3:"Features"}}),n=e.fieldsInverseMap={};Object.keys(r).forEach(function(t){Object.keys(r[t]).forEach(function(e){n[r[t][e]]=[Number(t),Number(e)]})});var i=e.REQUIRED=0,s=e.OPTIONAL=1,o=e.DEFAULT=2,a=[["TransactionType",i],["Flags",s],["SourceTag",s],["LastLedgerSequence",s],["Account",i],["Sequence",i],["Fee",i],["OperationLimit",s],["SigningPubKey",i],["TxnSignature",s]];e.tx={AccountSet:[3].concat(a,[["EmailHash",s],["WalletLocator",s],["WalletSize",s],["MessageKey",s],["Domain",s],["TransferRate",s]]),TrustSet:[20].concat(a,[["LimitAmount",s],["QualityIn",s],["QualityOut",s]]),OfferCreate:[7].concat(a,[["TakerPays",i],["TakerGets",i],["Expiration",s]]),OfferCancel:[8].concat(a,[["OfferSequence",i]]),SetRegularKey:[5].concat(a,[["RegularKey",i]]),Payment:[0].concat(a,[["Destination",i],["Amount",i],["SendMax",s],["Paths",o],["InvoiceID",s],["DestinationTag",s]]),Contract:[9].concat(a,[["Expiration",i],["BondAmount",i],["StampEscrow",i],["RippleEscrow",i],["CreateCode",s],["FundCode",s],["RemoveCode",s],["ExpireCode",s]]),RemoveContract:[10].concat(a,[["Target",i]]),EnableFeature:[100].concat(a,[["Feature",i]]),SetFee:[101].concat(a,[["Features",i],["BaseFee",i],["ReferenceFeeUnits",i],["ReserveBase",i],["ReserveIncrement",i]])};var c=[["LedgerIndex",s],["LedgerEntryType",i],["Flags",i]];e.ledger={AccountRoot:[97].concat(c,[["Sequence",i],["PreviousTxnLgrSeq",i],["TransferRate",s],["WalletSize",s],["OwnerCount",i],["EmailHash",s],["PreviousTxnID",i],["AccountTxnID",s],["WalletLocator",s],["Balance",i],["MessageKey",s],["Domain",s],["Account",i],["RegularKey",s]]),Contract:[99].concat(c,[["PreviousTxnLgrSeq",i],["Expiration",i],["BondAmount",i],["PreviousTxnID",i],["Balance",i],["FundCode",s],["RemoveCode",s],["ExpireCode",s],["CreateCode",s],["Account",i],["Owner",i],["Issuer",i]]),DirectoryNode:[100].concat(c,[["IndexNext",s],["IndexPrevious",s],["ExchangeRate",s],["RootIndex",i],["Owner",s],["TakerPaysCurrency",s],["TakerPaysIssuer",s],["TakerGetsCurrency",s],["TakerGetsIssuer",s],["Indexes",i]]),EnabledFeatures:[102].concat(c,[["Features",i]]),FeeSettings:[115].concat(c,[["ReferenceFeeUnits",i],["ReserveBase",i],["ReserveIncrement",i],["BaseFee",i],["LedgerIndex",s]]),GeneratorMap:[103].concat(c,[["Generator",i]]),LedgerHashes:[104].concat(c,[["LedgerEntryType",i],["Flags",i],["FirstLedgerSequence",s],["LastLedgerSequence",s],["LedgerIndex",s],["Hashes",i]]),Nickname:[110].concat(c,[["LedgerEntryType",i],["Flags",i],["LedgerIndex",s],["MinimumOffer",s],["Account",i]]),Offer:[111].concat(c,[["LedgerEntryType",i],["Flags",i],["Sequence",i],["PreviousTxnLgrSeq",i],["Expiration",s],["BookNode",i],["OwnerNode",i],["PreviousTxnID",i],["LedgerIndex",s],["BookDirectory",i],["TakerPays",i],["TakerGets",i],["Account",i]]),RippleState:[114].concat(c,[["LedgerEntryType",i],["Flags",i],["PreviousTxnLgrSeq",i],["HighQualityIn",s],["HighQualityOut",s],["LowQualityIn",s],["LowQualityOut",s],["LowNode",s],["HighNode",s],["PreviousTxnID",i],["LedgerIndex",s],["Balance",i],["LowLimit",i],["HighLimit",i]])},e.metadata=[["TransactionIndex",i],["TransactionResult",i],["AffectedNodes",i]],e.ter={tesSUCCESS:0,tecCLAIM:100,tecPATH_PARTIAL:101,tecUNFUNDED_ADD:102,tecUNFUNDED_OFFER:103,tecUNFUNDED_PAYMENT:104,tecFAILED_PROCESSING:105,tecDIR_FULL:121,tecINSUF_RESERVE_LINE:122,tecINSUF_RESERVE_OFFER:123,tecNO_DST:124,tecNO_DST_INSUF_XRP:125,tecNO_LINE_INSUF_RESERVE:126,tecNO_LINE_REDUNDANT:127,tecPATH_DRY:128,tecUNFUNDED:129,tecMASTER_DISABLED:130,tecNO_REGULAR_KEY:131,tecOWNERS:132}},function(t,e,r){function n(t,e){return function(){console.log("%s: %s",n,arguments.toString),e(arguments)}}function i(t,e){for(var r=new Array(t),n=0;t>n;n++)r[n]=e;return r}function s(t){var e=[],r=0;for(t.length%2&&(e.push(String.fromCharCode(parseInt(t.substring(0,1),16))),r=1);r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substring(r,r+2),16)));return e.join("")}function o(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);e+=16>n?"0"+n.toString(16):n.toString(16)}return e}function a(t){for(var e=new Array(t.length),r=0;r<e.length;r+=1)e[r]=t.charCodeAt(r);return e}function c(t){return a(s(t))}function u(t,e,r){var n=[],i=0,s=t.length;for(r&&(i=t.length%e,i&&n.push(t.slice(0,i)));s>i;i+=e)n.push(t.slice(i,e+i));return n}function h(t,e){if(!t)throw new Error("Assertion failed"+(e?": "+e:"."))}function f(t){for(var e={},r=[],n=0,i=t.length;i>n;n++){var s=t[n];e[s]||(r.push(s),e[s]=!0)}return r}function l(t){return 1e3*(t+946684800)}function p(t){return t instanceof Date&&(t=t.getTime()),Math.round(t/1e3)-946684800}e.time={fromRipple:l,toRipple:p},e.trace=n,e.arraySet=i,e.hexToString=s,e.hexToArray=c,e.stringToArray=a,e.stringToHex=o,e.chunkString=u,e.assert=h,e.arrayUnique=f,e.toTimestamp=l,e.fromTimestamp=p,e.sjcl=r(34),e.jsbn=r(35)},function(t,e,r){function n(t,e){function r(t){c._handleMessage(t)}function i(t){c._handleResponseSubscribe(t)}function a(){var t=c._checkActivity.bind(c);c._activityInterval=setInterval(t,1e3)}o.call(this);var c=this;if("string"==typeof e){var u=s.parse(e);e={host:u.hostname,port:u.port,secure:"ws:"===u.protocol?!1:!0}}if("object"!=typeof e)throw new TypeError("Server configuration is not an Object");if(!n.domainRE.test(e.host))throw new Error('Server host is malformed, use "host" and "port" server configuration');if(!(e.port=Number(e.port)))throw new TypeError("Server port must be a number");if(e.port<1||e.port>65535)throw new TypeError('Server "port" must be an integer in range 1-65535');"boolean"!=typeof e.secure&&(e.secure=!0),this._remote=t,this._opts=e,this._ws=void 0,this._connected=!1,this._shouldConnect=!1,this._state="offline",this._id=0,this._retry=0,this._requests={},this._load_base=256,this._load_factor=256,this._fee=10,this._fee_ref=10,this._fee_base=10,this._reserve_base=void 0,this._reserve_inc=void 0,this._fee_cushion=this._remote.fee_cushion,this._lastLedgerIndex=0/0,this._lastLedgerClose=0/0,this._score=0,this._scoreWeights={ledgerclose:5,response:1},this._url=this._opts.url=(this._opts.secure?"wss://":"ws://")+this._opts.host+":"+this._opts.port,this.on("message",r),this.on("response_subscribe",i),this.on("disconnect",function(){clearInterval(c._activityInterval),c.once("ledger_closed",a)}),this.once("ledger_closed",a),this._remote.on("ledger_closed",function(t){c._updateScore("ledgerclose",t)}),this.on("response_ping",function(t,e){c._updateScore("response",e)}),this.on("load_changed",function(t){c._updateScore("loadchange",t)})}var i=r(38),s=r(43),o=r(37).EventEmitter,a=r(3).Amount,c=r(5).Transaction,u=r(24).internal.sub("server");i.inherits(n,o),n.domainRE=/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|[-_]){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|[-_]){0,61}[0-9A-Za-z])?)*\.?$/,n.onlineStates=["syncing","tracking","proposing","validating","full"],n.websocketConstructor=function(){return r(36)},n.prototype._setState=function(t){if(t!==this._state)switch(this._remote.trace&&u.info("set_state:",t),this._state=t,this.emit("state",t),t){case"online":this._connected=!0,this.emit("connect");break;case"offline":this._connected=!1,this.emit("disconnect")}},n.prototype._checkActivity=function(){if(this._connected&&!isNaN(this._lastLedgerClose)){var t=Date.now()-this._lastLedgerClose;t>25e3&&this.reconnect()}},n.prototype._updateScore=function(t,e){if(this._connected){var r=this._scoreWeights[t]||1;switch(t){case"ledgerclose":var n=e.ledger_index-this._lastLedgerIndex;n>0&&(this._score+=r*n);break;case"response":var n=Math.floor((Date.now()-e.time)/200);this._score+=r*n;break;case"loadchange":this._fee=Number(this._computeFee(10))}this._score>1e3&&this.reconnect()}},n.prototype._remoteAddress=function(){var t;try{t=this._ws._socket.remoteAddress}catch(e){}return t},n.prototype.disconnect=function(){this._shouldConnect=!1,this._setState("offline"),this._ws&&this._ws.close()},n.prototype.reconnect=function(){function t(){e.connect()}var e=this;this._ws&&(this.once("disconnect",t),this.disconnect())},n.prototype.connect=function(){var t=this;if(!this._connected){this._remote.trace&&u.info("connect:",this._opts.url),this._ws&&this._ws.close();var e=n.websocketConstructor();if(!e)throw new Error("No websocket support detected!");var r=this._ws=new e(this._opts.url);this._shouldConnect=!0,t.emit("connecting"),r.onmessage=function(e){t.emit("message",e.data)},r.onopen=function(){r===t._ws&&(t.emit("socket_open"),t._request(t._remote._serverPrepareSubscribe()))},r.onerror=function(e){r===t._ws&&(t.emit("socket_error"),t._remote.trace&&u.info("onerror:",t._opts.url,e.data||e),t._handleClose())},r.onclose=function(){r===t._ws&&(t._remote.trace&&u.info("onclose:",t._opts.url,r.readyState),t._handleClose())}}},n.prototype._retryConnect=function(){function t(){e._shouldConnect&&(e._remote.trace&&u.info("retry",e._opts.url),e.connect())}var e=this;this._retry+=1;var r=this._retry<40?50:this._retry<100?1e3:this._retry<160?1e4:3e4;this._retryTimer=setTimeout(t,r)},n.prototype._handleClose=function(){function t(){}var e=this,r=this._ws;this.emit("socket_close"),this._setState("offline"),r.onopen=r.onerror=r.onclose=r.onmessage=t,e._shouldConnect&&this._retryConnect()},n.prototype._handleMessage=function(t){try{t=JSON.parse(t)}catch(e){}if(!n.isValidMessage(t))return void this.emit("unexpected",t);switch(t.type){case"ledgerClosed":this._handleLedgerClosed(t);break;case"serverStatus":this._handleServerStatus(t);break;case"response":this._handleResponse(t);break;case"path_find":this._handlePathFind(t)}},n.prototype._handleLedgerClosed=function(t){this._lastLedgerIndex=t.ledger_index,this._lastLedgerClose=Date.now(),this.emit("ledger_closed",t)},n.prototype._handleServerStatus=function(t){var e=~n.onlineStates.indexOf(t.server_status);if(this._setState(e?"online":"offline"),n.isLoadStatus(t)){this.emit("load",t,this),this._remote.emit("load",t,this);var r=t.load_base!==this._load_base||t.load_factor!==this._load_factor;r&&(this._load_base=t.load_base,this._load_factor=t.load_factor,this.emit("load_changed",t,this),this._remote.emit("load_changed",t,this))}},n.prototype._handleResponse=function(t){var e=this._requests[t.id];if(delete this._requests[t.id],!e)return void(this._remote.trace&&u.info("UNEXPECTED:",this._opts.url,t));if("success"===t.status){this._remote.trace&&u.info("response:",this._opts.url,t);var r=e.message.command,n=t.result,i="response_"+r;e.emit("success",n),[this,this._remote].forEach(function(r){r.emit(i,n,e,t)})}else if(t.error){this._remote.trace&&u.info("error:",this._opts.url,t);var s={error:"remoteError",error_message:"Remote reported an error.",remote:t};e.emit("error",s)}},n.prototype._handlePathFind=function(t){this._remote.trace&&u.info("path_find:",this._opts.url,t)},n.prototype._handleResponseSubscribe=function(t){~n.onlineStates.indexOf(t.server_status)&&this._setState("online"),n.isLoadStatus(t)&&(this._load_base=t.load_base||256,this._load_factor=t.load_factor||256,this._fee_ref=t.fee_ref,this._fee_base=t.fee_base,this._reserve_base=t.reserve_base,this._reserve_inc=t.reserve_inc)},n.isValidMessage=function(t){return"object"==typeof t&&"string"==typeof t.type},n.isLoadStatus=function(t){return"number"==typeof t.load_base&&"number"==typeof t.load_factor},n.prototype._sendMessage=function(t){this._ws&&(this._remote.trace&&u.info("request:",this._opts.url,t),this._ws.send(JSON.stringify(t)))},n.prototype._request=function(t){function e(){r._sendMessage(t.message)}var r=this;return this._ws?(t.server=this,t.message.id=this._id,t.time=Date.now(),this._requests[t.message.id]=t,this._id++,void(this._isConnected(t)?e():this.once("connect",e))):void(this._remote.trace&&u.info("request: DROPPING:",r._opts.url,t.message))},n.prototype._isConnected=function(t){var e=t&&"subscribe"===t.message.command&&1===this._ws.readyState;return this._connected||this._ws&&e},n.prototype._computeFee=function(t){var e;if(t instanceof c)e=t._getFeeUnits();else{if("number"!=typeof t)throw new Error("Invalid argument");e=t}return this._feeTx(e).to_json()},n.prototype._feeTx=function(t){var e=this._feeTxUnit();return a.from_json(String(Math.ceil(t*e)))},n.prototype._feeTxUnit=function(){var t=this._fee_base/this._fee_ref;return t*=this._load_factor/this._load_base,t*=this._fee_cushion},n.prototype._reserve=function(t){var e=a.from_json(String(this._reserve_base)),r=a.from_json(String(this._reserve_inc)),n=t||0;if(0>n)throw new Error("Owner count must not be negative.");return e.add(r.product_human(n))},e.Server=n},function(t,e,r){var n=r(44),i=t.exports={load:function(t){return n(i,t),i}}},function(t,e,r){function n(t,e,r,i,o,a){function c(t){~n.subscribe_events.indexOf(t)&&(f._subs+=1,1===f._subs&&f._remote._connected&&f._subscribe())}function u(t){~n.subscribe_events.indexOf(t)&&(f._subs-=1,!f._subs&&f._remote._connected&&(f._sync=!1,f._remote.request_unsubscribe().books([f.to_json()]).request()))}function h(){f._sync=!1}s.call(this);var f=this;return this._remote=t,this._currency_gets=e,this._issuer_gets=r,this._currency_pays=i,this._issuer_pays=o,this._subs=0,this._key=a,this._sync=!1,this._offers=[],this.on("newListener",c),this.on("removeListener",u),this._remote.on("prepare_subscribe",function(t){f._subscribe(t)}),this._remote.on("disconnect",h),this}var i=r(38),s=r(37).EventEmitter,o=r(44),a=r(3).Amount,c=r(8).UInt160,u=r(6).Currency;
i.inherits(n,s),n.subscribe_events=["transaction","model","trade"],n.prototype._subscribe=function(t){var e=this;if(e.is_valid()&&e._subs){var t=this._remote.request_subscribe();t.addBook(e.to_json(),!0),t.once("success",function(t){e._sync=!0,e._offers=t.offers,e.emit("model",e._offers)}),t.once("error",function(){}),t.request()}},n.prototype.to_json=function(){var t={taker_gets:{currency:this._currency_gets},taker_pays:{currency:this._currency_pays}};return"XRP"!==this._currency_gets&&(t.taker_gets.issuer=this._issuer_gets),"XRP"!==this._currency_pays&&(t.taker_pays.issuer=this._issuer_pays),t},n.prototype.is_valid=function(){return u.is_valid(this._currency_pays)&&("XRP"===this._currency_pays||c.is_valid(this._issuer_pays))&&u.is_valid(this._currency_gets)&&("XRP"===this._currency_gets||c.is_valid(this._issuer_gets))&&!("XRP"===this._currency_pays&&"XRP"===this._currency_gets)},n.prototype.trade=function(t){var e="0"+("XRP"===this["_currency_"+t]?"":"/"+this["_currency_"+t]+"/"+this["_issuer_"+t]);return a.from_json(e)},n.prototype.notify=function(t){function e(e){if("Offer"===e.entryType&&e.bookKey===r._key){var c,u,h;switch(e.diffType){case"DeletedNode":case"ModifiedNode":var f="DeletedNode"===e.diffType;for(c=0,u=r._offers.length;u>c;c++)if(h=r._offers[c],h.index===e.ledgerIndex){f?r._offers.splice(c,1):o(h,e.fieldsFinal),n=!0;break}if("OfferCancel"===t.transaction.TransactionType)return;i=i.add(e.fieldsPrev.TakerGets),s=s.add(e.fieldsPrev.TakerPays),f||(i=i.subtract(e.fieldsFinal.TakerGets),s=s.subtract(e.fieldsFinal.TakerPays));break;case"CreatedNode":var l=a.from_json(e.fields.TakerPays).ratio_human(e.fields.TakerGets,{reference_date:new Date});for(c=0,u=r._offers.length;u>c;c++){h=r._offers[c];var p=a.from_json(h.TakerPays).ratio_human(h.TakerGets,{reference_date:new Date});if(l.compareTo(p)<=0){var _=e.fields;_.index=e.ledgerIndex,r._offers.splice(c,0,e.fields),n=!0;break}}}}}var r=this,n=!1,i=this.trade("gets"),s=this.trade("pays");t.mmeta.each(e),this._subs&&(this.emit("transaction",t),n&&this.emit("model",this._offers),i.is_zero()||this.emit("trade",s,i))},n.prototype.notifyTx=n.prototype.notify,n.prototype.offers=function(t){return"function"==typeof t&&(this._sync?t(this._offers):this.once("model",t)),this},n.prototype.offersSync=function(){return this._offers},e.OrderBook=n},function(t,e,r){function n(t,e,r,n,s){i.call(this),this.remote=t,this.src_account=e,this.dst_account=r,this.dst_amount=n,this.src_currencies=s}{var i=r(37).EventEmitter,s=r(38),o=r(3).Amount;r(44)}s.inherits(n,i),n.prototype.create=function(){function t(t,r){t?e.emit("error",t):e.notify_update(r)}var e=this,r=this.remote.request_path_find_create(this.src_account,this.dst_account,this.dst_amount,this.src_currencies,t);r.request()},n.prototype.close=function(){this.remote.request_path_find_close().request(),this.emit("end"),this.emit("close")},n.prototype.notify_update=function(t){var e=t.source_account,r=t.destination_account,n=o.from_json(t.destination_amount);this.src_account===e&&this.dst_account===r&&this.dst_amount.equals(n)&&this.emit("update",t)},n.prototype.notify_superceded=function(){this.emit("end"),this.emit("superceded")},e.PathFind=n},function(t,e,r){var e=t.exports=r(39),n={logObject:function(t){var e=Array.prototype.slice.call(arguments,1);e=e.map(function(t){return/MSIE/.test(navigator.userAgent)?JSON.stringify(t,null,2):t}),e.unshift(t),console.log.apply(console,e)}};window.console&&window.console.log&&(e.Log.engine=n)},function(t,e,r){function n(t){function e(t){var e=n.normalizeTransaction(t),r=e.tx_json.Sequence,i=e.tx_json.hash;if(e.validated){f._pending.addReceivedSequence(r);var s=f._pending.getSubmission(i);f._remote.trace&&u.info("transaction received:",e.tx_json),s instanceof o?s.emit("success",e):f._pending.addReceivedId(i,e)}}function r(t){f._pending.forEach(function(e){switch(t.ledger_index-e.submitIndex){case 8:e.emit("lost",t);break;case 4:e.emit("missing",t)}})}function i(t){function n(n,i){!n&&Array.isArray(i.transactions)&&i.transactions.forEach(e),f._remote.on("ledger_closed",r),f._loadSequence(f._resubmit.bind(f)),t()}var t="function"==typeof t?t:function(){};if(!f._pending.length)return t();var i={account:f._accountID,ledger_index_min:-1,ledger_index_max:-1,binary:!0,parseBinary:!0,limit:100,filter:"outbound"};f._remote.requestAccountTx(i,n),f.emit("reconnect")}function a(){f._remote.once("connect",i),f._remote.removeListener("ledger_closed",r)}function h(t){f._remote.storage.saveTransaction(t.summary())}s.call(this);var f=this;this._account=t,this._accountID=t._account_id,this._remote=t._remote,this._nextSequence=void 0,this._maxFee=this._remote.max_fee,this._submissionTimeout=this._remote._submission_timeout,this._pending=new c,this._loadSequence(),this._account.on("transaction-outbound",e),this._remote.on("load_changed",this._adjustFees.bind(this)),this._remote.on("ledger_closed",r),this._remote.on("disconnect",a),this._remote.storage&&this.on("save",h)}var i=r(38),s=r(37).EventEmitter,o=r(5).Transaction,a=r(13).RippleError,c=r(45).TransactionQueue,u=r(24).internal.sub("transactionmanager");i.inherits(n,s),n.normalizeTransaction=function(t){var e={};return Object.keys(t).forEach(function(r){e[r]=t[r]}),t.engine_result||(e={engine_result:t.meta.TransactionResult,tx_json:t.tx,hash:t.tx.hash,ledger_index:t.tx.ledger_index,meta:t.meta,type:"transaction",validated:!0},e.result=e.engine_result,e.result_message=e.engine_result_message),e.metadata||(e.metadata=e.meta),e.tx_json||(e.tx_json=e.transaction),delete e.transaction,delete e.mmeta,delete e.meta,e},n.prototype._adjustFees=function(){var t=this;this._remote.local_fee&&this._pending.forEach(function(e){function r(){e.once("presubmit",function(){e.emit("error","tejMaxFeeExceeded")})}var n=e.tx_json.Fee,i=e._computeFee();return Number(i)>t._maxFee?r():(e.tx_json.Fee=i,e.emit("fee_adjusted",n,i),void(t._remote.trace&&u.info("fee adjusted:",e.tx_json,n,i)))})},n.prototype._fillSequence=function(t,e){function r(e,r){var n=i._remote.transaction();n.account_set(i._accountID),n.tx_json.Sequence=e,n.once("submitted",r),t._secret&&n.secret(t._secret),n.submit()}function n(n,i){if("number"!=typeof i)return e(new Error("Failed to fetch account transaction sequence"));var s=t.tx_json.Sequence-i,o=0;!function a(n){n>=t.tx_json.Sequence||r(n,function(){++o===s?e():a(n+1)})}(i)}var i=this;this._loadSequence(n)},n.prototype._loadSequence=function(t){function e(e,n){"number"==typeof n?(r._nextSequence=n,r.emit("sequence_loaded",n),"function"==typeof t&&t(e,n)):setTimeout(function(){r._loadSequence(t)},3e3)}var r=this;this._account.getNextSequence(e)},n.prototype._resubmit=function(t,e){function r(t){if(t&&!t.finalized){var e=t.findId(i._pending._idCache);if(i._remote.trace&&u.info("resubmit:",t.tx_json),e)return t.emit("success",e);for(;i._pending.hasSequence(t.tx_json.Sequence);)t.tx_json.Sequence+=1,i._remote.trace&&u.info("incrementing sequence:",t.tx_json);i._request(t)}}function n(){!function t(n){var s=e[n];s instanceof o&&(s.once("submitted",function(r){s.emit("resubmitted",r),i._loadSequence(),++n<e.length&&t(n)}),r(s))}(0)}var i=this,e=e?[e]:this._pending,t=Number(t)||0;this._waitLedgers(t,n)},n.prototype._waitLedgers=function(t,e){function r(){++i<t||(n._remote.removeListener("ledger_closed",r),e())}if(1>t)return e();var n=this,i=0;this._remote.on("ledger_closed",r)},n.prototype._request=function(t){function e(e){t.finalized||(e.rejected=t.isRejected(e.engine_result_code),t.emit("proposed",e))}function r(e){if(!t.finalized)switch(e.engine_result){case"tefPAST_SEQ":_._resubmit(1,t);break;default:t.emit("error",e)}}function i(){t.finalized||_._fillSequence(t,function(){_._resubmit(1,t)})}function s(e){t.finalized||t.emit("error",e)}function o(e){t.finalized||(_._remote.local_fee&&"telINSUF_FEE_P"===e.engine_result?_._resubmit(2,t):c(e))}function c(e){t.finalized||(n._isTooBusy(e)?_._resubmit(1,t):(_._nextSequence--,t.emit("error",e)))}function h(n){if(!t.finalized)switch(n.tx_json&&n.tx_json.hash&&t.addId(n.tx_json.hash),n.result=n.engine_result||"",t.result=n,d.trace&&u.info("submit response:",n),t.emit("submitted",n),n.result.slice(0,3)){case"tes":e(n);break;case"tec":s(n);break;case"ter":i(n);break;case"tef":r(n);break;case"tel":o(n);break;default:c(n)}}function f(){d.local_signing?(m.tx_blob(t.serialize().to_hex()),t.addId(t.hash())):(m.build_path(t._build_path),m.secret(t._secret),m.tx_json(t.tx_json)),t._server&&(m.server=t._server),p()}function l(){t.finalized||(t.emit("timeout"),d._connected&&(d.trace&&u.info("timeout:",t.tx_json),_._resubmit(3,t)))}function p(){t.finalized||(m.timeout(_._submissionTimeout,l),m.broadcast(),t.attempts++,t.emit("postsubmit"))}var _=this,d=this._remote;if(t.attempts>10)return t.emit("error",new a("tejAttemptsExceeded"));if(t.attempts>0&&!d.local_signing){var y="It is not possible to resubmit transactions automatically safely without synthesizing the transactionID locally. See `local_signing` config option";return t.emit("error",new a("tejLocalSigningRequired",y))}if(t.emit("presubmit"),!t.finalized){d.trace&&u.info("submit transaction:",t.tx_json);var m=d.requestSubmit();return m.once("error",h),m.once("success",h),t.submitIndex=this._remote._ledger_current_index,0===t.attempts&&(t.initialSubmitIndex=t.submitIndex),t._setLastLedger||(t.tx_json.LastLedgerSequence=t.submitIndex+8),t.lastLedgerSequence=t.tx_json.LastLedgerSequence,d.local_signing?t.sign(f):f(),m}},n._isNoOp=function(t){return"object"==typeof t&&"object"==typeof t.tx_json&&"AccountSet"===t.tx_json.TransactionType&&0===t.tx_json.Flags},n._isRemoteError=function(t){return"object"==typeof t&&"remoteError"===t.error&&"object"==typeof t.remote},n._isNotFound=function(t){return n._isRemoteError(t)&&/^(txnNotFound|transactionNotFound)$/.test(t.remote.error)},n._isTooBusy=function(t){return n._isRemoteError(t)&&"tooBusy"===t.remote.error},n.prototype.submit=function(t){function e(e){r._pending.remove(t),t.emit("final",e),n.trace&&u.info("transaction finalized:",t.tx_json,r._pending.getLength())}var r=this,n=this._remote;if("number"!=typeof this._nextSequence)return void this.once("sequence_loaded",this.submit.bind(this,t));if(!t.finalized){if(t.once("cleanup",e),t.on("save",function(){r.emit("save",t)}),t.once("error",function(e){t._errorHandler(e)}),t.once("success",function(e){t._successHandler(e)}),t.once("abort",function(){t.emit("error",new a("tejAbort","Transaction aborted"))}),"number"!=typeof t.tx_json.Sequence&&(t.tx_json.Sequence=this._nextSequence++),!t.complete())return void this._nextSequence--;t.attempts=0,this._pending.push(t),this._request(t)}},e.TransactionManager=n},function(t,e){var r=e.Float={};r.toIEEE754=function(t,e,r){var n,i,s,o=(1<<e-1)-1;if(isNaN(t))i=(1<<o)-1,s=1,n=0;else if(1/0===t||t===-1/0)i=(1<<o)-1,s=0,n=0>t?1:0;else if(0===t)i=0,s=0,n=1/t===-1/0?1:0;else if(n=0>t,t=Math.abs(t),t>=Math.pow(2,1-o)){var a=Math.min(Math.floor(Math.log(t)/Math.LN2),o);i=a+o,s=t*Math.pow(2,r-a)-Math.pow(2,r)}else i=0,s=t/Math.pow(2,1-o-r);var c,u=[];for(c=r;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(n?1:0),u.reverse();for(var h=u.join(""),f=[];h.length;)f.push(parseInt(h.substring(0,8),2)),h=h.substring(8);return f},r.fromIEEE754=function(t,e,r){for(var n=[],i=t.length;i;i-=1)for(var s=t[i-1],o=8;o;o-=1)n.push(s%2?1:0),s>>=1;n.reverse();var a=n.join(""),c=(1<<e-1)-1,u=parseInt(a.substring(0,1),2)?-1:1,h=parseInt(a.substring(1,1+e),2),f=parseInt(a.substring(1+e),2);return h===(1<<e)-1?0!==f?0/0:1/0*u:h>0?u*Math.pow(2,h-c)*(1+f/Math.pow(2,r)):0!==f?u*Math.pow(2,-(c-1))*(f/Math.pow(2,r)):0*u},r.fromIEEE754Double=function(t){return r.fromIEEE754(t,11,52)},r.toIEEE754Double=function(t){return r.toIEEE754(t,11,52)},r.fromIEEE754Single=function(t){return r.fromIEEE754(t,8,23)},r.toIEEE754Single=function(t){return r.toIEEE754(t,8,23)},r.toIEEE754DoubleString=function(t){return e.toIEEE754Double(t).map(function(t){for(t=t.toString(2);t.length<8;t="0"+t);return t}).join("").replace(/(.)(.{11})(.{52})/,"$1 $2 $3")}},function(t,e){e.HASH_TX_ID=1415073280,e.HASH_TX_NODE=1397638144,e.HASH_INNER_NODE=1296649728,e.HASH_LEAF_NODE=1296846336,e.HASH_TX_SIGN=1398036480,e.HASH_TX_SIGN_TESTNET=1937012736},function(t,e,r){var n=r(19),i=n.sjcl,s=r(21),o=n.jsbn.BigInteger,a=function(){this._value=0/0,this._update()};a.json_rewrite=function(t,e){return this.from_json(t).to_json(e)},a.from_generic=function(t){return t instanceof this?t.clone():(new this).parse_generic(t)},a.from_hex=function(t){return t instanceof this?t.clone():(new this).parse_hex(t)},a.from_json=function(t){return t instanceof this?t.clone():(new this).parse_json(t)},a.from_bits=function(t){return t instanceof this?t.clone():(new this).parse_bits(t)},a.from_bytes=function(t){return t instanceof this?t.clone():(new this).parse_bytes(t)},a.from_bn=function(t){return t instanceof this?t.clone():(new this).parse_bn(t)},a.from_number=function(t){return t instanceof this?t.clone():(new this).parse_number(t)},a.is_valid=function(t){return this.from_json(t).is_valid()},a.prototype.clone=function(){return this.copyTo(new this.constructor)},a.prototype.copyTo=function(t){return t._value=this._value,"function"==typeof t._update&&t._update(),t},a.prototype.equals=function(t){return this._value instanceof o&&t._value instanceof o&&this._value.equals(t._value)},a.prototype.is_valid=function(){return this._value instanceof o},a.prototype.is_zero=function(){return this._value.equals(o.ZERO)},a.prototype._update=function(){},a.prototype.parse_generic=function(t){switch(s.accounts&&t in s.accounts&&(t=s.accounts[t].account),t){case void 0:case"0":case this.constructor.STR_ZERO:case this.constructor.ACCOUNT_ZERO:case this.constructor.HEX_ZERO:this._value=o.valueOf();break;case"1":case this.constructor.STR_ONE:case this.constructor.ACCOUNT_ONE:case this.constructor.HEX_ONE:this._value=new o([1]);break;default:this._value="string"!=typeof t?0/0:this.constructor.width===t.length?new o(n.stringToArray(t),256):2*this.constructor.width===t.length?new o(t,16):0/0}return this._update(),this},a.prototype.parse_hex=function(t){return this._value="string"==typeof t&&t.length===2*this.constructor.width?new o(t,16):0/0,this._update(),this},a.prototype.parse_bits=function(t){if(i.bitArray.bitLength(t)!==8*this.constructor.width)this._value=0/0;else{var e=i.codec.bytes.fromBits(t);this.parse_bytes(e)}return this._update(),this},a.prototype.parse_bytes=function(t){return this._value=Array.isArray(t)&&t.length===this.constructor.width?new o([0].concat(t),256):0/0,this._update(),this},a.prototype.parse_json=a.prototype.parse_hex,a.prototype.parse_bn=function(t){if(t instanceof i.bn&&t.bitLength()<=8*this.constructor.width){var e=i.codec.bytes.fromBits(t.toBits());this._value=new o(e,256)}else this._value=0/0;return this._update(),this},a.prototype.parse_number=function(t){return this._value=0/0,"number"==typeof t&&isFinite(t)&&t>=0&&(this._value=new o(String(t))),this._update(),this},a.prototype.to_bytes=function(){if(!(this._value instanceof o))return null;var t=this._value.toByteArray();t=t.map(function(t){return(t+256)%256});var e=this.constructor.width;for(t=t.slice(-e);t.length<e;)t.unshift(0);return t},a.prototype.to_hex=function(){if(!(this._value instanceof o))return null;var t=this.to_bytes();return i.codec.hex.fromBits(i.codec.bytes.toBits(t)).toUpperCase()},a.prototype.to_json=a.prototype.to_hex,a.prototype.to_bits=function(){if(!(this._value instanceof o))return null;var t=this.to_bytes();return i.codec.bytes.toBits(t)},a.prototype.to_bn=function(){if(!(this._value instanceof o))return null;var t=this.to_bits();return i.bn.fromBits(t)},e.UInt=a},function(t,e,r){function n(){this._curve=s.ecc.curves.c256,this._secret=null,this._pubkey=null}function i(t){return s.hash.ripemd160.hash(s.hash.sha256.hash(t))}var s=r(19).sjcl,o=r(8).UInt160,a=r(9).UInt256,c=r(7).Base;n.from_bn_secret=function(t){return t instanceof this?t.clone():(new this).parse_bn_secret(t)},n.prototype.parse_bn_secret=function(t){return this._secret=new s.ecc.ecdsa.secretKey(s.ecc.curves.c256,t),this},n.prototype._pub=function(){var t=this._curve;if(!this._pubkey&&this._secret){var e=this._secret._exponent;this._pubkey=new s.ecc.ecdsa.publicKey(t,t.G.mult(e))}return this._pubkey},n.prototype._pub_bits=function(){var t=this._pub();if(!t)return null;var e=t._point,r=e.y.mod(2).equals(0);return s.bitArray.concat([s.bitArray.partial(8,r?2:3)],e.x.toBits(this._curve.r.bitLength()))},n.prototype.to_hex_pub=function(){var t=this._pub_bits();return t?s.codec.hex.fromBits(t).toUpperCase():null},n.prototype.get_address=function(){var t=this._pub_bits();if(!t)return null;var e=i(t),r=o.from_bits(e);return r.set_version(c.VER_ACCOUNT_ID),r},n.prototype.sign=function(t){t=a.from_json(t);var e=this._secret.sign(t.to_bits(),0);return e=this._secret.canonicalizeSignature(e),this._secret.encodeDER(e)},e.KeyPair=n},function(t,e,r){function n(t){return"number"==typeof t&&isFinite(t)}function i(t){return"string"==typeof t}function s(t){return i(t)&&/^[0-9A-F]{0,16}$/i.test(t)}function o(t){return t instanceof j}function a(t,e,r){var n=k.fromBits(T.toBits(e));r||B.serialize_varint(t,n.length),t.append(n)}function c(t){return v.codec.hex.fromBits(v.codec.bytes.toBits(t)).toUpperCase()}function u(t,e,r){if(!n(e))throw new Error("Value is not a number");if(0>e||e>=Math.pow(256,r))throw new Error("Value out of bounds");for(var i=[],s=0;r>s;s++)i.unshift(e>>>8*s&255);t.append(i)}function h(t,e){var r=0;if(e>4)throw new Error("This function only supports up to four bytes.");for(var n=0;e>n;n++){var i=t.read(1)[0];r+=i<<8*(e-n-1)}return r>>>0}function f(t,r,n){var i=y.fieldsInverseMap[r],s=i[0],o=i[1],a=(16>s?s<<4:0)|(16>o?o:0);"LedgerEntryType"===r&&"string"==typeof n&&(n=y.ledger[n][0]),"TransactionResult"===r&&"string"==typeof n&&(n=y.ter[n]),R.serialize(t,a),s>=16&&R.serialize(t,s),o>=16&&R.serialize(t,o);var c=e[y.types[s]];c.serialize(t,n)}function l(t){var r=t.read(1)[0],n=r>>4;0===n&&(n=t.read(1)[0]);var i=e[y.types[n]];_(i,"Unknown type - header byte is 0x"+r.toString(16));var s=15&r,o=o=0===s?y.fields[n][t.read(1)[0]]:y.fields[n][s];return _(o,"Unknown field - header byte is 0x"+r.toString(16)),[o,i.parse(t)]}function p(t){function e(t,e){var r=y.fieldsInverseMap[t],n=r[0],i=r[1],s=y.fieldsInverseMap[e],o=s[0],a=s[1];return n!==o?n-o:i-a}return t.sort(e)}var _=r(40),d=r(44),y=r(18),m=r(19),v=m.sjcl,g=r(46).UInt128,b=r(8).UInt160,w=r(9).UInt256,E=r(7).Base,x=r(3),S=x.Amount,A=x.Currency,T=v.codec.hex,k=v.codec.bytes,j=m.jsbn.BigInteger,B=function(t){d(this,t)};B.serialize_varint=function(t,e){if(0>e)throw new Error("Variable integers are unsigned.");if(192>=e)t.append([e]);else if(12480>=e)e-=193,t.append([193+(e>>>8),255&e]);else{if(!(918744>=e))throw new Error("Variable integer overflow.");e-=12481,t.append([241+(e>>>16),e>>>8&255,255&e])}},B.prototype.parse_varint=function(t){var e,r,n,i=t.read(1)[0];if(i>254)throw new Error("Invalid varint length indicator");return 192>=i?n=i:240>=i?(e=t.read(1)[0],n=193+256*(i-193)+e):254>=i&&(e=t.read(1)[0],r=t.read(1)[0],n=12481+65536*(i-241)+256*e+r),n};var R=e.Int8=new B({serialize:function(t,e){u(t,e,1)},parse:function(t){return h(t,1)}});R.id=16;var I=e.Int16=new B({serialize:function(t,e){u(t,e,2)},parse:function(t){return h(t,2)}});I.id=1;var q=e.Int32=new B({serialize:function(t,e){u(t,e,4)},parse:function(t){return h(t,4)}});q.id=2;var C=e.Int64=new B({serialize:function(t,e){var r;if(n(e)){if(e=Math.floor(e),0>e)throw new Error("Negative value for unsigned Int64 is invalid.");r=new j(String(e),10)}else if(i(e)){if(!s(e))throw new Error("Not a valid hex Int64.");r=new j(e,16)}else{if(!o(e))throw new Error("Invalid type for Int64");if(e.compareTo(j.ZERO)<0)throw new Error("Negative value for unsigned Int64 is invalid.");r=e}var c=r.toString(16);if(c.length>16)throw new Error("Int64 is too large");for(;c.length<16;)c="0"+c;a(t,c,!0)},parse:function(t){var e=t.read(8),r=new j([0].concat(e),256);return _(r instanceof j),r}});C.id=3;var D=e.Hash128=new B({serialize:function(t,e){var r=g.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash128");a(t,r.to_hex(),!0)},parse:function(t){return g.from_bytes(t.read(16))}});D.id=4;var O=e.Hash256=new B({serialize:function(t,e){var r=w.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash256");a(t,r.to_hex(),!0)},parse:function(t){return w.from_bytes(t.read(32))}});O.id=5;var L=e.Hash160=new B({serialize:function(t,e){var r=b.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash160");a(t,r.to_hex(),!0)},parse:function(t){return b.from_bytes(t.read(20))}});L.id=17;var M=new B({serialize:function(t,e){var r=e.to_bytes();if(!r)throw new Error("Tried to serialize invalid/unimplemented currency type.");t.append(r)},parse:function(t){var e=t.read(20),r=A.from_bytes(e);return r}}),N=e.Amount=new B({serialize:function(t,e){var r=S.from_json(e);if(!r.is_valid())throw new Error("Not a valid Amount object.");var n=m.arraySet(8,0);if(r.is_native()){var i=r._value.toString(16);if(i.length>16)throw new Error("Value out of bounds");for(;i.length<16;)i="0"+i;n=k.fromBits(T.toBits(i)),n[0]&=63,r.is_negative()||(n[0]|=64)}else{var s=0,o=0;s|=1<<31,r.is_zero()||(r.is_negative()||(s|=1<<30),s|=(97+r._offset&255)<<22,s|=4194303&r._value.shiftRight(32).intValue(),o=4294967295&r._value.intValue()),n=v.codec.bytes.fromBits([s,o])}if(t.append(n),!r.is_native()){var a=r.currency();M.serialize(t,a,!0),t.append(r.issuer().to_bytes())}},parse:function(t){for(var e=new S,r=t.read(8),n=!(127&r[0]),i=1;8>i;i++)n=n&&!r[i];if(128&r[0]){var s=M.parse(t),o=t.read(20),a=b.from_bytes(o);a.set_version(E.VER_ACCOUNT_ID);var c=((63&r[0])<<2)+(r[1]>>>6)-97,u=r.slice(1);u[0]&=63;var h=new j(u,256);if(h.equals(j.ZERO)&&!n)throw new Error("Invalid zero representation");e._value=h,e._offset=c,e._currency=s,e._issuer=a,e._is_native=!1}else{var f=r.slice();f[0]&=63,e._value=new j(f,256),e._is_native=!0}return e._is_negative=!(n||64&r[0]),e}});N.id=6;var F=e.VariableLength=e.VL=new B({serialize:function(t,e){if("string"!=typeof e)throw new Error("Unknown datatype.");a(t,e)},parse:function(t){var e=this.parse_varint(t);return c(t.read(e))}});F.id=7;var P=e.Account=new B({serialize:function(t,e){var r=b.from_json(e);if(!r.is_valid())throw new Error("Invalid account!");a(t,r.to_hex())},parse:function(t){var e=this.parse_varint(t);if(20!==e)throw new Error("Non-standard-length account ID");var r=b.from_bytes(t.read(e));return r.set_version(E.VER_ACCOUNT_ID),r}});P.id=8;var z=e.PathSet=new B({typeBoundary:255,typeEnd:0,typeAccount:1,typeCurrency:16,typeIssuer:32,serialize:function(t,e){for(var r=0,n=e.length;n>r;r++){r&&R.serialize(t,this.typeBoundary);for(var i=0,s=e[r].length;s>i;i++){var o=e[r][i],a=0;if(o.account&&(a|=this.typeAccount),o.currency&&(a|=this.typeCurrency),o.issuer&&(a|=this.typeIssuer),R.serialize(t,a),o.account&&t.append(b.from_json(o.account).to_bytes()),o.currency){var c=A.from_json(o.currency,o.non_native);M.serialize(t,c)}o.issuer&&t.append(b.from_json(o.issuer).to_bytes())}}R.serialize(t,this.typeEnd)},parse:function(t){for(var e,r=[],n=[];(e=t.read(1)[0])!==this.typeEnd;)if(e!==this.typeBoundary){var i={};if(e&this.typeAccount&&(i.account=L.parse(t),i.account.set_version(E.VER_ACCOUNT_ID)),e&this.typeCurrency&&(i.currency=M.parse(t),"XRP"!==i.currency.to_json()||i.currency.is_native()||(i.non_native=!0)),e&this.typeIssuer&&(i.issuer=L.parse(t),i.issuer.set_version(E.VER_ACCOUNT_ID)),!(i.account||i.currency||i.issuer))throw new Error("Invalid path entry");n.push(i)}else n&&r.push(n),n=[];return n&&r.push(n),r}});z.id=18;var U=e.Vector256=new B({serialize:function(t,e){for(var r=(B.serialize_varint(t,32*e.length),0),n=e.length;n>r;r++)O.serialize(t,e[r])},parse:function(t){for(var e=this.parse_varint(t),r=[],n=0;e/32>n;n++)r.push(O.parse(t));return r}});U.id=19,e.serialize=e.serialize_whatever=f,e.parse=e.parse_whatever=l;var H=e.Object=new B({serialize:function(t,e,r){var n=Object.keys(e);n=n.filter(function(t){return t[0]!==t[0].toLowerCase()}),n.forEach(function(t){if("undefined"==typeof y.fieldsInverseMap[t])throw new Error('JSON contains unknown field: "'+t+'"')}),n=p(n);for(var i=0;i<n.length;i++)f(t,n[i],e[n[i]]);r||R.serialize(t,225)},parse:function(t){for(var e={};225!==t.peek(1)[0];){var r=l(t);e[r[0]]=r[1]}return t.read(1),e}});H.id=14;var V=e.Array=new B({serialize:function(t,e){for(var r=0,n=e.length;n>r;r++){var i=Object.keys(e[r]);if(1!==i.length)throw Error("Cannot serialize an array containing non-single-key objects");var s=i[0],o=e[r][s];f(t,s,o)}R.serialize(t,241)},parse:function(t){for(var e=[];241!==t.peek(1)[0];){var r=l(t),n={};n[r[0]]=r[1],e.push(n)}return t.read(1),e}});V.id=15},function(t,e,r){function n(t,e){var r=e<<3;"string"==typeof t&&(t=s.codec.utf8String.toBits(t));for(var n=0,i=[];s.bitArray.bitLength(i)<r;){var o=s.hash.sha512.hash(s.bitArray.concat([n],t));i=s.bitArray.concat(i,o),n++}return i=s.bitArray.clamp(i,r)}function i(t,e){var r=new s.misc.hmac(t,s.hash.sha512);return s.codec.hex.fromBits(s.bitArray.bitSlice(r.encrypt(e),0,256))}var s=r(19).sjcl,o=r(7).Base,a=r(10).Seed,c=r(8).UInt160,u=r(9).UInt256,h=r(54),f=(r(55),r(44)),l=(r(43),{}),p={cipher:"aes",mode:"ccm",ts:64,ks:256,iter:1e3};l.derive=function(t,e,r,o,a){var c;c="login"===e?["id","crypt"]:["unlock"];var u=new s.bn(String(t.exponent)),f=new s.bn(String(t.modulus)),l=new s.bn(String(t.alpha)),p=["PAKDF_1_0_0",t.host.length,t.host,r.length,r,e.length,e].join(":")+":",_=Math.ceil(Math.min(7+f.bitLength()>>>3,256)/8),d=n(p,_),y=s.codec.hex.fromBits(d),m=new s.bn(String(y)).setBitM(0),v=[p,o.length,o].join(":")+":",g=7+f.bitLength()>>>3,b=n(v,g),w=s.codec.hex.fromBits(b),E=new s.bn(String(w)).mod(f);1!==E.jacobi(f)&&(E=E.mul(l).mod(f));for(var x;x=s.bn.random(f,0),1!==x.jacobi(f););var S=x.powermodMontgomery(m.mul(u),f),A=E.mulmod(S,f),T=s.codec.hex.fromBits(A.toBits());h.post(t.url).send({info:p,signreq:T}).end(function(e,r){if(e||!r)return a(new Error("Could not query PAKDF server "+t.host));var n=r.body||r.text?JSON.parse(r.text):{};if("success"!==n.result)return a(new Error("Could not query PAKDF server "+t.host));var o=new s.bn(String(n.signres)),u=x.inverseMod(f),h=o.mulmod(u,f),l=h.toBits(),p={};c.forEach(function(t){p[t]=i(l,t)}),a(null,p)})},l.encrypt=function(t,e){t=s.codec.hex.toBits(t);var r=f(!0,{},p),n=JSON.parse(s.encrypt(t,e,r)),i=[s.bitArray.partial(8,0)],o=s.codec.base64.toBits(n.iv),a=s.codec.base64.toBits(n.ct),c=s.bitArray.concat(i,o);return c=s.bitArray.concat(c,a),s.codec.base64.fromBits(c)},l.decrypt=function(t,e){t=s.codec.hex.toBits(t);var r=s.codec.base64.toBits(e),n=s.bitArray.extract(r,0,8);if(0!==n)throw new Error("Unsupported encryption version: "+n);var i=f(!0,{},p,{iv:s.codec.base64.fromBits(s.bitArray.bitSlice(r,8,136)),ct:s.codec.base64.fromBits(s.bitArray.bitSlice(r,136))});return s.decrypt(t,JSON.stringify(i))},l.isValidAddress=function(t){return c.is_valid(t)},l.createSecret=function(t){return s.codec.hex.fromBits(s.random.randomWords(t))},l.createMaster=function(){return o.encode_check(33,s.codec.bytes.fromBits(s.random.randomWords(4)))},l.getAddress=function(t){return a.from_json(t).get_key().get_address().to_json()},l.hashSha512=function(t){return s.codec.hex.fromBits(s.hash.sha512.hash(t))},l.hashSha512Half=function(t){return u.from_hex(l.hashSha512(t).substr(0,64))},l.signString=function(t,e){var r=new s.misc.hmac(s.codec.hex.toBits(t),s.hash.sha512);return s.codec.hex.fromBits(r.mac(e))},l.deriveRecoveryEncryptionKeyFromSecret=function(t){var e=a.from_json(t).to_bits(),r=new s.misc.hmac(e,s.hash.sha512),n=r.mac("ripple/hmac/recovery_encryption_key/v1");return n=s.bitArray.bitSlice(n,0,256),s.codec.hex.fromBits(n)},l.base64ToBase64Url=function(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,"")},l.base64UrlToBase64=function(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4;)t+="=";return t},e.Crypt=l},function(t,e,r){function n(t,e,r){this.url=t,this.id=e,this.key=r,this.identity=new b(this),this.data={}}function i(t,e){var r=o.deriveRecoveryEncryptionKeyFromSecret(t);return o.decrypt(r,e)}function s(t,e){return/(number|string)/.test(typeof t[0])?t=[t]:1===t.length&&Array.isArray(t[0])&&/(number|string)/.test(typeof t[0][0])||Array.isArray(t[0])&&(t=t[0]),t=t.map(function(t){if("string"==typeof t[0]&&(t[0]=n.ops[t[0]]),"number"!=typeof t[0])throw new Error("Invalid op in subcommand");if("string"!=typeof t[1])throw new Error("Invalid path in subcommand");return t}),e?1===t.length?t[0]:[t]:t}var o=r(31).Crypt,a=r(47).SignedRequest,c=r(54),u=r(44),h=r(53),f=r(24).sub("blob"),l={};n.ops={noop:0,set:16,unset:17,extend:18,push:32,pop:33,shift:34,unshift:35,filter:36},n.opsReverseMap=[];for(var p in n.ops)n.opsReverseMap[n.ops[p]]=p;var _="identityVault",d=["name","entityType","email","phone","address","nationalID","birthday","birthplace"],y=["individual","organization","corporation"],m=["contact","line1","line2","city","region","postalCode","country"],v=["number","type","country"],g=["ssn","taxID","passport","driversLicense","other"];n.prototype.init=function(t){var e,r=this;-1===r.url.indexOf("://")&&(r.url="http://"+e),e=r.url+"/v1/blob/"+r.id,c.get(e,function(e,n){if(e||!n.body||"success"!==n.body.result)return t(new Error("Could not retrieve blob"));if(r.revision=n.body.revision,r.encrypted_secret=n.body.encrypted_secret,r.missing_fields=n.body.missing_fields,!r.decrypt(n.body.blob))return t(new Error("Error while decrypting blob"));if(n.body.patches&&n.body.patches.length){var i=!0;n.body.patches.forEach(function(t){i=i&&r.applyEncryptedPatch(t)}),i&&r.consolidate()}t(null,r)}).timeout(8e3)},n.prototype.consolidate=function(t){"function"!=typeof t&&(t=function(){});var e=this.encrypt(),r={method:"POST",url:this.url+"/v1/blob/consolidate",dataType:"json",data:{blob_id:this.id,data:e,revision:this.revision}},n=new a(r),i=n.signHmac(this.data.auth_secret,this.id);c.post(i.url).send(i.data).end(function(e,r){e?t(new Error("Failed to consolidate blob - XHR error")):r.body&&"success"===r.body.result?t(null,r.body):t(new Error("Failed to consolidate blob"))})},n.prototype.applyEncryptedPatch=function(t){try{var e=JSON.parse(o.decrypt(this.key,t)),r=e.shift(),n=e.shift();return this.applyUpdate(r,n,e),this.revision++,!0}catch(i){return!1}},n.prototype.encryptSecret=function(t,e){return o.encrypt(t,e)},n.prototype.decryptSecret=function(t){return o.decrypt(t,this.encrypted_secret)},n.prototype.decrypt=function(t){try{return this.data=JSON.parse(o.decrypt(this.key,t)),this}catch(e){return!1}},n.prototype.encrypt=function(){return o.encrypt(this.key,JSON.stringify(this.data))},n.prototype.encryptBlobCrypt=function(t,e){var r=o.deriveRecoveryEncryptionKeyFromSecret(t);return o.encrypt(r,e)},n.prototype.set=function(t,e,r){return t=="/"+_&&this.data[_]?r(new Error("Cannot overwrite Identity Vault")):(this.applyUpdate("set",t,[e]),void this.postUpdate("set",t,[e],r))},n.prototype.unset=function(t,e){return t=="/"+_?e(new Error("Cannot remove Identity Vault")):(this.applyUpdate("unset",t,[]),void this.postUpdate("unset",t,[],e))},n.prototype.extend=function(t,e,r){this.applyUpdate("extend",t,[e]),this.postUpdate("extend",t,[e],r)},n.prototype.unshift=function(t,e,r){this.applyUpdate("unshift",t,[e]),this.postUpdate("unshift",t,[e],r)},n.prototype.filter=function(t,e,r,n,i){var o=Array.prototype.slice.apply(arguments);"function"==typeof o[o.length-1]&&(i=o.pop()),o.shift(),o=o.slice(0,2).concat(s(o.slice(2),!0)),this.applyUpdate("filter",t,o),this.postUpdate("filter",t,o,i)},n.prototype.applyUpdate=function(t,e,r){if("number"==typeof t&&(t=n.opsReverseMap[t]),"string"!=typeof t)throw new Error("Blob update op code must be a number or a valid op id string");var i=e.split("/"),s=i.shift();if(""!==s)throw new Error("Invalid JSON pointer: "+e);this._traverse(this.data,i,e,t,r)},n.prototype._traverse=function(t,e,r,n,i){var o=this,a=o.unescapeToken(e.shift());if(Array.isArray(t)){if("-"===a)a=t.length;
else if(a%1!==0&&a>=0)throw new Error(0/0)}else{if("object"!=typeof t)return null;if(!t.hasOwnProperty(a))if("set"===n)t[a]={};else{if("unshift"!==n)return null;t[a]=[]}}if(0!==e.length)return this._traverse(t[a],e,r,n,i);switch(n){case"set":t[a]=i[0];break;case"unset":Array.isArray(t)?t.splice(a,1):delete t[a];break;case"extend":if("object"!=typeof t[a])throw new Error("Tried to extend a non-object");u(!0,t[a],i[0]);break;case"unshift":if("undefined"==typeof t[a])t[a]=[];else if(!Array.isArray(t[a]))throw new Error('Operator "unshift" must be applied to an array.');t[a].unshift(i[0]);break;case"filter":Array.isArray(t[a])&&t[a].forEach(function(t,e){if("object"==typeof t&&t.hasOwnProperty(i[0])&&t[i[0]]===i[1]){var n=r+"/"+e,a=s(i.slice(2));a.forEach(function(t){var e=t[0],r=n+t[1];o.applyUpdate(e,r,t.slice(2))})}});break;default:throw new Error("Unsupported op "+n)}},n.prototype.escapeToken=function(t){return t.replace(/[~\/]/g,function(t){return"~"===t?"~0":"~1"})},n.prototype.unescapeToken=function(t){return t.replace(/~./g,function(t){switch(t){case"~0":return"~";case"~1":return"/"}throw new Error("Invalid tilde escape: "+t)})},n.prototype.postUpdate=function(t,e,r,i){if("function"!=typeof i&&(i=function(){}),"string"==typeof t&&(t=n.ops[t]),"number"!=typeof t)throw new Error("Blob update op code must be a number or a valid op id string");if(0>t||t>255)throw new Error("Blob update op code out of bounds");r.unshift(e),r.unshift(t);var s={method:"POST",url:this.url+"/v1/blob/patch",dataType:"json",data:{blob_id:this.id,patch:o.encrypt(this.key,JSON.stringify(r))}},u=new a(s),h=u.signHmac(this.data.auth_secret,this.id);c.post(h.url).send(h.data).end(function(t,e){t?i(new Error("Patch could not be saved - XHR error")):e.body&&"success"===e.body.result?i(null,e.body):i(new Error("Patch could not be saved - bad result"))})};var b=function(t){this._getBlob=function(){return t}};b.prototype.getFullAddress=function(t){var e=this._getBlob();if(!(e&&e.data&&e.data[_]&&e.data[_].address))return"";var r=this.get("address",t),n="";return r.value.contact&&(n+=r.value.contact),r.value.line1&&(n+=" "+r.value.line1),r.value.line2&&(n+=" "+r.value.line2),r.value.city&&(n+=" "+r.value.city),r.value.region&&(n+=" "+r.value.region),r.value.postalCode&&(n+=" "+r.value.postalCode),r.value.country&&(n+=" "+r.value.country),n},b.prototype.getAll=function(t){var e=this._getBlob();if(!e||!e.data||!e.data[_])return{};var r={},n=e.data[_];for(var i in n)r[i]=this.get(i,t);return r},b.prototype.get=function(t,e){function r(t,e){var r,n={encrypted:!0};try{r=o.decrypt(t,e.value)}catch(i){return n.value=e.value,n.error=i,n}try{n.value=JSON.parse(r)}catch(i){n.value=r}return n}var n=this._getBlob();if(!n||!n.data||!n.data[_])return null;var i=n.data[_][t];return i&&i.encrypted?r(e,i):i?i:null},b.prototype.set=function(t,e,r,n){function i(t){return u?u.data?u.data[_]?t(null):void u.set("/"+_,{},function(e){return t(e?e:null)}):n(new Error("Invalid Blob")):n(new Error("Identity must be associated with a blob"))}function s(n){var i={};i[t]={encrypted:e?!0:!1,value:e?a(e,r):r},c._getBlob().extend("/"+_,i,n)}function a(t,e){return"object"==typeof e&&(e=JSON.stringify(e)),o.encrypt(t,e)}var c=this,u=this._getBlob();if(n||(n=function(){}),-1===d.indexOf(t))return n(new Error("invalid identity field"));if("address"===t){if("object"!=typeof r)return n(new Error("address must be an object"));for(var f in r)if(-1===m.indexOf(f))return n(new Error("invalid address field"))}else if("nationalID"===t){if("object"!=typeof r)return n(new Error("nationalID must be an object"));for(var l in r){if(-1===v.indexOf(l))return n(new Error("invalid nationalID field"));if("type"===l&&-1===g.indexOf(r[l]))return n(new Error("invalid nationalID type"))}}else if("entityType"===t&&-1===y.indexOf(r))return n(new Error("invalid entity type"));h.waterfall([i,s],n)},b.prototype.unset=function(t,e,r){r||(r=function(){});var n=this.get(t,e);return n&&n.error?r(n.error):void this._getBlob().unset("/"+_+"/"+t,r)},e.Blob=n,e.getRippleName=function(t,e,r){return o.isValidAddress(e)&&o.isValidAddress(e)?void c.get(t+"/v1/user/"+e,function(t,e){t?r(new Error("Unable to access vault sever")):e.body&&e.body.username?r(null,e.body.username):r(e.body&&e.body.exists===!1?new Error("No ripple name for this address"):new Error("Unable to determine if ripple name exists"))}):r(new Error("Invalid ripple address"))},l.get=function(t,e,r,i){var s=new n(t,e,r);s.init(i)},l.verify=function(t,e,r,n){t+="/v1/user/"+e+"/verify/"+r,c.get(t,function(t,e){t?n(new Error("Failed to verify the account - XHR error")):e.body&&"success"===e.body.result?n(null,e.body):n(new Error("Failed to verify the account"))})},l.resendEmail=function(t,e){var r={method:"POST",url:t.url+"/v1/user/email",data:{blob_id:t.id,username:t.username,email:t.email,hostlink:t.activateLink}},n=new a(r),i=n.signAsymmetric(t.masterkey,t.account_id,t.id);c.post(i.url).send(i.data).end(function(t,r){t?(f.error("resendEmail:",t),e(new Error("Failed to resend the token"))):r.body&&"success"===r.body.result?e(null,r.body):r.body&&"error"===r.body.result?(f.error("resendEmail:",r.body.message),e(new Error("Failed to resend the token"))):e(new Error("Failed to resend the token"))})},l.recoverBlob=function(t,e){function r(r){var s=i(t.masterkey,r.body.encrypted_blobdecrypt_key),o=new n(t.url,r.body.blob_id,s);if(o.revision=r.body.revision,o.encrypted_secret=r.body.encrypted_secret,!o.decrypt(r.body.blob))return e(new Error("Error while decrypting blob"));if(r.body.patches&&r.body.patches.length){var a=!0;r.body.patches.forEach(function(t){a=a&&o.applyEncryptedPatch(t)}),a&&o.consolidate()}e(null,o)}var s=String(t.username).trim(),o={method:"GET",url:t.url+"/v1/user/recov/"+s},u=new a(o),h=u.signAsymmetricRecovery(t.masterkey,s);c.get(h.url).end(function(t,n){t?e(t):n.body&&"success"===n.body.result?n.body.encrypted_blobdecrypt_key?r(n):e(new Error("Missing encrypted blob decrypt key.")):e(n.body&&"error"===n.body.result?new Error(n.body.message):new Error("Could not recover blob"))})},l.updateProfile=function(t,e){var r={method:"POST",url:t.url+"/v1/user/"+t.username+"/profile",dataType:"json",data:t.profile},n=new a(r),i=n.signHmac(t.auth_secret,t.blob_id);c.post(i.url).send(i.data).end(function(t,r){t?(f.error("updateProfile:",t),e(new Error("Failed to update profile - XHR error"))):r.body&&"success"===r.body.result?e(null,r.body):r.body?f.error("updateProfile:",r.body):e(new Error("Failed to update profile"))})},l.updateKeys=function(t,e){var r=t.blob.id;t.blob.id=t.keys.id,t.blob.key=t.keys.crypt,t.blob.encrypted_secret=t.blob.encryptSecret(t.keys.unlock,t.masterkey);var n={method:"POST",url:t.blob.url+"/v1/user/"+t.username+"/updatekeys",data:{blob_id:t.blob.id,data:t.blob.encrypt(),revision:t.blob.revision,encrypted_secret:t.blob.encrypted_secret,encrypted_blobdecrypt_key:t.blob.encryptBlobCrypt(t.masterkey,t.keys.crypt)}},i=new a(n),s=i.signAsymmetric(t.masterkey,t.blob.data.account_id,r);c.post(s.url).send(s.data).end(function(t,r){t?(f.error("updateKeys:",t),e(new Error("Failed to update blob - XHR error"))):r.body&&"success"===r.body.result?e(null,r.body):(f.error("updateKeys:",r.body?r.body.message:null),e(new Error("Failed to update blob - bad result")))})},l.rename=function(t,e){var r=t.blob.id;t.blob.id=t.keys.id,t.blob.key=t.keys.crypt,t.blob.encryptedSecret=t.blob.encryptSecret(t.keys.unlock,t.masterkey);var n={method:"POST",url:t.blob.url+"/v1/user/"+t.username+"/rename",data:{blob_id:t.blob.id,username:t.new_username,data:t.blob.encrypt(),revision:t.blob.revision,encrypted_secret:t.blob.encryptedSecret,encrypted_blobdecrypt_key:t.blob.encryptBlobCrypt(t.masterkey,t.keys.crypt)}},i=new a(n),s=i.signAsymmetric(t.masterkey,t.blob.data.account_id,r);c.post(s.url).send(s.data).end(function(t,r){t?(f.error("rename:",t),e(new Error("Failed to rename"))):r.body&&"success"===r.body.result?e(null,r.body):r.body&&"error"===r.body.result?(f.error("rename:",r.body.message),e(new Error("Failed to rename"))):e(new Error("Failed to rename"))})},l.create=function(t,e){var r=new n(t.url,t.id,t.crypt);r.revision=0,r.data={auth_secret:o.createSecret(8),account_id:o.getAddress(t.masterkey),email:t.email,contacts:[],created:(new Date).toJSON()},r.encrypted_secret=r.encryptSecret(t.unlock,t.masterkey),t.oldUserBlob&&(r.data.contacts=t.oldUserBlob.data.contacts);var i={method:"POST",url:t.url+"/v1/user",data:{blob_id:t.id,username:t.username,address:r.data.account_id,auth_secret:r.data.auth_secret,data:r.encrypt(),email:t.email,hostlink:t.activateLink,domain:t.domain,encrypted_blobdecrypt_key:r.encryptBlobCrypt(t.masterkey,t.crypt),encrypted_secret:r.encrypted_secret}},s=new a(i),u=s.signAsymmetric(t.masterkey,r.data.account_id,t.id);c.post(u.url).send(u.data).end(function(t,n){t?e(t):n.body&&"success"===n.body.result?e(null,r,n.body):e(n.body&&"error"===n.body.result?new Error(n.body.message):new Error("Could not create blob"))})},l.deleteBlob=function(t,e){var r={method:"DELETE",url:t.url+"/v1/user/"+t.username},n=new a(r),i=n.signAsymmetric(t.masterkey,t.account_id,t.blob_id);c.del(i.url).end(function(t,r){t?e(t):r.body&&"success"===r.body.result?e(null,r.body):e(r.body&&"error"===r.body.result?new Error(r.body.message):new Error("Could not delete blob"))})},e.BlobClient=l},function(t,e,r){function n(t){return o.bitArray.bitSlice(o.hash.sha512.hash(o.codec.bytes.toBits(t)),0,256)}function i(t,e){return[].concat(t,e>>24,e>>16&255,e>>8&255,255&e)}function s(t){if(this.secret=t,!this.secret)throw"Invalid secret."}var o=r(66).sjcl,a=r(48),c=r(49),u=r(50),h=r(51);s.prototype={getPrivateKey:function(){var t=this;return a.decode_base_check(33,t.secret)},getPrivateGenerator:function(t){var e=0;do privateGenerator=o.bn.fromBits(n(i(t,e))),e++;while(!o.ecc.curves.c256.r.greaterEquals(privateGenerator));return privateGenerator},getPublicGenerator:function(){var t=this.getPrivateKey(this.secret),e=this.getPrivateGenerator(t);return h.fromPrivateGenerator(e)},getPublicKey:function(t){var e,r=0;do e=o.bn.fromBits(n(i(i(t.toBytesCompressed(),0),r))),r++;while(!o.ecc.curves.c256.r.greaterEquals(e));return o.ecc.curves.c256.G.mult(e).toJac().add(t).toAffine()},getAddress:function(){var t=this.getPrivateKey(this.secret),e=this.getPrivateGenerator(t),r=h.fromPrivateGenerator(e).value,n=this.getPublicKey(r);return u.fromPublicKey(n)}},s.getRandom=function(){var t=c.getRandom().value;return new s(t)},s.generate=function(){var t=c.getRandom().value,e=new s(t);return{address:e.getAddress().value,secret:t}},t.exports=s},function(t){"use strict";function e(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function r(t,e){var r=t.r.bitLength();return{r:o.bn.fromBits(o.bitArray.bitSlice(e,0,r)),s:o.bn.fromBits(o.bitArray.bitSlice(e,r,o.bitArray.bitLength(e)))}}function n(t,e,r,n,s){for(var a=s.toBits(),c=0;4>c;c++){var u;try{u=i(t,e,r,n,c)}catch(h){continue}if(o.bitArray.equal(u.toBits(),a))return c}throw new o.exception.bug("unable to calculate recovery factor from signature")}function i(t,e,r,n,i){var a=t.r,u=t.field.modulus;i=3&i;var h=1&i,f=i>>1;c||(c=u.add(1).div(4));var l;l=f?e.add(a):e;var p,_=l.mul(l).mul(l).add(t.a.mul(l)).add(t.b).mod(u),d=_.powermodMontgomery(c,u),y=d.mod(2).equals(0);p=y&&!h||!y&&h?d:u.sub(d);var m=new o.ecc.point(t,l,p);if(!m.isValidPoint())throw new o.exception.corrupt("point R. Not a valid point on the curve. Cannot recover public key");var v=o.bn.fromBits(n),g=new o.bn(0).sub(v).mod(a),b=e.inverseMod(a),w=m.mult2(r,g,t.G).mult(b);if(!w.isValidPoint())throw new o.exception.corrupt("public_key_point. Not a valid point on the curve. Cannot recover public key");if(!s(t,v,e,r,w))throw new o.exception.corrupt("cannot recover public key");return w}function s(t,e,r,n,i){var s=t.r;if(new o.bn(1).greaterEquals(r)||r.greaterEquals(new o.bn(s)))return!1;if(new o.bn(1).greaterEquals(n)||n.greaterEquals(new o.bn(s)))return!1;var a=n.inverseMod(s),c=e.mul(a).mod(s),u=r.mul(a).mod(s),h=t.G.mult2(c,u,i);return r.equals(h.x.mod(s))}var o={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof t&&t.exports&&(t.exports=o),o.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,r,n,i,s,a=this._tables[0][4],c=this._tables[1],u=t.length,h=1;if(4!==u&&6!==u&&8!==u)throw new o.exception.invalid("invalid aes key size");for(this._key=[i=t.slice(0),s=[]],e=u;4*u+28>e;e++)n=i[e-1],(e%u===0||8===u&&e%u===4)&&(n=a[n>>>24]<<24^a[n>>16&255]<<16^a[n>>8&255]<<8^a[255&n],e%u===0&&(n=n<<8^n>>>24^h<<24,h=h<<1^283*(h>>7))),i[e]=i[e-u]^n;for(r=0;e;r++,e--)n=i[3&r?e:e-4],s[r]=4>=e||4>r?n:c[0][a[n>>>24]]^c[1][a[n>>16&255]]^c[2][a[n>>8&255]]^c[3][a[255&n]]},o.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,r,n,i,s,o,a,c,u=this._tables[0],h=this._tables[1],f=u[4],l=h[4],p=[],_=[];for(t=0;256>t;t++)_[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!f[e];e^=n||1,r=_[r]||1)for(o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^255&o^99,f[e]=o,l[o]=e,s=p[i=p[n=p[e]]],c=16843009*s^65537*i^257*n^16843008*e,a=257*p[o]^16843008*o,t=0;4>t;t++)u[t][e]=a=a<<24^a>>>8,h[t][o]=c=c<<24^c>>>8;for(t=0;5>t;t++)u[t]=u[t].slice(0),h[t]=h[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new o.exception.invalid("invalid aes block size");var r,n,i,s,a=this._key[e],c=t[0]^a[0],u=t[e?3:1]^a[1],h=t[2]^a[2],f=t[e?1:3]^a[3],l=a.length/4-2,p=4,_=[0,0,0,0],d=this._tables[e],y=d[0],m=d[1],v=d[2],g=d[3],b=d[4];for(s=0;l>s;s++)r=y[c>>>24]^m[u>>16&255]^v[h>>8&255]^g[255&f]^a[p],n=y[u>>>24]^m[h>>16&255]^v[f>>8&255]^g[255&c]^a[p+1],i=y[h>>>24]^m[f>>16&255]^v[c>>8&255]^g[255&u]^a[p+2],f=y[f>>>24]^m[c>>16&255]^v[u>>8&255]^g[255&h]^a[p+3],p+=4,c=r,u=n,h=i;for(s=0;4>s;s++)_[e?3&-s:s]=b[c>>>24]<<24^b[u>>16&255]<<16^b[h>>8&255]<<8^b[255&f]^a[p++],r=c,c=u,u=h,h=f,f=r;return _}},o.bitArray={bitSlice:function(t,e,r){return t=o.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===r?t:o.bitArray.clamp(t,r-e)},extract:function(t,e,r){var n,i=Math.floor(-e-r&31);return n=-32&(e+r-1^e)?t[e/32|0]<<32-i^t[e/32+1|0]>>>i:t[e/32|0]>>>i,n&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],n=o.bitArray.getPartial(r);return 32===n?t.concat(e):o.bitArray._shiftRight(e,n,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e,r=t.length;return 0===r?0:(e=t[r-1],32*(r-1)+o.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var r=t.length;return e=31&e,r>0&&e&&(t[r-1]=o.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(o.bitArray.bitLength(t)!==o.bitArray.bitLength(e))return!1;var r,n=0;for(r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n},_shiftRight:function(t,e,r,n){var i,s,a=0;for(void 0===n&&(n=[]);e>=32;e-=32)n.push(r),r=0;if(0===e)return n.concat(t);for(i=0;i<t.length;i++)n.push(r|t[i]>>>e),r=t[i]<<32-e;return a=t.length?t[t.length-1]:0,s=o.bitArray.getPartial(a),n.push(o.bitArray.partial(e+s&31,e+s>32?r:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},o.codec.utf8String={fromBits:function(t){var e,r,n="",i=o.bitArray.bitLength(t);for(e=0;i/8>e;e++)0===(3&e)&&(r=t[e/4]),n+=String.fromCharCode(r>>>24),r<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,r=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3===(3&e)&&(r.push(n),n=0);return 3&e&&r.push(o.bitArray.partial(8*(3&e),n)),r}},o.codec.hex={fromBits:function(t){var e,r="";for(e=0;e<t.length;e++)r+=((0|t[e])+0xf00000000000).toString(16).substr(4);return r.substr(0,o.bitArray.bitLength(t)/4)},toBits:function(t){var e,r,n=[];for(t=t.replace(/\s|0x/g,""),r=t.length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return o.bitArray.clamp(n,4*r)}},o.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,r){var n,i="",s=0,a=o.codec.base64._chars,c=0,u=o.bitArray.bitLength(t);for(r&&(a=a.substr(0,62)+"-_"),n=0;6*i.length<u;)i+=a.charAt((c^t[n]>>>s)>>>26),6>s?(c=t[n]<<6-s,s+=26,n++):(c<<=6,s-=6);for(;3&i.length&&!e;)i+="=";return i},toBits:function(t,e){t=t.replace(/\s|=/g,"");var r,n,i=[],s=0,a=o.codec.base64._chars,c=0;for(e&&(a=a.substr(0,62)+"-_"),r=0;r<t.length;r++){if(n=a.indexOf(t.charAt(r)),0>n)throw new o.exception.invalid("this isn't base64!");s>26?(s-=26,i.push(c^n>>>s),c=n<<32-s):(s+=6,c^=n<<32-s)}return 56&s&&i.push(o.bitArray.partial(56&s,c,1)),i}},o.codec.base64url={fromBits:function(t){return o.codec.base64.fromBits(t,1,1)},toBits:function(t){return o.codec.base64.toBits(t,1)}},o.codec.bytes={fromBits:function(t){var e,r,n=[],i=o.bitArray.bitLength(t);for(e=0;i/8>e;e++)0===(3&e)&&(r=t[e/4]),n.push(r>>>24),r<<=8;return n},toBits:function(t){var e,r=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t[e],3===(3&e)&&(r.push(n),n=0);return 3&e&&r.push(o.bitArray.partial(8*(3&e),n)),r}},o.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha256.hash=function(t){return(new o.hash.sha256).update(t).finalize()},o.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);for(e=512+n&-512;i>=e;e+=512)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,r=0,n=2;t:for(;64>r;n++){for(e=2;n>=e*e;e++)if(n%e===0)continue t;8>r&&(this._init[r]=t(Math.pow(n,.5))),this._key[r]=t(Math.pow(n,1/3)),r++}},_block:function(t){var e,r,n,i,s=t.slice(0),o=this._h,a=this._key,c=o[0],u=o[1],h=o[2],f=o[3],l=o[4],p=o[5],_=o[6],d=o[7];for(e=0;64>e;e++)16>e?r=s[e]:(n=s[e+1&15],i=s[e+14&15],r=s[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[15&e]+s[e+9&15]|0),r=r+d+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(_^l&(p^_))+a[e],d=_,_=p,p=l,l=f+r|0,f=h,h=u,u=c,c=r+(u&h^f&(u^h))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;o[0]=o[0]+c|0,o[1]=o[1]+u|0,o[2]=o[2]+h|0,o[3]=o[3]+f|0,o[4]=o[4]+l|0,o[5]=o[5]+p|0,o[6]=o[6]+_|0,o[7]=o[7]+d|0}},o.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha512.hash=function(t){return(new o.hash.sha512).update(t).finalize()},o.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);for(e=1024+n&-1024;i>=e;e+=1024)this._block(r.splice(0,32));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)]),t=e.length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32));return this.reset(),r},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}function e(t){return 1099511627776*(t-Math.floor(t))&255}var r,n=0,i=2;t:for(;80>n;i++){for(r=2;i>=r*r;r++)if(i%r===0)continue t;8>n&&(this._init[2*n]=t(Math.pow(i,.5)),this._init[2*n+1]=e(Math.pow(i,.5))<<24|this._initr[n]),this._key[2*n]=t(Math.pow(i,1/3)),this._key[2*n+1]=e(Math.pow(i,1/3))<<24|this._keyr[n],n++}},_block:function(t){var e,r,n,i=t.slice(0),s=this._h,o=this._key,a=s[0],c=s[1],u=s[2],h=s[3],f=s[4],l=s[5],p=s[6],_=s[7],d=s[8],y=s[9],m=s[10],v=s[11],g=s[12],b=s[13],w=s[14],E=s[15],x=a,S=c,A=u,T=h,k=f,j=l,B=p,R=_,I=d,q=y,C=m,D=v,O=g,L=b,M=w,N=E;for(e=0;80>e;e++){if(16>e)r=i[2*e],n=i[2*e+1];else{var F=i[2*(e-15)],P=i[2*(e-15)+1],z=(P<<31|F>>>1)^(P<<24|F>>>8)^F>>>7,U=(F<<31|P>>>1)^(F<<24|P>>>8)^(F<<25|P>>>7),H=i[2*(e-2)],V=i[2*(e-2)+1],G=(V<<13|H>>>19)^(H<<3|V>>>29)^H>>>6,K=(H<<13|V>>>19)^(V<<3|H>>>29)^(H<<26|V>>>6),X=i[2*(e-7)],Z=i[2*(e-7)+1],J=i[2*(e-16)],$=i[2*(e-16)+1];n=U+Z,r=z+X+(U>>>0>n>>>0?1:0),n+=K,r+=G+(K>>>0>n>>>0?1:0),n+=$,r+=J+($>>>0>n>>>0?1:0)}i[2*e]=r|=0,i[2*e+1]=n|=0;var Q=I&C^~I&O,W=q&D^~q&L,Y=x&A^x&k^A&k,te=S&T^S&j^T&j,ee=(S<<4|x>>>28)^(x<<30|S>>>2)^(x<<25|S>>>7),re=(x<<4|S>>>28)^(S<<30|x>>>2)^(S<<25|x>>>7),ne=(q<<18|I>>>14)^(q<<14|I>>>18)^(I<<23|q>>>9),ie=(I<<18|q>>>14)^(I<<14|q>>>18)^(q<<23|I>>>9),se=o[2*e],oe=o[2*e+1],ae=N+ie,ce=M+ne+(N>>>0>ae>>>0?1:0);ae+=W,ce+=Q+(W>>>0>ae>>>0?1:0),ae+=oe,ce+=se+(oe>>>0>ae>>>0?1:0),ae+=n,ce+=r+(n>>>0>ae>>>0?1:0);var ue=re+te,he=ee+Y+(re>>>0>ue>>>0?1:0);M=O,N=L,O=C,L=D,C=I,D=q,q=R+ae|0,I=B+ce+(R>>>0>q>>>0?1:0)|0,B=k,R=j,k=A,j=T,A=x,T=S,S=ae+ue|0,x=ce+he+(ae>>>0>S>>>0?1:0)|0}c=s[1]=c+S|0,s[0]=a+x+(S>>>0>c>>>0?1:0)|0,h=s[3]=h+T|0,s[2]=u+A+(T>>>0>h>>>0?1:0)|0,l=s[5]=l+j|0,s[4]=f+k+(j>>>0>l>>>0?1:0)|0,_=s[7]=_+R|0,s[6]=p+B+(R>>>0>_>>>0?1:0)|0,y=s[9]=y+q|0,s[8]=d+I+(q>>>0>y>>>0?1:0)|0,v=s[11]=v+D|0,s[10]=m+C+(D>>>0>v>>>0?1:0)|0,b=s[13]=b+L|0,s[12]=g+O+(L>>>0>b>>>0?1:0)|0,E=s[15]=E+N|0,s[14]=w+M+(N>>>0>E>>>0?1:0)|0}},o.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha1.hash=function(t){return(new o.hash.sha1).update(t).finalize()},o.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);for(e=this.blockSize+n&-this.blockSize;i>=e;e+=this.blockSize)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,r,n){return 19>=t?e&r|~e&n:39>=t?e^r^n:59>=t?e&r|e&n|r&n:79>=t?e^r^n:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){{var e,r,n,i,s,o,a,c=t.slice(0),u=this._h;this._key}for(n=u[0],i=u[1],s=u[2],o=u[3],a=u[4],e=0;79>=e;e++)e>=16&&(c[e]=this._S(1,c[e-3]^c[e-8]^c[e-14]^c[e-16])),r=this._S(5,n)+this._f(e,i,s,o)+a+c[e]+this._key[Math.floor(e/20)]|0,a=o,o=s,s=this._S(30,i),i=n,n=r;u[0]=u[0]+n|0,u[1]=u[1]+i|0,u[2]=u[2]+s|0,u[3]=u[3]+o|0,u[4]=u[4]+a|0}},o.mode.ccm={name:"ccm",encrypt:function(t,e,r,n,i){var s,a,c=e.slice(0),u=o.bitArray,h=u.bitLength(r)/8,f=u.bitLength(c)/8;if(i=i||64,n=n||[],7>h)throw new o.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&f>>>8*s;s++);return 15-h>s&&(s=15-h),r=u.clamp(r,8*(15-s)),a=o.mode.ccm._computeTag(t,e,r,n,i,s),c=o.mode.ccm._ctrMode(t,c,r,a,i,s),u.concat(c.data,c.tag)},decrypt:function(t,e,r,n,i){i=i||64,n=n||[];var s,a,c=o.bitArray,u=c.bitLength(r)/8,h=c.bitLength(e),f=c.clamp(e,h-i),l=c.bitSlice(e,h-i);if(h=(h-i)/8,7>u)throw new o.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&h>>>8*s;s++);if(15-u>s&&(s=15-u),r=c.clamp(r,8*(15-s)),f=o.mode.ccm._ctrMode(t,f,r,l,i,s),a=o.mode.ccm._computeTag(t,f.data,r,n,i,s),!c.equal(f.tag,a))throw new o.exception.corrupt("ccm: tag doesn't match");return f.data},_computeTag:function(t,e,r,n,i,s){var a,c,u,h=[],f=o.bitArray,l=f._xor4;if(i/=8,i%2||4>i||i>16)throw new o.exception.invalid("ccm: invalid tag length");if(n.length>4294967295||e.length>4294967295)throw new o.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[f.partial(8,(n.length?64:0)|i-2<<2|s-1)],a=f.concat(a,r),a[3]|=f.bitLength(e)/8,a=t.encrypt(a),n.length)for(c=f.bitLength(n)/8,65279>=c?h=[f.partial(16,c)]:4294967295>=c&&(h=f.concat([f.partial(16,65534)],[c])),h=f.concat(h,n),u=0;u<h.length;u+=4)a=t.encrypt(l(a,h.slice(u,u+4).concat([0,0,0])));for(u=0;u<e.length;u+=4)a=t.encrypt(l(a,e.slice(u,u+4).concat([0,0,0])));return f.clamp(a,8*i)},_ctrMode:function(t,e,r,n,i,s){var a,c,u,h=o.bitArray,f=h._xor4,l=e.length,p=h.bitLength(e);if(u=h.concat([h.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),n=h.bitSlice(f(n,t.encrypt(u)),0,i),!l)return{tag:n,data:[]};for(c=0;l>c;c+=4)u[3]++,a=t.encrypt(u),e[c]^=a[0],e[c+1]^=a[1],e[c+2]^=a[2],e[c+3]^=a[3];return{tag:n,data:h.clamp(e,p)}}},o.misc.hmac=function(t,e){this._hash=e=e||o.hash.sha256;var r,n=[[],[]],i=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>i&&(t=e.hash(t)),r=0;i>r;r++)n[0][r]=909522486^t[r],n[1][r]=1549556828^t[r];this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1])},o.misc.hmac.prototype.encrypt=o.misc.hmac.prototype.mac=function(t){var e=new this._hash(this._baseHash[0]).update(t).finalize();return new this._hash(this._baseHash[1]).update(e).finalize()},o.misc.pbkdf2=function(t,e,r,n,i){if(r=r||1e3,0>n||0>r)throw o.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=o.codec.utf8String.toBits(t)),i=i||o.misc.hmac;var s,a,c,u,h,f=new i(t),l=[],p=o.bitArray;for(h=1;32*l.length<(n||1);h++){for(s=a=f.encrypt(p.concat(e,[h])),c=1;r>c;c++)for(a=f.encrypt(a),u=0;u<a.length;u++)s[u]^=a[u];l=l.concat(s)}return n&&(l=p.clamp(l,n)),l},o.prng=function(t){this._pools=[new o.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},o.prng.prototype={randomWords:function(t,e){var r,n,i=[],s=this.isReady(e);if(s===this._NOT_READY)throw new o.exception.notReady("generator isn't seeded");for(s&this._REQUIRES_RESEED&&this._reseedFromPools(!(s&this._READY)),r=0;t>r;r+=4)(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),n=this._gen4words(),i.push(n[0],n[1],n[2],n[3]);return this._gate(),i.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,r){r=r||"user";var n,i,s,a=(new Date).valueOf(),c=this._robins[r],u=this.isReady(),h=0;switch(n=this._collectorIds[r],void 0===n&&(n=this._collectorIds[r]=this._collectorIdNext++),void 0===c&&(c=this._robins[r]=0),this._robins[r]=(this._robins[r]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[c].update([n,this._eventId++,1,e,a,1,0|t]);break;case"object":var f=Object.prototype.toString.call(t);if("[object Uint32Array]"===f){for(s=[],i=0;i<t.length;i++)s.push(t[i]);t=s}else for("[object Array]"!==f&&(h=1),i=0;i<t.length&&!h;i++)"number"!=typeof t[i]&&(h=1);if(!h){if(void 0===e)for(e=0,i=0;i<t.length;i++)for(s=t[i];s>0;)e++,s>>>=1;this._pools[c].update([n,this._eventId++,2,e,a,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[c].update([n,this._eventId++,3,e,a,t.length]),this._pools[c].update(t);break;default:h=1}if(h)throw new o.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[c]+=e,this._poolStrength+=e,u===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new o.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var r,n,i=this._callbacks[t],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===e&&s.push(n);for(r=0;r<s.length;r++)n=s[r],delete i[n]},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new o.cipher.aes(this._key)},_reseed:function(t){this._key=o.hash.sha256.hash(this._key.concat(t)),this._cipher=new o.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,r=[],n=0;for(this._nextReseed=r[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)r.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(r=r.concat(this._pools[e].finalize()),n+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new o.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(r)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,r=t.y||t.clientY||t.offsetY||0;o.random.addEntropy([e,r],2,"mouse")},_loadTimeCollector:function(){o.random.addEntropy((new Date).valueOf(),2,"loadtime")
},_fireEvent:function(t,e){var r,n=o.random._callbacks[t],i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r]);for(r=0;r<i.length;r++)i[r](e)}},o.random=new o.prng(6),function(){try{var t=new Uint32Array(32);crypto.getRandomValues(t),o.random.addEntropy(t,1024,"crypto.getRandomValues")}catch(e){}}(),o.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(t,e,r,n){r=r||{},n=n||{};var i,s,a,c=o.json,u=c._add({iv:o.random.randomWords(4,0)},c.defaults);if(c._add(u,r),a=u.adata,"string"==typeof u.salt&&(u.salt=o.codec.base64.toBits(u.salt)),"string"==typeof u.iv&&(u.iv=o.codec.base64.toBits(u.iv)),!o.mode[u.mode]||!o.cipher[u.cipher]||"string"==typeof t&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||u.iv.length<2||u.iv.length>4)throw new o.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(i=o.misc.cachedPbkdf2(t,u),t=i.key.slice(0,u.ks/32),u.salt=i.salt):o.ecc&&t instanceof o.ecc.elGamal.publicKey&&(i=t.kem(),u.kemtag=i.tag,t=i.key.slice(0,u.ks/32)),"string"==typeof e&&(e=o.codec.utf8String.toBits(e)),"string"==typeof a&&(a=o.codec.utf8String.toBits(a)),s=new o.cipher[u.cipher](t),c._add(n,u),n.key=t,u.ct=o.mode[u.mode].encrypt(s,e,u.iv,a,u.ts),c.encode(u)},decrypt:function(t,e,r,n){r=r||{},n=n||{};var i,s,a,c=o.json,u=c._add(c._add(c._add({},c.defaults),c.decode(e)),r,!0),h=u.adata;if("string"==typeof u.salt&&(u.salt=o.codec.base64.toBits(u.salt)),"string"==typeof u.iv&&(u.iv=o.codec.base64.toBits(u.iv)),!o.mode[u.mode]||!o.cipher[u.cipher]||"string"==typeof t&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||!u.iv||u.iv.length<2||u.iv.length>4)throw new o.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(s=o.misc.cachedPbkdf2(t,u),t=s.key.slice(0,u.ks/32),u.salt=s.salt):o.ecc&&t instanceof o.ecc.elGamal.secretKey&&(t=t.unkem(o.codec.base64.toBits(u.kemtag)).slice(0,u.ks/32)),"string"==typeof h&&(h=o.codec.utf8String.toBits(h)),a=new o.cipher[u.cipher](t),i=o.mode[u.mode].decrypt(a,u.ct,u.iv,h,u.ts),c._add(n,u),n.key=t,o.codec.utf8String.fromBits(i)},encode:function(t){var e,r="{",n="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new o.exception.invalid("json encode: invalid property name");switch(r+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":r+=t[e];break;case"string":r+='"'+escape(t[e])+'"';break;case"object":r+='"'+o.codec.base64.fromBits(t[e],0)+'"';break;default:throw new o.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new o.exception.invalid("json decode: this isn't json!");var e,r,n=t.replace(/^\{|\}$/g,"").split(/,/),i={};for(e=0;e<n.length;e++){if(!(r=n[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new o.exception.invalid("json decode: this isn't json!");i[r[2]]=r[3]?parseInt(r[3],10):r[2].match(/^(ct|salt|iv)$/)?o.codec.base64.toBits(r[4]):unescape(r[4])}return i},_add:function(t,e,r){if(void 0===t&&(t={}),void 0===e)return t;var n;for(n in e)if(e.hasOwnProperty(n)){if(r&&void 0!==t[n]&&t[n]!==e[n])throw new o.exception.invalid("required parameter overridden");t[n]=e[n]}return t},_subtract:function(t,e){var r,n={};for(r in t)t.hasOwnProperty(r)&&t[r]!==e[r]&&(n[r]=t[r]);return n},_filter:function(t,e){var r,n={};for(r=0;r<e.length;r++)void 0!==t[e[r]]&&(n[e[r]]=t[e[r]]);return n}},o.encrypt=o.json.encrypt,o.decrypt=o.json.decrypt,o.misc._pbkdf2Cache={},o.misc.cachedPbkdf2=function(t,e){var r,n,i,s,a=o.misc._pbkdf2Cache;return e=e||{},s=e.iter||1e3,n=a[t]=a[t]||{},r=n[s]=n[s]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):o.random.randomWords(2,0)},i=void 0===e.salt?r.firstSalt:e.salt,r[i]=r[i]||o.misc.pbkdf2(t,i,e.iter),{key:r[i].slice(0),salt:i.slice(0)}},o.bn=function(t){this.initWith(t)},o.bn.prototype={radix:24,maxMul:8,_class:o.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,r=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,r=0;r<t.length;r+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-r-e,0),t.length-r),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)r|=this.getLimb(e)^t.getLimb(e);return 0===r},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,n,i=0,s=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)r=this.getLimb(e),n=t.getLimb(e),s|=n-r&~i,i|=r-n&~s;return(s|~i)>>>31},toString:function(){this.fullReduce();var t,e,r="",n=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=n[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;r=e+r}return"0x"+r},addM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,n=t.limbs;for(e=r.length;e<n.length;e++)r[e]=0;for(e=0;e<n.length;e++)r[e]+=n[e];return this},doubleM:function(){var t,e,r=0,n=this.radix,i=this.radixMask,s=this.limbs;for(t=0;t<s.length;t++)e=s[t],e=e+e+r,s[t]=e&i,r=e>>n;return r&&s.push(r),this},halveM:function(){var t,e,r=0,n=this.radix,i=this.limbs;for(t=i.length-1;t>=0;t--)e=i[t],i[t]=e+r>>1,r=(1&e)<<n;return i[i.length-1]||i.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,n=t.limbs;for(e=r.length;e<n.length;e++)r[e]=0;for(e=0;e<n.length;e++)r[e]-=n[e];return this},mod:function(t){var e=!this.greaterEquals(new o.bn(0));t=new o.bn(t).normalize();var r=new o.bn(this).normalize(),n=0;for(e&&(r=new o.bn(0).subM(r).normalize());r.greaterEquals(t);n++)t.doubleM();for(e&&(r=t.sub(r).normalize());n>0;n--)t.halveM(),r.greaterEquals(t)&&r.subM(t).normalize();return r.trim()},inverseMod:function(t){var e,r,n=new o.bn(1),i=new o.bn(0),s=new o.bn(this),a=new o.bn(t),c=1;if(!(1&t.limbs[0]))throw new o.exception.invalid("inverseMod: p must be odd");do for(1&s.limbs[0]&&(s.greaterEquals(a)||(e=s,s=a,a=e,e=n,n=i,i=e),s.subM(a),s.normalize(),n.greaterEquals(i)||n.addM(t),n.subM(i)),s.halveM(),1&n.limbs[0]&&n.addM(t),n.normalize(),n.halveM(),r=c=0;r<s.limbs.length;r++)c|=s.limbs[r];while(c);if(!a.equals(1))throw new o.exception.invalid("inverseMod: p and x must be relatively prime");return i},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,n,i=this.limbs,s=t.limbs,o=i.length,a=s.length,c=new this._class,u=c.limbs,h=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)u[e]=0;for(e=0;o>e;e++){for(n=i[e],r=0;a>r;r++)u[e+r]+=n*s[r];--h||(h=this.maxMul,c.cnormalize())}return c.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var e,r,n=new this._class(1),i=this;for(e=0;e<t.length;e++)for(r=0;r<this.radix;r++)t[e]&1<<r&&(n=n.mul(i)),i=i.square();return n},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var r=new o.bn(1),n=new o.bn(this),i=new o.bn(t);;){if(1&i.limbs[0]&&(r=r.mulmod(n,e)),i.halveM(),i.equals(0))break;n=n.mulmod(n,e)}return r.normalize().reduce()},trim:function(){var t,e=this.limbs;do t=e.pop();while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,r,n=0,i=(this.placeVal,this.ipv),s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o>t||0!==n&&-1!==n;t++)e=(s[t]||0)+n,r=s[t]=e&a,n=(e-r)*i;return-1===n&&(s[t-1]-=this.placeVal),this},cnormalize:function(){var t,e,r,n=0,i=this.ipv,s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o-1>t;t++)e=s[t]+n,r=s[t]=e&a,n=(e-r)*i;return s[t]+=n,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),r=o.bitArray,n=(t+7&-8)%this.radix||this.radix,i=[r.partial(n,this.getLimb(e))];for(e--;e>=0;e--)i=r.concat(i,[r.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return i},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},o.bn.fromBits=function(t){var e=this,r=new e,n=[],i=o.bitArray,s=this.prototype,a=Math.min(this.bitLength||4294967296,i.bitLength(t)),c=a%s.radix||s.radix;for(n[0]=i.extract(t,0,c);a>c;c+=s.radix)n.unshift(i.extract(t,c,s.radix));return r.limbs=n,r},o.bn.prototype.ipv=1/(o.bn.prototype.placeVal=Math.pow(2,o.bn.prototype.radix)),o.bn.prototype.radixMask=(1<<o.bn.prototype.radix)-1,o.bn.pseudoMersennePrime=function(t,e){function r(t){this.initWith(t)}var n,i,s,a=r.prototype=new o.bn;for(s=a.modOffset=Math.ceil(i=t/a.radix),a.exponent=t,a.offset=[],a.factor=[],a.minOffset=s,a.fullMask=0,a.fullOffset=[],a.fullFactor=[],a.modulus=r.modulus=new o.bn(Math.pow(2,t)),a.fullMask=0|-Math.pow(2,t%a.radix),n=0;n<e.length;n++)a.offset[n]=Math.floor(e[n][0]/a.radix-i),a.fullOffset[n]=Math.ceil(e[n][0]/a.radix-i),a.factor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+a.offset[n]*a.radix),a.fullFactor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+a.fullOffset[n]*a.radix),a.modulus.addM(new o.bn(Math.pow(2,e[n][0])*e[n][1])),a.minOffset=Math.min(a.minOffset,-a.offset[n]);return a._class=r,a.modulus.cnormalize(),a.reduce=function(){var t,e,r,n,i=this.modOffset,s=this.limbs,o=this.offset,a=this.offset.length,c=this.factor;for(t=this.minOffset;s.length>i;){for(r=s.pop(),n=s.length,e=0;a>e;e++)s[n+o[e]]-=c[e]*r;t--,t||(s.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},a._strongReduce=-1===a.fullMask?a.reduce:function(){var t,e,r=this.limbs,n=r.length-1;if(this.reduce(),n===this.modOffset-1){for(e=r[n]&this.fullMask,r[n]-=e,t=0;t<this.fullOffset.length;t++)r[n+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},a.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},a.inverse=function(){return this.power(this.modulus.sub(2))},r.fromBits=o.bn.fromBits,r},o.bn.prime={p127:o.bn.pseudoMersennePrime(127,[[0,-1]]),p25519:o.bn.pseudoMersennePrime(255,[[0,-19]]),p192:o.bn.pseudoMersennePrime(192,[[0,-1],[64,-1]]),p224:o.bn.pseudoMersennePrime(224,[[0,1],[96,-1]]),p256:o.bn.pseudoMersennePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:o.bn.pseudoMersennePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:o.bn.pseudoMersennePrime(521,[[0,-1]])},o.bn.random=function(t,e){"object"!=typeof t&&(t=new o.bn(t));for(var r,n,i=t.limbs.length,s=t.limbs[i-1]+1,a=new o.bn;;){do r=o.random.randomWords(i,e),r[i-1]<0&&(r[i-1]+=4294967296);while(Math.floor(r[i-1]/s)===Math.floor(4294967296/s));for(r[i-1]%=s,n=0;i-1>n;n++)r[n]&=t.radixMask;if(a.limbs=r,!a.greaterEquals(t))return a}},o.ecc={},o.ecc.point=function(t,e,r){void 0===e?this.isIdentity=!0:(e instanceof o.bn&&(e=new t.field(e)),r instanceof o.bn&&(r=new t.field(r)),this.x=e,this.y=r,this.isIdentity=!1),this.curve=t},o.ecc.point.prototype={toJac:function(){return new o.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,r){return this.toJac().mult2(t,this,e,r).toAffine()},multiples:function(){var t,e,r;if(void 0===this._multiples)for(r=this.toJac().doubl(),t=this._multiples=[new o.ecc.point(this.curve),this,r.toAffine()],e=3;16>e;e++)r=r.add(this),t.push(r.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return o.bitArray.concat(this.x.toBits(),this.y.toBits())}},o.ecc.pointJac=function(t,e,r,n){void 0===e?this.isIdentity=!0:(this.x=e,this.y=r,this.z=n,this.isIdentity=!1),this.curve=t},o.ecc.pointJac.prototype={add:function(t){var e,r,n,i,s,a,c,u,h,f,l,p=this;if(p.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return p.isIdentity?t.toJac():t.isIdentity?p:(e=p.z.square(),r=t.x.mul(e).subM(p.x),r.equals(0)?p.y.equals(t.y.mul(e.mul(p.z)))?p.doubl():new o.ecc.pointJac(p.curve):(n=t.y.mul(e.mul(p.z)).subM(p.y),i=r.square(),s=n.square(),a=r.square().mul(r).addM(p.x.add(p.x).mul(i)),c=s.subM(a),u=p.x.mul(i).subM(c).mul(n),h=p.y.mul(r.square().mul(r)),f=u.subM(h),l=p.z.mul(r),new o.ecc.pointJac(this.curve,c,f,l)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),r=t.square().mul(8),n=this.z.square(),i=this.x.sub(n).mul(3).mul(this.x.add(n)),s=i.square().subM(e).subM(e),a=e.sub(s).mul(i).subM(r),c=this.y.add(this.y).mul(this.z);return new o.ecc.pointJac(this.curve,s,a,c)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new o.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new o.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var r,n,i=new o.ecc.point(this.curve).toJac(),s=e.multiples();for(r=t.length-1;r>=0;r--)for(n=o.bn.prototype.radix-4;n>=0;n-=4)i=i.doubl().doubl().doubl().doubl().add(s[t[r]>>n&15]);return i},mult2:function(t,e,r,n){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"==typeof r?r=[r]:void 0!==r.limbs&&(r=r.normalize().limbs);var i,s,a,c,u=new o.ecc.point(this.curve).toJac(),h=e.multiples(),f=n.multiples();for(i=Math.max(t.length,r.length)-1;i>=0;i--)for(a=0|t[i],c=0|r[i],s=o.bn.prototype.radix-4;s>=0;s-=4)u=u.doubl().doubl().doubl().doubl().add(h[a>>s&15]).add(f[c>>s&15]);return u},isValid:function(){var t=this.z.square(),e=t.square(),r=e.mul(t);return this.y.square().equals(this.curve.b.mul(r).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},o.ecc.curve=function(t,e,r,n,i,s){this.field=t,this.r=t.prototype.modulus.sub(e),this.a=new t(r),this.b=new t(n),this.G=new o.ecc.point(this,new t(i),new t(s))},o.ecc.curve.prototype.fromBits=function(t){var e=o.bitArray,r=this.field.prototype.exponent+7&-8,n=new o.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,r)),this.field.fromBits(e.bitSlice(t,r,2*r)));if(!n.isValid())throw new o.exception.corrupt("not on the curve!");return n},o.ecc.curves={c192:new o.ecc.curve(o.bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new o.ecc.curve(o.bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new o.ecc.curve(o.bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new o.ecc.curve(o.bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},o.ecc._dh=function(t){o.ecc[t]={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._point=e instanceof Array?t.fromBits(e):e,this.get=function(){var t=this._point.toBits(),e=o.bitArray.bitLength(t),r=o.bitArray.bitSlice(t,0,e/2),n=o.bitArray.bitSlice(t,e/2);return{x:r,y:n}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}},generateKeys:function(e,r,n){if(void 0===e&&(e=256),"number"==typeof e&&(e=o.ecc.curves["c"+e],void 0===e))throw new o.exception.invalid("no such curve");if(void 0===n)var n=o.bn.random(e.r,r);var i=e.G.mult(n);return{pub:new o.ecc[t].publicKey(e,i),sec:new o.ecc[t].secretKey(e,n)}}}},o.ecc._dh("elGamal"),o.ecc.elGamal.publicKey.prototype={kem:function(t){var e=o.bn.random(this._curve.r,t),r=this._curve.G.mult(e).toBits(),n=o.hash.sha256.hash(this._point.mult(e).toBits());return{key:n,tag:r}}},o.ecc.elGamal.secretKey.prototype={unkem:function(t){return o.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return o.hash.sha256.hash(t._point.mult(this._exponent).toBits())}},o.ecc._dh("ecdsa"),o.ecc.ecdsa.secretKey.prototype={sign:function(t,e,r,n){o.bitArray.bitLength(t)>this._curveBitLength&&(t=o.bitArray.clamp(t,this._curveBitLength));var i=this._curve.r,s=i.bitLength(),a=n||o.bn.random(i.sub(1),e).add(1),c=this._curve.G.mult(a).x.mod(i),u=o.bn.fromBits(t).add(c.mul(this._exponent)),h=r?u.inverseMod(i).mul(a).mod(i):u.mul(a.inverseMod(i)).mod(i);return o.bitArray.concat(c.toBits(s),h.toBits(s))}},o.ecc.ecdsa.publicKey.prototype={verify:function(t,e,r){o.bitArray.bitLength(t)>this._curveBitLength&&(t=o.bitArray.clamp(t,this._curveBitLength));var n=o.bitArray,i=this._curve.r,s=this._curveBitLength,a=o.bn.fromBits(n.bitSlice(e,0,s)),c=o.bn.fromBits(n.bitSlice(e,s,2*s)),u=r?c:c.inverseMod(i),h=o.bn.fromBits(t).mul(u).mod(i),f=a.mul(u).mod(i),l=this._curve.G.mult2(h,f,this._point).x;if(a.equals(0)||c.equals(0)||a.greaterEquals(i)||c.greaterEquals(i)||!l.equals(a)){if(void 0===r)return this.verify(t,e,!0);throw new o.exception.corrupt("signature didn't check out")}return!0}},o.keyexchange.srp={makeVerifier:function(t,e,r,n){var i;return i=o.keyexchange.srp.makeX(t,e,r),i=o.bn.fromBits(i),n.g.powermod(i,n.N)},makeX:function(t,e,r){var n=o.hash.sha1.hash(t+":"+e);return o.hash.sha1.hash(o.bitArray.concat(r,n))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),o.keyexchange.srp._didInitKnownGroups||o.keyexchange.srp._initKnownGroups(),o.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){var t,e,r;for(t=0;t<o.keyexchange.srp._knownGroupSizes.length;t++)e=o.keyexchange.srp._knownGroupSizes[t].toString(),r=o.keyexchange.srp._knownGroups[e],r.N=new o.bn(r.N),r.g=new o.bn(r.g);o.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},o.ecc.point.prototype.isValidPoint=function(){var t=this,e=t.curve.field.modulus;return t.isIdentity?!1:new o.bn(1).greaterEquals(t.x)&&!t.x.equals(1)||t.x.greaterEquals(e.sub(1))&&!t.x.equals(1)?!1:new o.bn(1).greaterEquals(t.y)&&!t.y.equals(1)||t.y.greaterEquals(e.sub(1))&&!t.y.equals(1)?!1:t.isOnCurve()?!0:!1},o.ecc.point.prototype.isOnCurve=function(){var t=this,e=(t.curve.r,t.curve.a),r=t.curve.b,n=t.curve.field.modulus,i=t.y.mul(t.y).mod(n),s=t.x.mul(t.x).mul(t.x).add(e.mul(t.x)).add(r).mod(n);return i.equals(s)},o.ecc.point.prototype.toString=function(){return"("+this.x.toString()+", "+this.y.toString()+")"},o.ecc.pointJac.prototype.toString=function(){return"("+this.x.toString()+", "+this.y.toString()+", "+this.z.toString()+")"},o.ecc.curves.c256=new o.ecc.curve(o.bn.pseudoMersennePrime(256,[[0,-1],[4,-1],[6,-1],[7,-1],[8,-1],[9,-1],[32,-1]]),"0x14551231950b75fc4402da1722fc9baee",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),o.ecc.pointJac.prototype.add=function(t){var e=this;if(e.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";if(e.isIdentity)return t.toJac();if(t.isIdentity)return e;var r=e.z.square(),n=t.x.mul(r).subM(e.x),i=t.y.mul(e.z).mul(r);if(n.equals(0))return e.y.equals(t.y.mul(r.mul(e.z)))?e.doubl():new o.ecc.pointJac(e.curve);var s=n.square(),a=s.copy().doubleM().doubleM(),c=n.mul(a),u=i.sub(e.y).doubleM(),h=e.x.mul(a),f=u.square().subM(c).subM(h.copy().doubleM()),l=u.mul(h.sub(f)).subM(e.y.mul(c).doubleM()),p=e.z.add(n).square().subM(r).subM(s);return new o.ecc.pointJac(this.curve,f,l,p)},o.ecc.pointJac.prototype.doubl=function(){if(this.isIdentity)return this;var t=this.x.square(),e=this.y.square(),r=e.square(),n=this.x.add(e).square().subM(t).subM(r).doubleM(),i=t.mul(3),s=i.square(),a=s.sub(n.copy().doubleM()),c=i.mul(n.sub(a)).subM(r.doubleM().doubleM().doubleM()),u=this.z.mul(this.y).doubleM();return new o.ecc.pointJac(this.curve,a,c,u)},o.ecc.point.prototype.toBytesCompressed=function(){var t="0x0"==this.y.mod(2).toString()?2:3;return[t].concat(o.codec.bytes.fromBits(this.x.toBits()))},function(){function t(t,e,r){return t^e^r}function e(t,e,r){return t&e|~t&r}function r(t,e,r){return(t|~e)^r}function n(t,e,r){return t&r|e&~r}function i(t,e,r){return t^(e|~r)}function s(t,e){return t<<e|t>>>32-e}function a(t){return(255&t)<<24|(65280&t)<<8|(t&255<<16)>>>8|(t&255<<24)>>>24}function c(o){for(var a,c=this._h[0],u=this._h[1],l=this._h[2],p=this._h[3],v=this._h[4],g=this._h[0],b=this._h[1],w=this._h[2],E=this._h[3],x=this._h[4],S=0;16>S;++S)a=s(c+t(u,l,p)+o[_[S]]+h[S],y[S])+v,c=v,v=p,p=s(l,10),l=u,u=a,a=s(g+i(b,w,E)+o[d[S]]+f[S],m[S])+x,g=x,x=E,E=s(w,10),w=b,b=a;for(;32>S;++S)a=s(c+e(u,l,p)+o[_[S]]+h[S],y[S])+v,c=v,v=p,p=s(l,10),l=u,u=a,a=s(g+n(b,w,E)+o[d[S]]+f[S],m[S])+x,g=x,x=E,E=s(w,10),w=b,b=a;for(;48>S;++S)a=s(c+r(u,l,p)+o[_[S]]+h[S],y[S])+v,c=v,v=p,p=s(l,10),l=u,u=a,a=s(g+r(b,w,E)+o[d[S]]+f[S],m[S])+x,g=x,x=E,E=s(w,10),w=b,b=a;for(;64>S;++S)a=s(c+n(u,l,p)+o[_[S]]+h[S],y[S])+v,c=v,v=p,p=s(l,10),l=u,u=a,a=s(g+e(b,w,E)+o[d[S]]+f[S],m[S])+x,g=x,x=E,E=s(w,10),w=b,b=a;for(;80>S;++S)a=s(c+i(u,l,p)+o[_[S]]+h[S],y[S])+v,c=v,v=p,p=s(l,10),l=u,u=a,a=s(g+t(b,w,E)+o[d[S]]+f[S],m[S])+x,g=x,x=E,E=s(w,10),w=b,b=a;a=this._h[1]+l+E,this._h[1]=this._h[2]+p+x,this._h[2]=this._h[3]+v+g,this._h[3]=this._h[4]+c+b,this._h[4]=this._h[0]+u+w,this._h[0]=a}o.hash.ripemd160=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.ripemd160.hash=function(t){return(new o.hash.ripemd160).update(t).finalize()},o.hash.ripemd160.prototype={reset:function(){return this._h=u.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);for(e=512+n&-512;i>=e;e+=512){for(var s=r.splice(0,16),u=0;16>u;++u)s[u]=a(s[u]);c.call(this,s)}return this},finalize:function(){var t=o.bitArray.concat(this._buffer,[o.bitArray.partial(1,1)]),e=(this._length+1)%512,r=(e>448?512:448)-e%448,n=r%32;for(n>0&&(t=o.bitArray.concat(t,[o.bitArray.partial(n,0)]));r>=32;r-=32)t.push(0);for(t.push(a(0|this._length)),t.push(a(Math.floor(this._length/4294967296)));t.length;){for(var i=t.splice(0,16),s=0;16>s;++s)i[s]=a(i[s]);c.call(this,i)}var u=this._h;this.reset();for(var s=0;5>s;++s)u[s]=a(u[s]);return u}};for(var u=[1732584193,4023233417,2562383102,271733878,3285377520],h=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0],l=4;l>=0;--l)for(var p=1;16>p;++p)h.splice(l,0,h[l]),f.splice(l,0,f[l]);var _=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}(),o.bn.ZERO=new o.bn(0),o.bn.prototype.divRem=function(t){"object"!=typeof t&&(t=new this._class(t));var e=this.abs(),r=t.abs(),n=new this._class(0),i=0;if(!e.greaterEquals(r))return[new o.bn(0),this.copy()];if(e.equals(r))return[new o.bn(1),new o.bn(0)];for(;e.greaterEquals(r);i++)r.doubleM();for(;i>0;i--)n.doubleM(),r.halveM(),e.greaterEquals(r)&&(n.addM(1),e.subM(t).normalize());return[n,e]},o.bn.prototype.divRound=function(t){var e=this.divRem(t),r=e[0],n=e[1];return n.doubleM().greaterEquals(t)&&r.addM(1),r},o.bn.prototype.div=function(t){var e=this.divRem(t);return e[0]},o.bn.prototype.sign=function(){return this.greaterEquals(o.bn.ZERO)?1:-1},o.bn.prototype.neg=function(){return o.bn.ZERO.sub(this)},o.bn.prototype.abs=function(){return-1===this.sign()?this.neg():this},o.bn.prototype.shiftRight=function(t){if("number"!=typeof t)throw new Error("shiftRight expects a number");if(t=+t,0>t)return this.shiftLeft(t);for(var e=new o.bn(this);t>=this.radix;)e.limbs.shift(),t-=this.radix;for(;t--;)e.halveM();return e},o.bn.prototype.shiftLeft=function(t){if("number"!=typeof t)throw new Error("shiftLeft expects a number");if(t=+t,0>t)return this.shiftRight(t);for(var e=new o.bn(this);t>=this.radix;)e.limbs.unshift(0),t-=this.radix;for(;t--;)e.doubleM();return e},o.bn.prototype.toNumber=function(){return 0|this.limbs[0]},o.bn.prototype.testBit=function(t){var e=Math.floor(t/this.radix),r=t%this.radix;return e>=this.limbs.length?0:this.limbs[e]>>>r&1},o.bn.prototype.setBitM=function(t){for(var e=Math.floor(t/this.radix),r=t%this.radix;e>=this.limbs.length;)this.limbs.push(0);return this.limbs[e]|=1<<r,this.cnormalize(),this},o.bn.prototype.modInt=function(t){return this.toNumber()%t},o.bn.prototype.invDigit=function(){var t=1+this.radixMask;if(this.limbs.length<1)return 0;var e=this.limbs[0];if(0==(1&e))return 0;var r=3&e;return r=r*(2-(15&e)*r)&15,r=r*(2-(255&e)*r)&255,r=r*(2-((65535&e)*r&65535))&65535,r=r*(2-e*r%t)%t,r>0?t-r:-r},o.bn.prototype.am=function(t,e,r,n,i,s){for(var o=4095&e,a=e>>12;--s>=0;){var c=4095&this.limbs[t],u=this.limbs[t++]>>12,h=a*c+u*o;c=o*c+((4095&h)<<12)+r.limbs[n]+i,i=(c>>24)+(h>>12)+a*u,r.limbs[n++]=16777215&c}return i};var a=function(t){this.m=t,this.mt=t.limbs.length,this.mt2=2*this.mt,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.radix-15)-1};a.prototype.reduce=function(t){for(var e=t.radixMask+1;t.limbs.length<=this.mt2;)t.limbs[t.limbs.length]=0;for(var r=0;r<this.mt;++r){var n=32767&t.limbs[r],i=n*this.mpl+((n*this.mph+(t.limbs[r]>>15)*this.mpl&this.um)<<15)&t.radixMask;for(n=r+this.mt,t.limbs[n]+=this.m.am(0,i,t,r,0,this.mt);t.limbs[n]>=e;)t.limbs[n]-=e,t.limbs[++n]++}return t.trim(),t=t.shiftRight(this.mt*this.m.radix),t.greaterEquals(this.m)&&(t=t.sub(this.m)),t.trim().normalize().reduce()},a.prototype.square=function(t){return this.reduce(t.square())},a.prototype.multiply=function(t,e){return this.reduce(t.mul(e))},a.prototype.convert=function(t){return t.abs().shiftLeft(this.mt*this.m.radix).mod(this.m)},a.prototype.revert=function(t){return this.reduce(t.copy())},o.bn.prototype.powermodMontgomery=function(t,r){var n,i=t.bitLength(),s=new this._class(1);if(0>=i)return s;if(n=18>i?1:48>i?3:144>i?4:768>i?5:6,8>i||!r.testBit(0))return this.powermod(t,r);var o=new a(r);t.trim().normalize();var c=new Array,u=3,h=n-1,f=(1<<n)-1;if(c[1]=o.convert(this),n>1)for(var l=o.square(c[1]);f>=u;)c[u]=o.multiply(l,c[u-2]),u+=2;var p,_,d=t.limbs.length-1,y=!0,m=new this._class;for(i=e(t.limbs[d])-1;d>=0;){for(i>=h?p=t.limbs[d]>>i-h&f:(p=(t.limbs[d]&(1<<i+1)-1)<<h-i,d>0&&(p|=t.limbs[d-1]>>this.radix+i-h)),u=n;0==(1&p);)p>>=1,--u;if((i-=u)<0&&(i+=this.radix,--d),y)s=c[p].copy(),y=!1;else{for(;u>1;)m=o.square(s),s=o.square(m),u-=2;u>0?m=o.square(s):(_=s,s=m,m=_),s=o.multiply(m,c[p])}for(;d>=0&&0==(t.limbs[d]&1<<i);)m=o.square(s),_=s,s=m,m=_,--i<0&&(i=this.radix-1,--d)}return o.revert(s)},o.ecc.ecdsa.secretKey.prototype.sign=function(t,e,r){var n,i=this._curve.r,s=i.bitLength();n="object"==typeof r&&r.length>0&&"number"==typeof r[0]?r:"string"==typeof r&&/^[0-9a-fA-F]+$/.test(r)?o.bn.fromBits(o.codec.hex.toBits(r)):o.bn.random(i.sub(1),e).add(1);var a=this._curve.G.mult(n).x.mod(i),c=o.bn.fromBits(t).add(a.mul(this._exponent)).mul(n.inverseMod(i)).mod(i);return o.bitArray.concat(a.toBits(s),c.toBits(s))},o.ecc.ecdsa.publicKey.prototype.verify=function(t,e){var r=o.bitArray,n=this._curve.r,i=n.bitLength(),s=o.bn.fromBits(r.bitSlice(e,0,i)),a=o.bn.fromBits(r.bitSlice(e,i,2*i)),c=a.inverseMod(n),u=o.bn.fromBits(t).mul(c).mod(n),h=s.mul(c).mod(n),f=this._curve.G.mult2(u,h,this._point).x;if(s.equals(0)||a.equals(0)||s.greaterEquals(n)||a.greaterEquals(n)||!f.equals(s))throw new o.exception.corrupt("signature didn't check out");return!0},o.ecc.ecdsa.secretKey.prototype.canonicalizeSignature=function(t){var e=o.bitArray,r=this._curve.r,n=r.bitLength(),i=o.bn.fromBits(e.bitSlice(t,0,n)),s=o.bn.fromBits(e.bitSlice(t,n,2*n));return r.copy().halveM().greaterEquals(s)||(s=r.sub(s)),e.concat(i.toBits(n),s.toBits(n))},o.ecc.ecdsa.secretKey.prototype.signDER=function(t,e){return this.encodeDER(this.sign(t,e))},o.ecc.ecdsa.secretKey.prototype.encodeDER=function(t){for(var e=o.bitArray,r=this._curve.r,n=r.bitLength(),i=o.codec.bytes.fromBits(e.bitSlice(t,0,n)),s=o.codec.bytes.fromBits(e.bitSlice(t,n,2*n));!i[0]&&i.length;)i.shift();for(;!s[0]&&s.length;)s.shift();128&i[0]&&i.unshift(0),128&s[0]&&s.unshift(0);var a=[].concat(48,4+i.length+s.length,2,i.length,i,2,s.length,s);return o.codec.bytes.toBits(a)};var c;o.ecc.ecdsa.secretKey.prototype.signWithRecoverablePublicKey=function(t,e,i){var s,a=this;if(!("object"==typeof t&&t.length>0&&"number"==typeof t[0]))throw new o.exception.invalid("hash. Must be a bitArray");s=t;var c=a.sign(s,e,i),u=a.canonicalizeSignature(c),h=r(a._curve,u),f=a._curve.G.mult(o.bn.fromBits(a.get())),l=n(a._curve,h.r,h.s,s,f),p=l+27,_=o.bitArray.concat([p],u);return _},o.ecc.ecdsa.publicKey.recoverFromSignature=function(t,e,n){if(!e||e instanceof o.ecc.curve)throw new o.exception.invalid("must supply hash and signature to recover public key");n||(n=o.ecc.curves.c256);var s;if(!("object"==typeof t&&t.length>0&&"number"==typeof t[0]))throw new o.exception.invalid("hash. Must be a bitArray");s=t;var a;if(!("object"==typeof e&&e.length>0&&"number"==typeof e[0]))throw new o.exception.invalid("signature. Must be a bitArray");a=e;var c=a[0]-27;if(0>c||c>3)throw new o.exception.invalid("signature. Signature must be generated with algorithm that prepends the recovery factor in order to recover the public key");
var u=r(n,a.slice(1)),h=u.r,f=u.s,l=i(n,h,f,s,c),p=new o.ecc.ecdsa.publicKey(n,l);return p},o.bn.prototype.jacobi=function(t){var e=this;if(t=new o.bn(t),-1!==t.sign()){if(e.equals(0))return 0;if(e.equals(1))return 1;for(var r=0,n=0;!e.testBit(n);)n++;var i=e.shiftRight(n);if(0===(1&n))r=1;else{var s=t.modInt(8);1===s||7===s?r=1:(3===s||5===s)&&(r=-1)}return 3===t.modInt(4)&&3===i.modInt(4)&&(r=-r),i.equals(1)?r:r*t.mod(i).jacobi(i)}}},function(t,e){function r(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function n(){return new r(null)}function i(t,e,r,n,i,s){for(;--s>=0;){var o=e*this[t++]+r[n]+i;i=Math.floor(o/67108864),r[n++]=67108863&o}return i}function s(t,e,r,n,i,s){for(var o=32767&e,a=e>>15;--s>=0;){var c=32767&this[t],u=this[t++]>>15,h=a*c+u*o;c=o*c+((32767&h)<<15)+r[n]+(1073741823&i),i=(c>>>30)+(h>>>15)+a*u+(i>>>30),r[n++]=1073741823&c}return i}function o(t,e,r,n,i,s){for(var o=16383&e,a=e>>14;--s>=0;){var c=16383&this[t],u=this[t++]>>14,h=a*c+u*o;c=o*c+((16383&h)<<14)+r[n]+i,i=(c>>28)+(h>>14)+a*u,r[n++]=268435455&c}return i}function a(t){return or.charAt(t)}function c(t,e){var r=ar[t.charCodeAt(e)];return null==r?-1:r}function u(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function h(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function f(t){var e=n();return e.fromInt(t),e}function l(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,s=!1,o=0;--i>=0;){var a=8==n?255&t[i]:c(t,i);0>a?"-"==t.charAt(i)&&(s=!0):(s=!1,0==o?this[this.t++]=a:o+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=n,o>=this.DB&&(o-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&r.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function _(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,s="",o=this.t,c=this.DB-o*this.DB%e;if(o-->0)for(c<this.DB&&(r=this[o]>>c)>0&&(i=!0,s=a(r));o>=0;)e>c?(r=(this[o]&(1<<c)-1)<<e-c,r|=this[--o]>>(c+=this.DB-e)):(r=this[o]>>(c-=e)&n,0>=c&&(c+=this.DB,--o)),r>0&&(i=!0),i&&(s+=a(r));return i?s:"0"}function d(){var t=n();return r.ZERO.subTo(this,t),t}function y(){return this.s<0?this.negate():this}function m(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function v(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function g(){return this.t<=0?0:this.DB*(this.t-1)+v(this[this.t-1]^this.s&this.DM)}function b(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function w(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function E(t,e){var r,n=t%this.DB,i=this.DB-n,s=(1<<i)-1,o=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+o+1]=this[r]>>i|a,a=(this[r]&s)<<n;for(r=o-1;r>=0;--r)e[r]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function x(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&s)<<i,e[o-r]=this[o]>>n;n>0&&(e[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function S(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);i>r;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=0>n?-1:0,-1>n?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}function A(t,e){var n=this.abs(),i=t.abs(),s=n.t;for(e.t=s+i.t;--s>=0;)e[s]=0;for(s=0;s<i.t;++s)e[s+n.t]=n.am(0,i[s],e,s,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)}function T(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function k(t,e,i){var s=t.abs();if(!(s.t<=0)){var o=this.abs();if(o.t<s.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),c=this.s,u=t.s,h=this.DB-v(s[s.t-1]);h>0?(s.lShiftTo(h,a),o.lShiftTo(h,i)):(s.copyTo(a),o.copyTo(i));var f=a.t,l=a[f-1];if(0!=l){var p=l*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),_=this.FV/p,d=(1<<this.F1)/p,y=1<<this.F2,m=i.t,g=m-f,b=null==e?n():e;for(a.dlShiftTo(g,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),r.ONE.dlShiftTo(f,b),b.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--g>=0;){var w=i[--m]==l?this.DM:Math.floor(i[m]*_+(i[m-1]+y)*d);if((i[m]+=a.am(0,w,i,g,0,f))<w)for(a.dlShiftTo(g,b),i.subTo(b,i);i[m]<--w;)i.subTo(b,i)}null!=e&&(i.drShiftTo(f,e),c!=u&&r.ZERO.subTo(e,e)),i.t=f,i.clamp(),h>0&&i.rShiftTo(h,i),0>c&&r.ZERO.subTo(i,i)}}}function j(t){var e=n();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e}function B(t){this.m=t}function R(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function I(t){return t}function q(t){t.divRemTo(this.m,null,t)}function C(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function D(t,e){t.squareTo(e),this.reduce(e)}function O(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function L(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t){var e=n();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e}function N(t){var e=n();return t.copyTo(e),this.reduce(e),e}function F(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function P(t,e){t.squareTo(e),this.reduce(e)}function z(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function U(){return 0==(this.t>0?1&this[0]:this.s)}function H(t,e){if(t>4294967295||1>t)return r.ONE;var i=n(),s=n(),o=e.convert(this),a=v(t)-1;for(o.copyTo(i);--a>=0;)if(e.sqrTo(i,s),(t&1<<a)>0)e.mulTo(s,o,i);else{var c=i;i=s,s=c}return e.revert(i)}function V(t,e){var r;return r=256>t||e.isEven()?new B(e):new L(e),this.exp(t,r)}function G(){var t=n();return this.copyTo(t),t}function K(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function X(){return 0==this.t?this.s:this[0]<<24>>24}function Z(){return 0==this.t?this.s:this[0]<<16>>16}function J(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function $(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=f(r),s=n(),o=n(),a="";for(this.divRemTo(i,s,o);s.signum()>0;)a=(r+o.intValue()).toString(t).substr(1)+a,s.divRemTo(i,s,o);return o.intValue().toString(t)+a}function W(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),s=!1,o=0,a=0,u=0;u<t.length;++u){var h=c(t,u);0>h?"-"==t.charAt(u)&&0==this.signum()&&(s=!0):(a=e*a+h,++o>=n&&(this.dMultiply(i),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),s&&r.ZERO.subTo(this,this)}function Y(t,e,n){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(r.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(r.ONE.shiftLeft(t-1),this);else{var i=new Array,s=7&t;i.length=(t>>3)+1,e.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}function te(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(t-->0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);t>=0;)8>n?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function ee(t){return 0==this.compareTo(t)}function re(t){return this.compareTo(t)<0?this:t}function ne(t){return this.compareTo(t)>0?this:t}function ie(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;s>n;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function se(t,e){return t&e}function oe(t){var e=n();return this.bitwiseTo(t,se,e),e}function ae(t,e){return t|e}function ce(t){var e=n();return this.bitwiseTo(t,ae,e),e}function ue(t,e){return t^e}function he(t){var e=n();return this.bitwiseTo(t,ue,e),e}function fe(t,e){return t&~e}function le(t){var e=n();return this.bitwiseTo(t,fe,e),e}function pe(){for(var t=n(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function _e(t){var e=n();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function de(t){var e=n();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function ye(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function me(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+ye(this[t]);return this.s<0?this.t*this.DB:-1}function ve(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function ge(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=ve(this[r]^e);return t}function be(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function we(t,e){var n=r.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n}function Ee(t){return this.changeBit(t,ae)}function xe(t){return this.changeBit(t,fe)}function Se(t){return this.changeBit(t,ue)}function Ae(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);i>r;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=0>n?-1:0,n>0?e[r++]=n:-1>n&&(e[r++]=this.DV+n),e.t=r,e.clamp()}function Te(t){var e=n();return this.addTo(t,e),e}function ke(t){var e=n();return this.subTo(t,e),e}function je(t){var e=n();return this.multiplyTo(t,e),e}function Be(){var t=n();return this.squareTo(t),t}function Re(t){var e=n();return this.divRemTo(t,e,null),e}function Ie(t){var e=n();return this.divRemTo(t,null,e),e}function qe(t){var e=n(),r=n();return this.divRemTo(t,e,r),new Array(e,r)}function Ce(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function De(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Oe(){}function Le(t){return t}function Me(t,e,r){t.multiplyTo(e,r)}function Ne(t,e){t.squareTo(e)}function Fe(t){return this.exp(t,new Oe)}function Pe(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;i>n;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);i>n;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()}function ze(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Ue(t){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function He(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=n();return t.copyTo(e),this.reduce(e),e}function Ve(t){return t}function Ge(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ke(t,e){t.squareTo(e),this.reduce(e)}function Xe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Ze(t,e){var r,i,s=t.bitLength(),o=f(1);if(0>=s)return o;r=18>s?1:48>s?3:144>s?4:768>s?5:6,i=8>s?new B(e):e.isEven()?new Ue(e):new L(e);var a=new Array,c=3,u=r-1,h=(1<<r)-1;if(a[1]=i.convert(this),r>1){var l=n();for(i.sqrTo(a[1],l);h>=c;)a[c]=n(),i.mulTo(l,a[c-2],a[c]),c+=2}var p,_,d=t.t-1,y=!0,m=n();for(s=v(t[d])-1;d>=0;){for(s>=u?p=t[d]>>s-u&h:(p=(t[d]&(1<<s+1)-1)<<u-s,d>0&&(p|=t[d-1]>>this.DB+s-u)),c=r;0==(1&p);)p>>=1,--c;if((s-=c)<0&&(s+=this.DB,--d),y)a[p].copyTo(o),y=!1;else{for(;c>1;)i.sqrTo(o,m),i.sqrTo(m,o),c-=2;c>0?i.sqrTo(o,m):(_=o,o=m,m=_),i.mulTo(m,a[p],o)}for(;d>=0&&0==(t[d]&1<<s);)i.sqrTo(o,m),_=o,o=m,m=_,--s<0&&(s=this.DB-1,--d)}return i.revert(o)}function Je(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(0>s)return e;for(s>i&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function $e(t){if(0>=t)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r}function Qe(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return r.ZERO;for(var n=t.clone(),i=this.clone(),s=f(1),o=f(0),a=f(0),c=f(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);n.compareTo(i)>=0?(n.subTo(i,n),e&&s.subTo(a,s),o.subTo(c,o)):(i.subTo(n,i),e&&a.subTo(s,a),c.subTo(o,c))}return 0!=i.compareTo(r.ONE)?r.ZERO:c.compareTo(t)>=0?c.subtract(t):c.signum()<0?(c.addTo(t,c),c.signum()<0?c.add(t):c):c}function We(t){var e,r=this.abs();if(1==r.t&&r[0]<=cr[cr.length-1]){for(e=0;e<cr.length;++e)if(r[0]==cr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<cr.length;){for(var n=cr[e],i=e+1;i<cr.length&&ur>n;)n*=cr[i++];for(n=r.modInt(n);i>e;)if(n%cr[e++]==0)return!1}return r.millerRabin(t)}function Ye(t){var e=this.subtract(r.ONE),i=e.getLowestSetBit();if(0>=i)return!1;var s=e.shiftRight(i);t=t+1>>1,t>cr.length&&(t=cr.length);for(var o=n(),a=0;t>a;++a){o.fromInt(cr[Math.floor(Math.random()*cr.length)]);var c=o.modPow(s,this);if(0!=c.compareTo(r.ONE)&&0!=c.compareTo(e)){for(var u=1;u++<i&&0!=c.compareTo(e);)if(c=c.modPowInt(2,this),0==c.compareTo(r.ONE))return!1;if(0!=c.compareTo(e))return!1}}return!0}var tr,er=0xdeadbeefcafe,rr=15715070==(16777215&er);rr&&"undefined"!=typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=s,tr=30):rr&&"undefined"!=typeof navigator&&"Netscape"!=navigator.appName?(r.prototype.am=i,tr=26):(r.prototype.am=o,tr=28),r.prototype.DB=tr,r.prototype.DM=(1<<tr)-1,r.prototype.DV=1<<tr;var nr=52;r.prototype.FV=Math.pow(2,nr),r.prototype.F1=nr-tr,r.prototype.F2=2*tr-nr;var ir,sr,or="0123456789abcdefghijklmnopqrstuvwxyz",ar=new Array;for(ir="0".charCodeAt(0),sr=0;9>=sr;++sr)ar[ir++]=sr;for(ir="a".charCodeAt(0),sr=10;36>sr;++sr)ar[ir++]=sr;for(ir="A".charCodeAt(0),sr=10;36>sr;++sr)ar[ir++]=sr;B.prototype.convert=R,B.prototype.revert=I,B.prototype.reduce=q,B.prototype.mulTo=C,B.prototype.sqrTo=D,L.prototype.convert=M,L.prototype.revert=N,L.prototype.reduce=F,L.prototype.mulTo=z,L.prototype.sqrTo=P,Oe.prototype.convert=Le,Oe.prototype.revert=Le,Oe.prototype.mulTo=Me,Oe.prototype.sqrTo=Ne,Ue.prototype.convert=He,Ue.prototype.revert=Ve,Ue.prototype.reduce=Ge,Ue.prototype.mulTo=Xe,Ue.prototype.sqrTo=Ke;var cr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ur=(1<<26)/cr[cr.length-1];r.prototype.chunkSize=J,r.prototype.toRadix=Q,r.prototype.fromRadix=W,r.prototype.fromNumber=Y,r.prototype.bitwiseTo=ie,r.prototype.changeBit=we,r.prototype.addTo=Ae,r.prototype.dMultiply=Ce,r.prototype.dAddOffset=De,r.prototype.multiplyLowerTo=Pe,r.prototype.multiplyUpperTo=ze,r.prototype.modInt=$e,r.prototype.millerRabin=Ye,r.prototype.copyTo=u,r.prototype.fromInt=h,r.prototype.fromString=l,r.prototype.clamp=p,r.prototype.dlShiftTo=b,r.prototype.drShiftTo=w,r.prototype.lShiftTo=E,r.prototype.rShiftTo=x,r.prototype.subTo=S,r.prototype.multiplyTo=A,r.prototype.squareTo=T,r.prototype.divRemTo=k,r.prototype.invDigit=O,r.prototype.isEven=U,r.prototype.exp=H,r.prototype.toString=_,r.prototype.negate=d,r.prototype.abs=y,r.prototype.compareTo=m,r.prototype.bitLength=g,r.prototype.mod=j,r.prototype.modPowInt=V,r.prototype.clone=G,r.prototype.intValue=K,r.prototype.byteValue=X,r.prototype.shortValue=Z,r.prototype.signum=$,r.prototype.toByteArray=te,r.prototype.equals=ee,r.prototype.min=re,r.prototype.max=ne,r.prototype.and=oe,r.prototype.or=ce,r.prototype.xor=he,r.prototype.andNot=le,r.prototype.not=pe,r.prototype.shiftLeft=_e,r.prototype.shiftRight=de,r.prototype.getLowestSetBit=me,r.prototype.bitCount=ge,r.prototype.testBit=be,r.prototype.setBit=Ee,r.prototype.clearBit=xe,r.prototype.flipBit=Se,r.prototype.add=Te,r.prototype.subtract=ke,r.prototype.multiply=je,r.prototype.divide=Re,r.prototype.remainder=Ie,r.prototype.divideAndRemainder=qe,r.prototype.modPow=Ze,r.prototype.modInverse=Qe,r.prototype.pow=Fe,r.prototype.gcd=Je,r.prototype.isProbablePrime=We,r.prototype.square=Be,r.ZERO=f(0),r.ONE=f(1),r.valueOf=n,e.BigInteger=r},function(t){try{t.exports=WebSocket}catch(e){t.exports=MozWebSocket}var r,n=/Version\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//;"object"==typeof navigator&&"string"==typeof navigator.userAgent&&(r=n.exec(navigator.userAgent))&&2===window.WebSocket.CLOSED&&(/iP(hone|od|ad)/.test(navigator.platform)?+r[1]<5&&(t.exports=void 0):-1!==navigator.appVersion.indexOf("Mac")&&+r[1]<6&&(t.exports=void 0))},function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function n(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!n(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,n,o,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length))throw e=arguments[1],e instanceof Error?e:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[t],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,a=new Array(o-1),c=1;o>c;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(i(n)){for(o=arguments.length,a=new Array(o-1),c=1;o>c;c++)a[c-1]=arguments[c];for(u=n.slice(),o=u.length,c=0;o>c;c++)u[c].apply(this,a)}return!0},e.prototype.addListener=function(t,n){var o;if(!r(n))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(n.listener)?n.listener:n),this._events[t]?i(this._events[t])?this._events[t].push(n):this._events[t]=[this._events[t],n]:this._events[t]=n,i(this._events[t])&&!this._events[t].warned){var o;o=s(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},e.prototype.removeListener=function(t,e){var n,s,o,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,s=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(a=o;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){s=a;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},function(t,e,r){(function(t,n){function i(t,r){var n={seen:[],stylize:o};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(r)?n.showHidden=r:r&&e._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,t,n.depth)}function s(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function o(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function c(t,r,n){if(t.customInspect&&r&&T(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return g(i)||(i=c(t,i,n)),i}var s=u(t,r);if(s)return s;var o=Object.keys(r),d=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(r)),A(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(r);if(0===o.length){if(T(r)){var y=r.name?": "+r.name:"";return t.stylize("[Function"+y+"]","special")}if(E(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(A(r))return h(r)}var m="",v=!1,b=["{","}"];if(_(r)&&(v=!0,b=["[","]"]),T(r)){var w=r.name?": "+r.name:"";m=" [Function"+w+"]"}if(E(r)&&(m=" "+RegExp.prototype.toString.call(r)),S(r)&&(m=" "+Date.prototype.toUTCString.call(r)),A(r)&&(m=" "+h(r)),0===o.length&&(!v||0==r.length))return b[0]+m+b[1];if(0>n)return E(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var x;return x=v?f(t,r,n,d,o):o.map(function(e){return l(t,r,n,d,e,v)}),t.seen.pop(),p(x,m,b)}function u(t,e){if(w(e))return t.stylize("undefined","undefined");if(g(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,r,n,i){for(var s=[],o=0,a=e.length;a>o;++o)s.push(I(e,String(o))?l(t,e,r,n,String(o),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||s.push(l(t,e,r,n,i,!0))}),s}function l(t,e,r,n,i,s){var o,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),I(n,i)||(o="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(r)?c(t,u.value,null):c(t,u.value,r-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function p(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function _(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return null==t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function w(t){return void 0===t}function E(t){return x(t)&&"[object RegExp]"===j(t)}function x(t){return"object"==typeof t&&null!==t}function S(t){return x(t)&&"[object Date]"===j(t)}function A(t){return x(t)&&("[object Error]"===j(t)||t instanceof Error)}function T(t){return"function"==typeof t}function k(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function j(t){return Object.prototype.toString.call(t)}function B(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[B(t.getHours()),B(t.getMinutes()),B(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var q=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,s=n.length,o=String(t).replace(q,function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return t}}),a=n[r];s>r;a=n[++r])o+=y(a)||!x(a)?" "+a:" "+i(a);return o},e.deprecate=function(r,i){function s(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return r.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(n.noDeprecation===!0)return r;var o=!1;return s};var C,D={};e.debuglog=function(t){if(w(C)&&(C=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(C)){var r=n.pid;D[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else D[t]=function(){};return D[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=_,e.isBoolean=d,e.isNull=y,e.isNullOrUndefined=m,e.isNumber=v,e.isString=g,e.isSymbol=b,e.isUndefined=w,e.isRegExp=E,e.isObject=x,e.isDate=S,e.isError=A,e.isFunction=T,e.isPrimitive=k,e.isBuffer=r(60);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=r(67),e._extend=function(t,e){if(!e||!x(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(e,function(){return this}(),r(61))},function(t){function e(t){this._namespace=t?Array.isArray(t)?t:[""+t]:[],this._prefix=this._namespace.concat([""]).join(": ")}e.prototype.sub=function(t){var r=this._namespace.slice();t&&"string"==typeof t&&r.push(t);var n=new e(r);return n._setParent(this),n},e.prototype._setParent=function(t){this._parent=t},e.makeLevel=function(){return function(){var t=Array.prototype.slice.call(arguments);t[0]=this._prefix+t[0],e.engine.logObject.apply(e,t)}},e.prototype.debug=e.makeLevel(1),e.prototype.info=e.makeLevel(2),e.prototype.warn=e.makeLevel(3),e.prototype.error=e.makeLevel(4);var r={logObject:function(t){var e=Array.prototype.slice.call(arguments,1);e=e.map(function(t){return JSON.stringify(t,null,2)}),e.unshift(t),console.log.apply(console,e)}},n={logObject:function(){}};e.engine=n,console&&console.log&&(e.engine=r),t.exports=new e,t.exports.internal=t.exports.sub(),t.exports.Log=e},function(t,e,r){function n(t,e){return p.isUndefined(e)?""+e:!p.isNumber(e)||!isNaN(e)&&isFinite(e)?p.isFunction(e)||p.isRegExp(e)?e.toString():e:e.toString()}function i(t,e){return p.isString(t)?t.length<e?t:t.slice(0,e):t}function s(t){return i(JSON.stringify(t.actual,n),128)+" "+t.operator+" "+i(JSON.stringify(t.expected,n),128)}function o(t,e,r,n,i){throw new y.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function a(t,e){t||o(t,!0,e,"==",y.ok)}function c(t,e){if(t===e)return!0;if(p.isBuffer(t)&&p.isBuffer(e)){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return p.isDate(t)&&p.isDate(e)?t.getTime()===e.getTime():p.isRegExp(t)&&p.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:p.isObject(t)||p.isObject(e)?h(t,e):t==e}function u(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function h(t,e){if(p.isNullOrUndefined(t)||p.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(u(t))return u(e)?(t=_.call(t),e=_.call(e),c(t,e)):!1;try{var r,n,i=m(t),s=m(e)}catch(o){return!1}if(i.length!=s.length)return!1;for(i.sort(),s.sort(),n=i.length-1;n>=0;n--)if(i[n]!=s[n])return!1;for(n=i.length-1;n>=0;n--)if(r=i[n],!c(t[r],e[r]))return!1;return!0}function f(t,e){return t&&e?"[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e?!0:e.call({},t)===!0?!0:!1:!1}function l(t,e,r,n){var i;p.isString(r)&&(n=r,r=null);try{e()}catch(s){i=s}if(n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&o(i,r,"Missing expected exception"+n),!t&&f(i,r)&&o(i,r,"Got unwanted exception"+n),t&&i&&r&&!f(i,r)||!t&&i)throw i}var p=r(68),_=Array.prototype.slice,d=Object.prototype.hasOwnProperty,y=t.exports=a;y.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=s(this),this.generatedMessage=!0);var e=t.stackStartFunction||o;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var n=r.stack,i=e.name,a=n.indexOf("\n"+i);if(a>=0){var c=n.indexOf("\n",a+1);n=n.substring(c+1)}this.stack=n}}},p.inherits(y.AssertionError,Error),y.fail=o,y.ok=a,y.equal=function(t,e,r){t!=e&&o(t,e,r,"==",y.equal)
},y.notEqual=function(t,e,r){t==e&&o(t,e,r,"!=",y.notEqual)},y.deepEqual=function(t,e,r){c(t,e)||o(t,e,r,"deepEqual",y.deepEqual)},y.notDeepEqual=function(t,e,r){c(t,e)&&o(t,e,r,"notDeepEqual",y.notDeepEqual)},y.strictEqual=function(t,e,r){t!==e&&o(t,e,r,"===",y.strictEqual)},y.notStrictEqual=function(t,e,r){t===e&&o(t,e,r,"!==",y.notStrictEqual)},y.throws=function(){l.apply(this,[!0].concat(_.call(arguments)))},y.doesNotThrow=function(){l.apply(this,[!1].concat(_.call(arguments)))},y.ifError=function(t){if(t)throw t};var m=Object.keys||function(t){var e=[];for(var r in t)d.call(t,r)&&e.push(r);return e}},function(t,e,r){(function(t){function t(e,r,n){if(!(this instanceof t))return new t(e,r,n);var i=typeof e;if("base64"===r&&"string"===i)for(e=k(e);e.length%4!==0;)e+="=";var s;if("number"===i)s=B(e);else if("string"===i)s=t.byteLength(e,r);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");s=B(e.length)}var o;t._useTypedArrays?o=t._augment(new Uint8Array(s)):(o=this,o.length=s,o._isBuffer=!0);var a;if(t._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(I(e))for(a=0;s>a;a++)o[a]=t.isBuffer(e)?e.readUInt8(a):e[a];else if("string"===i)o.write(e,0,r);else if("number"===i&&!t._useTypedArrays&&!n)for(a=0;s>a;a++)o[a]=0;return o}function n(e,r,n,i){n=Number(n)||0;var s=e.length-n;i?(i=Number(i),i>s&&(i=s)):i=s;var o=r.length;U(o%2===0,"Invalid hex string"),i>o/2&&(i=o/2);for(var a=0;i>a;a++){var c=parseInt(r.substr(2*a,2),16);U(!isNaN(c),"Invalid hex string"),e[n+a]=c}return t._charsWritten=2*a,a}function i(e,r,n,i){var s=t._charsWritten=M(C(r),e,n,i);return s}function s(e,r,n,i){var s=t._charsWritten=M(D(r),e,n,i);return s}function o(t,e,r,n){return s(t,e,r,n)}function a(e,r,n,i){var s=t._charsWritten=M(L(r),e,n,i);return s}function c(e,r,n,i){var s=t._charsWritten=M(O(r),e,n,i);return s}function u(t,e,r){return H.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function h(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var s=e;r>s;s++)t[s]<=127?(n+=N(i)+String.fromCharCode(t[s]),i=""):i+="%"+t[s].toString(16);return n+N(i)}function f(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function l(t,e,r){return f(t,e,r)}function p(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",s=e;r>s;s++)i+=q(t[s]);return i}function _(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function d(t,e,r,n){n||(U("boolean"==typeof r,"missing or invalid endian"),U(void 0!==e&&null!==e,"missing offset"),U(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var s;return r?(s=t[e],i>e+1&&(s|=t[e+1]<<8)):(s=t[e]<<8,i>e+1&&(s|=t[e+1])),s}}function y(t,e,r,n){n||(U("boolean"==typeof r,"missing or invalid endian"),U(void 0!==e&&null!==e,"missing offset"),U(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var s;return r?(i>e+2&&(s=t[e+2]<<16),i>e+1&&(s|=t[e+1]<<8),s|=t[e],i>e+3&&(s+=t[e+3]<<24>>>0)):(i>e+1&&(s=t[e+1]<<16),i>e+2&&(s|=t[e+2]<<8),i>e+3&&(s|=t[e+3]),s+=t[e]<<24>>>0),s}}function m(t,e,r,n){n||(U("boolean"==typeof r,"missing or invalid endian"),U(void 0!==e&&null!==e,"missing offset"),U(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var s=d(t,e,r,!0),o=32768&s;return o?-1*(65535-s+1):s}}function v(t,e,r,n){n||(U("boolean"==typeof r,"missing or invalid endian"),U(void 0!==e&&null!==e,"missing offset"),U(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var s=y(t,e,r,!0),o=2147483648&s;return o?-1*(4294967295-s+1):s}}function g(t,e,r,n){return n||(U("boolean"==typeof r,"missing or invalid endian"),U(e+3<t.length,"Trying to read beyond buffer length")),V.read(t,e,r,23,4)}function b(t,e,r,n){return n||(U("boolean"==typeof r,"missing or invalid endian"),U(e+7<t.length,"Trying to read beyond buffer length")),V.read(t,e,r,52,8)}function w(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+1<t.length,"trying to write beyond buffer length"),F(e,65535));var s=t.length;if(!(r>=s))for(var o=0,a=Math.min(s-r,2);a>o;o++)t[r+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function E(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+3<t.length,"trying to write beyond buffer length"),F(e,4294967295));var s=t.length;if(!(r>=s))for(var o=0,a=Math.min(s-r,4);a>o;o++)t[r+o]=e>>>8*(n?o:3-o)&255}function x(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+1<t.length,"Trying to write beyond buffer length"),P(e,32767,-32768));var s=t.length;r>=s||(e>=0?w(t,e,r,n,i):w(t,65535+e+1,r,n,i))}function S(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+3<t.length,"Trying to write beyond buffer length"),P(e,2147483647,-2147483648));var s=t.length;r>=s||(e>=0?E(t,e,r,n,i):E(t,4294967295+e+1,r,n,i))}function A(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+3<t.length,"Trying to write beyond buffer length"),z(e,3.4028234663852886e38,-3.4028234663852886e38));var s=t.length;r>=s||V.write(t,e,r,n,23,4)}function T(t,e,r,n,i){i||(U(void 0!==e&&null!==e,"missing value"),U("boolean"==typeof n,"missing or invalid endian"),U(void 0!==r&&null!==r,"missing offset"),U(r+7<t.length,"Trying to write beyond buffer length"),z(e,1.7976931348623157e308,-1.7976931348623157e308));var s=t.length;r>=s||V.write(t,e,r,n,52,8)}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function j(t,e,r){return"number"!=typeof t?r:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function B(t){return t=~~Math.ceil(+t),0>t?0:t}function R(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function I(e){return R(e)||t.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function q(t){return 16>t?"0"+t.toString(16):t.toString(16)}function C(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);if(127>=n)e.push(t.charCodeAt(r));else{var i=r;n>=55296&&57343>=n&&r++;for(var s=encodeURIComponent(t.slice(i,r+1)).substr(1).split("%"),o=0;o<s.length;o++)e.push(parseInt(s[o],16))}}return e}function D(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function O(t){for(var e,r,n,i=[],s=0;s<t.length;s++)e=t.charCodeAt(s),r=e>>8,n=e%256,i.push(n),i.push(r);return i}function L(t){return H.toByteArray(t)}function M(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function N(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function F(t,e){U("number"==typeof t,"cannot write a non-number as a number"),U(t>=0,"specified a negative value for writing an unsigned value"),U(e>=t,"value is larger than maximum value for type"),U(Math.floor(t)===t,"value has a fractional component")}function P(t,e,r){U("number"==typeof t,"cannot write a non-number as a number"),U(e>=t,"value larger than maximum allowed value"),U(t>=r,"value smaller than minimum allowed value"),U(Math.floor(t)===t,"value has a fractional component")}function z(t,e,r){U("number"==typeof t,"cannot write a non-number as a number"),U(e>=t,"value larger than maximum allowed value"),U(t>=r,"value smaller than minimum allowed value")}function U(t,e){if(!t)throw new Error(e||"Failed assertion")}/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
var H=r(71),V=r(64);e.Buffer=t,e.SlowBuffer=t,e.INSPECT_MAX_BYTES=50,t.poolSize=8192,t._useTypedArrays=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray}catch(r){return!1}}(),t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},t.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"hex":r=t.length/2;break;case"utf8":case"utf-8":r=C(t).length;break;case"ascii":case"binary":case"raw":r=t.length;break;case"base64":r=L(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;default:throw new Error("Unknown encoding")}return r},t.concat=function(e,r){if(U(R(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new t(0);if(1===e.length)return e[0];var n;if("number"!=typeof r)for(r=0,n=0;n<e.length;n++)r+=e[n].length;var i=new t(r),s=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(i,s),s+=o.length}return i},t.prototype.write=function(t,e,r,u){if(isFinite(e))isFinite(r)||(u=r,r=void 0);else{var h=u;u=e,e=r,r=h}e=Number(e)||0;var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,u=String(u||"utf8").toLowerCase();var l;switch(u){case"hex":l=n(this,t,e,r);break;case"utf8":case"utf-8":l=i(this,t,e,r);break;case"ascii":l=s(this,t,e,r);break;case"binary":l=o(this,t,e,r);break;case"base64":l=a(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=c(this,t,e,r);break;default:throw new Error("Unknown encoding")}return l},t.prototype.toString=function(t,e,r){var n=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,r=void 0!==r?Number(r):r=n.length,r===e)return"";var i;switch(t){case"hex":i=p(n,e,r);break;case"utf8":case"utf-8":i=h(n,e,r);break;case"ascii":i=f(n,e,r);break;case"binary":i=l(n,e,r);break;case"base64":i=u(n,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=_(n,e,r);break;default:throw new Error("Unknown encoding")}return i},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},t.prototype.copy=function(e,r,n,i){var s=this;if(n||(n=0),i||0===i||(i=this.length),r||(r=0),i!==n&&0!==e.length&&0!==s.length){U(i>=n,"sourceEnd < sourceStart"),U(r>=0&&r<e.length,"targetStart out of bounds"),U(n>=0&&n<s.length,"sourceStart out of bounds"),U(i>=0&&i<=s.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n;if(100>o||!t._useTypedArrays)for(var a=0;o>a;a++)e[a+r]=this[a+n];else e._set(this.subarray(n,n+o),r)}},t.prototype.slice=function(e,r){var n=this.length;if(e=j(e,n,0),r=j(r,n,n),t._useTypedArrays)return t._augment(this.subarray(e,r));for(var i=r-e,s=new t(i,void 0,!0),o=0;i>o;o++)s[o]=this[o+e];return s},t.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},t.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},t.prototype.readUInt8=function(t,e){return e||(U(void 0!==t&&null!==t,"missing offset"),U(t<this.length,"Trying to read beyond buffer length")),t>=this.length?void 0:this[t]},t.prototype.readUInt16LE=function(t,e){return d(this,t,!0,e)},t.prototype.readUInt16BE=function(t,e){return d(this,t,!1,e)},t.prototype.readUInt32LE=function(t,e){return y(this,t,!0,e)},t.prototype.readUInt32BE=function(t,e){return y(this,t,!1,e)},t.prototype.readInt8=function(t,e){if(e||(U(void 0!==t&&null!==t,"missing offset"),U(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var r=128&this[t];return r?-1*(255-this[t]+1):this[t]}},t.prototype.readInt16LE=function(t,e){return m(this,t,!0,e)},t.prototype.readInt16BE=function(t,e){return m(this,t,!1,e)},t.prototype.readInt32LE=function(t,e){return v(this,t,!0,e)},t.prototype.readInt32BE=function(t,e){return v(this,t,!1,e)},t.prototype.readFloatLE=function(t,e){return g(this,t,!0,e)},t.prototype.readFloatBE=function(t,e){return g(this,t,!1,e)},t.prototype.readDoubleLE=function(t,e){return b(this,t,!0,e)},t.prototype.readDoubleBE=function(t,e){return b(this,t,!1,e)},t.prototype.writeUInt8=function(t,e,r){r||(U(void 0!==t&&null!==t,"missing value"),U(void 0!==e&&null!==e,"missing offset"),U(e<this.length,"trying to write beyond buffer length"),F(t,255)),e>=this.length||(this[e]=t)},t.prototype.writeUInt16LE=function(t,e,r){w(this,t,e,!0,r)},t.prototype.writeUInt16BE=function(t,e,r){w(this,t,e,!1,r)},t.prototype.writeUInt32LE=function(t,e,r){E(this,t,e,!0,r)},t.prototype.writeUInt32BE=function(t,e,r){E(this,t,e,!1,r)},t.prototype.writeInt8=function(t,e,r){r||(U(void 0!==t&&null!==t,"missing value"),U(void 0!==e&&null!==e,"missing offset"),U(e<this.length,"Trying to write beyond buffer length"),P(t,127,-128)),e>=this.length||(t>=0?this.writeUInt8(t,e,r):this.writeUInt8(255+t+1,e,r))},t.prototype.writeInt16LE=function(t,e,r){x(this,t,e,!0,r)},t.prototype.writeInt16BE=function(t,e,r){x(this,t,e,!1,r)},t.prototype.writeInt32LE=function(t,e,r){S(this,t,e,!0,r)},t.prototype.writeInt32BE=function(t,e,r){S(this,t,e,!1,r)},t.prototype.writeFloatLE=function(t,e,r){A(this,t,e,!0,r)},t.prototype.writeFloatBE=function(t,e,r){A(this,t,e,!1,r)},t.prototype.writeDoubleLE=function(t,e,r){T(this,t,e,!0,r)},t.prototype.writeDoubleBE=function(t,e,r){T(this,t,e,!1,r)},t.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),U("number"==typeof t&&!isNaN(t),"value is not a number"),U(r>=e,"end < start"),r!==e&&0!==this.length){U(e>=0&&e<this.length,"start out of bounds"),U(r>=0&&r<=this.length,"end out of bounds");for(var n=e;r>n;n++)this[n]=t}},t.prototype.inspect=function(){for(var t=[],r=this.length,n=0;r>n;n++)if(t[n]=q(this[n]),n===e.INSPECT_MAX_BYTES){t[n+1]="...";break}return"<Buffer "+t.join(" ")+">"},t.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(t._useTypedArrays)return new t(this).buffer;for(var e=new Uint8Array(this.length),r=0,n=e.length;n>r;r+=1)e[r]=this[r];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var G=t.prototype;t._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=G.get,t.set=G.set,t.write=G.write,t.toString=G.toString,t.toLocaleString=G.toString,t.toJSON=G.toJSON,t.copy=G.copy,t.slice=G.slice,t.readUInt8=G.readUInt8,t.readUInt16LE=G.readUInt16LE,t.readUInt16BE=G.readUInt16BE,t.readUInt32LE=G.readUInt32LE,t.readUInt32BE=G.readUInt32BE,t.readInt8=G.readInt8,t.readInt16LE=G.readInt16LE,t.readInt16BE=G.readInt16BE,t.readInt32LE=G.readInt32LE,t.readInt32BE=G.readInt32BE,t.readFloatLE=G.readFloatLE,t.readFloatBE=G.readFloatBE,t.readDoubleLE=G.readDoubleLE,t.readDoubleBE=G.readDoubleBE,t.writeUInt8=G.writeUInt8,t.writeUInt16LE=G.writeUInt16LE,t.writeUInt16BE=G.writeUInt16BE,t.writeUInt32LE=G.writeUInt32LE,t.writeUInt32BE=G.writeUInt32BE,t.writeInt8=G.writeInt8,t.writeInt16LE=G.writeInt16LE,t.writeInt16BE=G.writeInt16BE,t.writeInt32LE=G.writeInt32LE,t.writeInt32BE=G.writeInt32BE,t.writeFloatLE=G.writeFloatLE,t.writeFloatBE=G.writeFloatBE,t.writeDoubleLE=G.writeDoubleLE,t.writeDoubleBE=G.writeDoubleBE,t.fill=G.fill,t.inspect=G.inspect,t.toArrayBuffer=G.toArrayBuffer,t}}).call(e,r(41).Buffer)},function(t,e,r){(function(t){function n(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function i(t,e){for(var r in t)e(t[r],r)}var s=r(56);e.createHash=r(57),e.createHmac=r(58),e.randomBytes=function(e,r){if(!r||!r.call)return new t(s(e));try{r.call(this,void 0,new t(s(e)))}catch(n){r(n)}},e.getHashes=function(){return["sha1","sha256","md5","rmd160"]};var o=r(59)(e.createHmac);e.pbkdf2=o.pbkdf2,e.pbkdf2Sync=o.pbkdf2Sync,i(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(t){e[t]=function(){n("sorry,",t,"is not implemented yet")}})}).call(e,r(41).Buffer)},function(t,e,r){!function(){"use strict";function t(t,e,r){if(t&&"object"==typeof t&&t.href)return t;if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i={},s=t;s=s.trim();var u=c.exec(s);if(u){u=u[0];var h=u.toLowerCase();i.protocol=h,s=s.substr(u.length)}if(r||u||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var f="//"===s.substr(0,2);!f||u&&g[u]||(s=s.substr(2),i.slashes=!0)}if(!g[u]&&(f||u&&!b[u])){var E=s.indexOf("@");if(-1!==E){for(var x=s.slice(0,E),S=!0,A=0,T=_.length;T>A;A++)if(-1!==x.indexOf(_[A])){S=!1;break}S&&(i.auth=decodeURIComponent(x),s=s.substr(E+1))}for(var k=-1,A=0,T=p.length;T>A;A++){var j=s.indexOf(p[A]);-1!==j&&(0>k||k>j)&&(k=j)}-1!==k?(i.host=s.substr(0,k),s=s.substr(k)):(i.host=s,s="");for(var B=o(i.host),R=Object.keys(B),A=0,T=R.length;T>A;A++){var I=R[A];i[I]=B[I]}i.hostname=i.hostname||"";var q="["===i.hostname[0]&&"]"===i.hostname[i.hostname.length-1];if(i.hostname.length>d)i.hostname="";else if(!q)for(var C=i.hostname.split(/\./),A=0,T=C.length;T>A;A++){var D=C[A];if(D&&!D.match(y)){for(var O="",L=0,M=D.length;M>L;L++)O+=D.charCodeAt(L)>127?"x":D[L];if(!O.match(y)){var N=C.slice(0,A),F=C.slice(A+1),P=D.match(m);P&&(N.push(P[1]),F.unshift(P[2])),F.length&&(s="/"+F.join(".")+s),i.hostname=N.join(".");break}}}if(i.hostname=i.hostname.toLowerCase(),!q){for(var z=i.hostname.split("."),U=[],A=0;A<z.length;++A){var H=z[A];U.push(H.match(/[^A-Za-z0-9_-]/)?"xn--"+a.encode(H):H)}i.hostname=U.join(".")}i.host=(i.hostname||"")+(i.port?":"+i.port:""),i.href+=i.host,q&&(i.hostname=i.hostname.substr(1,i.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!v[h])for(var A=0,T=l.length;T>A;A++){var V=l[A],G=encodeURIComponent(V);G===V&&(G=escape(V)),s=s.split(V).join(G)}var K=s.indexOf("#");-1!==K&&(i.hash=s.substr(K),s=s.slice(0,K));var X=s.indexOf("?");return-1!==X?(i.search=s.substr(X),i.query=s.substr(X+1),e&&(i.query=w.parse(i.query)),s=s.slice(0,X)):e&&(i.search="",i.query={}),s&&(i.pathname=s),b[u]&&i.hostname&&!i.pathname&&(i.pathname="/"),(i.pathname||i.search)&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=n(i),i}function n(e){"string"==typeof e&&(e=t(e));var r=e.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var n=e.protocol||"",i=e.pathname||"",s=e.hash||"",o=!1,a="";void 0!==e.host?o=r+e.host:void 0!==e.hostname&&(o=r+(-1===e.hostname.indexOf(":")?e.hostname:"["+e.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&"object"==typeof e.query&&Object.keys(e.query).length&&(a=w.stringify(e.query));var c=e.search||a&&"?"+a||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||b[n])&&o!==!1?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),s&&"#"!==s.charAt(0)&&(s="#"+s),c&&"?"!==c.charAt(0)&&(c="?"+c),n+o+i+c+s}function i(t,e){return n(s(t,e))}function s(e,r){if(!e)return r;if(e=t(n(e),!1,!0),r=t(n(r),!1,!0),e.hash=r.hash,""===r.href)return e.href=n(e),e;if(r.slashes&&!r.protocol)return r.protocol=e.protocol,b[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=n(r),r;if(r.protocol&&r.protocol!==e.protocol){if(!b[r.protocol])return r.href=n(r),r;if(e.protocol=r.protocol,!r.host&&!g[r.protocol]){for(var i=(r.pathname||"").split("/");i.length&&!(r.host=i.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),r.pathname=i.join("/")}return e.pathname=r.pathname,e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.slashes=e.slashes||r.slashes,e.href=n(e),e}var s=e.pathname&&"/"===e.pathname.charAt(0),o=void 0!==r.host||r.pathname&&"/"===r.pathname.charAt(0),a=o||s||e.host&&r.pathname,c=a,u=e.pathname&&e.pathname.split("/")||[],i=r.pathname&&r.pathname.split("/")||[],h=e.protocol&&!b[e.protocol];if(h&&(delete e.hostname,delete e.port,e.host&&(""===u[0]?u[0]=e.host:u.unshift(e.host)),delete e.host,r.protocol&&(delete r.hostname,delete r.port,r.host&&(""===i[0]?i[0]=r.host:i.unshift(r.host)),delete r.host),a=a&&(""===i[0]||""===u[0])),o)e.host=r.host||""===r.host?r.host:e.host,e.hostname=r.hostname||""===r.hostname?r.hostname:e.hostname,e.search=r.search,e.query=r.query,u=i;else if(i.length)u||(u=[]),u.pop(),u=u.concat(i),e.search=r.search,e.query=r.query;else if("search"in r){if(h){e.hostname=e.host=u.shift();var f=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;f&&(e.auth=f.shift(),e.host=e.hostname=f.shift())}return e.search=r.search,e.query=r.query,(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=n(e),e}if(!u.length)return delete e.pathname,e.search?delete e.path:e.path="/"+e.search,e.href=n(e),e;for(var l=u.slice(-1)[0],p=(e.host||r.host)&&("."===l||".."===l)||""===l,_=0,d=u.length;d>=0;d--)l=u[d],"."==l?u.splice(d,1):".."===l?(u.splice(d,1),_++):_&&(u.splice(d,1),_--);if(!a&&!c)for(;_--;_)u.unshift("..");!a||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),p&&"/"!==u.join("/").substr(-1)&&u.push("");var y=""===u[0]||u[0]&&"/"===u[0].charAt(0);if(h){e.hostname=e.host=y?"":u.length?u.shift():"";var f=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;f&&(e.auth=f.shift(),e.host=e.hostname=f.shift())}return a=a||e.host&&u.length,a&&!y&&u.unshift(""),e.pathname=u.join("/"),(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=n(e),e}function o(t){var e={},r=u.exec(t);return r&&(r=r[0],":"!==r&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t),e}var a=r(70);e.parse=t,e.resolve=i,e.resolveObject=s,e.format=n;var c=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,h=["<",">",'"',"`"," ","\r","\n","	"],f=["{","}","|","\\","^","~","`"].concat(h),l=["'"].concat(h),p=["%","/","?",";","#"].concat(f).concat(l),_=["/","@","?","#"].concat(h),d=255,y=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,m=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,v={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=r(69)}()},function(t){function e(t){if(!t||"[object Object]"!==n.call(t)||t.nodeType||t.setInterval)return!1;var e=r.call(t,"constructor"),i=r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;var s;for(s in t);return void 0===s||r.call(t,s)}var r=Object.prototype.hasOwnProperty,n=Object.prototype.toString;t.exports=function i(){var t,r,n,s,o,a,c=arguments[0]||{},u=1,h=arguments.length,f=!1;for("boolean"==typeof c&&(f=c,c=arguments[1]||{},u=2),"object"!=typeof c&&"function"!=typeof c&&(c={});h>u;u++)if(null!=(t=arguments[u]))for(r in t)n=c[r],s=t[r],c!==s&&(f&&s&&(e(s)||(o=Array.isArray(s)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&e(n)?n:{},c[r]=i(f,a,s)):void 0!==s&&(c[r]=s));return c}},function(t,e,r){function n(){this._queue=[],this._idCache=i(),this._sequenceCache=i()}var i=r(52),s=r(5).Transaction;n.prototype.addReceivedSequence=function(t){this._sequenceCache.set(String(t),!0)},n.prototype.hasSequence=function(t){return this._sequenceCache.has(String(t))},n.prototype.addReceivedId=function(t,e){this._idCache.set(t,e)},n.prototype.getReceived=function(t){return this._idCache.get(t)},n.prototype.getSubmission=function(t){for(var e,r=void 0,n=0;e=this._queue[n];n++)if(~e.submittedIDs.indexOf(t)){r=e;break}return r},n.prototype.remove=function(t){var e=this._queue.length;if("string"==typeof t&&(t=this.getSubmission(t)),t instanceof s)for(;e--;)if(this._queue[e]===t){this._queue.splice(e,1);break}},n.prototype.push=function(t){this._queue.push(t)},n.prototype.forEach=function(t){this._queue.forEach(t)},n.prototype.length=n.prototype.getLength=function(){return this._queue.length},e.TransactionQueue=n},function(t,e,r){var n=r(19),i=r(44),s=r(28).UInt,o=i(function(){this._value=0/0},s);o.width=16,o.prototype=i({},s.prototype),o.prototype.constructor=o;{var a=o.HEX_ZERO="00000000000000000000000000000000",c=o.HEX_ONE="00000000000000000000000000000000";o.STR_ZERO=n.hexToString(a),o.STR_ONE=n.hexToString(c)}e.UInt128=o},function(t,e,r){function n(t){if(i(t)){var e,r={},s=Object.keys(t).sort();for(var o in s)e=s[o],Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=n(t[e]));return r}return Array.isArray(t)?t.map(n):t}function i(t){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString;if(!t||"[object Object]"!==r.call(t)||t.nodeType||t.setInterval)return!1;var n=e.call(t,"constructor"),i=e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;var s;for(s in t);return void 0===s||e.call(t,s)}var s=r(31).Crypt,o=r(14).Message,a=r(43),c=r(55),u=r(44),h=function(t){this.config=u(!0,{},t),this.config.data||(this.config.data={})};h.prototype.getStringToSign=function(t,e,r){var i=JSON.stringify(n(this.config.data)),o=[this.config.method||"GET",t.pathname||"",t.search||"","","",s.hashSha512(i).toLowerCase()].join("\n");return[r,e,s.hashSha512(o).toLowerCase()].join("\n")},h.prototype.signHmac=function(t,e){var r=u(!0,{},this.config),n=a.parse(r.url),i=f(),o="RIPPLE1-HMAC-SHA512",h=this.getStringToSign(n,i,o),l=s.signString(t,h),p=c.stringify({signature:s.base64ToBase64Url(l),signature_date:i,signature_blob_id:e,signature_type:o});return r.url+=(n.search?"&":"?")+p,r},h.prototype.signAsymmetric=function(t,e,r){var n=u(!0,{},this.config),i=a.parse(n.url),h=f(),l="RIPPLE1-ECDSA-SHA512",p=this.getStringToSign(i,h,l),_=o.signMessage(p,t),d=c.stringify({signature:s.base64ToBase64Url(_),signature_date:h,signature_blob_id:r,signature_account:e,signature_type:l});return n.url+=(i.search?"&":"?")+d,n},h.prototype.signAsymmetricRecovery=function(t,e){var r=u(!0,{},this.config),n=a.parse(r.url),i=f(),h="RIPPLE1-ECDSA-SHA512",l=this.getStringToSign(n,i,h),p=o.signMessage(l,t),_=c.stringify({signature:s.base64ToBase64Url(p),signature_date:i,signature_username:e,signature_type:h});return r.url+=(n.search?"&":"?")+_,r};var f=function(){function t(t){return(0>t||t>9?"":"0")+t}return function(){var e=new Date;return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+".000Z"}}();e.SignedRequest=h},function(t,e,r){var n=r(66).sjcl,i=function(){var t={ripple:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz",bitcoin:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"},e=function(t){return n.codec.bytes.fromBits(n.hash.sha256.hash(n.codec.bytes.toBits(t)))};return{encode_base:function(e,r){for(var i=t[r||"ripple"],s=new n.bn(i.length),o=n.bn.fromBits(n.codec.bytes.toBits(e)),a=[];o.greaterEquals(s);){var c=o.mod(s);a.push(i[c.limbs[0]]),o=o.div(s)}a.push(i[o.limbs[0]]);for(var u=0;u!=e.length&&!e[u];u+=1)a.push(i[0]);return a.reverse().join("")},decode_base:function(e,r){for(var i,s=t[r||"ripple"],o=new n.bn(s.length),a=new n.bn(0);i!=e.length&&e[i]===s[0];)i+=1;for(i=0;i!=e.length;i+=1){var c=s.indexOf(e[i]);if(0>c)return null;a=a.mul(o).addM(c)}for(var u=n.codec.bytes.fromBits(a.toBits()).reverse();0===u[u.length-1];)u.pop();for(i=0;e[i]===s[0];i++)u.push(0);return u.reverse(),u},encode_base_check:function(t,r,n){var s=[].concat(t,r),o=e(e(s)).slice(0,4);return i.encode_base([].concat(s,o),n)},decode_base_check:function(t,r,n){var s=i.decode_base(r,n);if(!s||s[0]!==t||s.length<5)return 0/0;var o,a=e(e(s.slice(0,-4))).slice(0,4),c=s.slice(-4);for(o=0;4!=o;o+=1)if(a[o]!==c[o])return 0/0;return s.slice(1,-4)}}}();t.exports=i},function(t,e,r){function n(t){this.value=t}var i=r(66).sjcl,s=r(48);n.fromBytes=function(t){return new n(s.encode_base_check(33,t))},n.getRandom=function(){for(var t=0;8>t;t++)i.random.addEntropy(Math.random(),32,"Math.random()");var e=i.codec.bytes.fromBits(i.random.randomWords(4));return n.fromBytes(e)},t.exports=n},function(t,e,r){function n(t){return s.hash.ripemd160.hash(s.hash.sha256.hash(t))}function i(t){this.value=t}var s=r(66).sjcl,o=r(48);i.fromPublicKey=function(t){var e=s.codec.bytes.fromBits(n(s.codec.bytes.toBits(t.toBytesCompressed())));return new this(o.encode_base_check(0,e))},t.exports=i},function(t,e,r){function n(t){if(!(t instanceof i.ecc.point))throw new Error("eccPoint must be a sjcl.ecc.point");this.value=t}var i=r(66).sjcl;n.fromPrivateGenerator=function(t){return new this(i.ecc.curves.c256.G.mult(t))},n.prototype={toString:function(){return this.value.toString()}},t.exports=n},function(t){!function(){function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function r(){return 1}function n(t){return this instanceof n?("number"==typeof t&&(t={max:t}),t||(t={}),this._max=t.max,(!this._max||"number"!=typeof this._max||this._max<=0)&&(this._max=1/0),this._lengthCalculator=t.length||r,"function"!=typeof this._lengthCalculator&&(this._lengthCalculator=r),this._allowStale=t.stale||!1,this._maxAge=t.maxAge||null,this._dispose=t.dispose,void this.reset()):new n(t)}function i(t,e,r){var n=t._cache[e];return n&&(t._maxAge&&Date.now()-n.now>t._maxAge?(c(t,n),t._allowStale||(n=void 0)):r&&s(t,n),n&&(n=n.value)),n}function s(t,e){a(t,e),e.lu=t._mru++,t._lruList[e.lu]=e}function o(t){for(;t._lru<t._mru&&t._length>t._max;)c(t,t._lruList[t._lru])}function a(t,e){for(delete t._lruList[e.lu];t._lru<t._mru&&!t._lruList[t._lru];)t._lru++}function c(t,e){e&&(t._dispose&&t._dispose(e.key,e.value),t._length-=e.length,t._itemCount--,delete t._cache[e.key],a(t,e))}function u(t,e,r,n,i){this.key=t,this.value=e,this.lu=r,this.length=n,this.now=i}"object"==typeof t&&t.exports?t.exports=n:this.LRUCache=n,Object.defineProperty(n.prototype,"max",{set:function(t){(!t||"number"!=typeof t||0>=t)&&(t=1/0),this._max=t,this._length>this._max&&o(this)},get:function(){return this._max},enumerable:!0}),Object.defineProperty(n.prototype,"lengthCalculator",{set:function(t){if("function"!=typeof t){this._lengthCalculator=r,this._length=this._itemCount;for(var e in this._cache)this._cache[e].length=1}else{this._lengthCalculator=t,this._length=0;for(var e in this._cache)this._cache[e].length=this._lengthCalculator(this._cache[e].value),this._length+=this._cache[e].length}this._length>this._max&&o(this)},get:function(){return this._lengthCalculator},enumerable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._length},enumerable:!0}),Object.defineProperty(n.prototype,"itemCount",{get:function(){return this._itemCount},enumerable:!0}),n.prototype.forEach=function(t,e){e=e||this;for(var r=0,n=this._mru-1;n>=0&&r<this._itemCount;n--)if(this._lruList[n]){r++;var i=this._lruList[n];this._maxAge&&Date.now()-i.now>this._maxAge&&(c(this,i),this._allowStale||(i=void 0)),i&&t.call(e,i.value,i.key,this)}},n.prototype.keys=function(){for(var t=new Array(this._itemCount),e=0,r=this._mru-1;r>=0&&e<this._itemCount;r--)if(this._lruList[r]){var n=this._lruList[r];t[e++]=n.key}return t},n.prototype.values=function(){for(var t=new Array(this._itemCount),e=0,r=this._mru-1;r>=0&&e<this._itemCount;r--)if(this._lruList[r]){var n=this._lruList[r];t[e++]=n.value}return t},n.prototype.reset=function(){if(this._dispose&&this._cache)for(var t in this._cache)this._dispose(t,this._cache[t].value);this._cache=Object.create(null),this._lruList=Object.create(null),this._mru=0,this._lru=0,this._length=0,this._itemCount=0},n.prototype.dump=function(){return this._cache},n.prototype.dumpLru=function(){return this._lruList},n.prototype.set=function(t,r){if(e(this._cache,t))return this._dispose&&this._dispose(t,this._cache[t].value),this._maxAge&&(this._cache[t].now=Date.now()),this._cache[t].value=r,this.get(t),!0;var n=this._lengthCalculator(r),i=this._maxAge?Date.now():0,s=new u(t,r,this._mru++,n,i);return s.length>this._max?(this._dispose&&this._dispose(t,r),!1):(this._length+=s.length,this._lruList[s.lu]=this._cache[t]=s,this._itemCount++,this._length>this._max&&o(this),!0)},n.prototype.has=function(t){if(!e(this._cache,t))return!1;var r=this._cache[t];return this._maxAge&&Date.now()-r.now>this._maxAge?!1:!0},n.prototype.get=function(t){return i(this,t,!0)},n.prototype.peek=function(t){return i(this,t,!1)},n.prototype.pop=function(){var t=this._lruList[this._lru];return c(this,t),t||null},n.prototype.del=function(t){c(this,this._cache[t])}}()},function(t,e,r){var n,i;(function(e){/*!
	 * async
	 * https://github.com/caolan/async
	 *
	 * Copyright 2010-2014 Caolan McMahon
	 * Released under the MIT license
	 */
!function(){function r(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(s,arguments)}}var s,o,a={};s=this,null!=s&&(o=s.async),a.noConflict=function(){return s.async=o,a};var c=Object.prototype.toString,u=Array.isArray||function(t){return"[object Array]"===c.call(t)},h=function(t,e){if(t.forEach)return t.forEach(e);for(var r=0;r<t.length;r+=1)e(t[r],r,t)},f=function(t,e){if(t.map)return t.map(e);var r=[];return h(t,function(t,n,i){r.push(e(t,n,i))}),r},l=function(t,e,r){return t.reduce?t.reduce(e,r):(h(t,function(t,n,i){r=e(r,t,n,i)}),r)},p=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};"undefined"!=typeof e&&e.nextTick?(a.nextTick=e.nextTick,a.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:a.nextTick):"function"==typeof setImmediate?(a.nextTick=function(t){setImmediate(t)},a.setImmediate=a.nextTick):(a.nextTick=function(t){setTimeout(t,0)},a.setImmediate=a.nextTick),a.each=function(t,e,n){function i(e){e?(n(e),n=function(){}):(s+=1,s>=t.length&&n())}if(n=n||function(){},!t.length)return n();var s=0;h(t,function(t){e(t,r(i))})},a.forEach=a.each,a.eachSeries=function(t,e,r){if(r=r||function(){},!t.length)return r();var n=0,i=function(){e(t[n],function(e){e?(r(e),r=function(){}):(n+=1,n>=t.length?r():i())})};i()},a.forEachSeries=a.eachSeries,a.eachLimit=function(t,e,r,n){var i=_(e);i.apply(null,[t,r,n])},a.forEachLimit=a.eachLimit;var _=function(t){return function(e,r,n){if(n=n||function(){},!e.length||0>=t)return n();var i=0,s=0,o=0;!function a(){if(i>=e.length)return n();for(;t>o&&s<e.length;)s+=1,o+=1,r(e[s-1],function(t){t?(n(t),n=function(){}):(i+=1,o-=1,i>=e.length?n():a())})}()}},d=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.each].concat(e))}},y=function(t,e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[_(t)].concat(r))}},m=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a.eachSeries].concat(e))}},v=function(t,e,r,n){if(e=f(e,function(t,e){return{index:e,value:t}}),n){var i=[];t(e,function(t,e){r(t.value,function(r,n){i[t.index]=n,e(r)})},function(t){n(t,i)})}else t(e,function(t,e){r(t.value,function(t){e(t)})})};a.map=d(v),a.mapSeries=m(v),a.mapLimit=function(t,e,r,n){return g(e)(t,r,n)};var g=function(t){return y(t,v)};a.reduce=function(t,e,r,n){a.eachSeries(t,function(t,n){r(e,t,function(t,r){e=r,n(t)})},function(t){n(t,e)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(t,e,r,n){var i=f(t,function(t){return t}).reverse();a.reduce(i,e,r,n)},a.foldr=a.reduceRight;var b=function(t,e,r,n){var i=[];e=f(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){r(t.value,function(r){r&&i.push(t),e()})},function(){n(f(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.filter=d(b),a.filterSeries=m(b),a.select=a.filter,a.selectSeries=a.filterSeries;var w=function(t,e,r,n){var i=[];e=f(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){r(t.value,function(r){r||i.push(t),e()})},function(){n(f(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};a.reject=d(w),a.rejectSeries=m(w);var E=function(t,e,r,n){t(e,function(t,e){r(t,function(r){r?(n(t),n=function(){}):e()})},function(){n()})};a.detect=d(E),a.detectSeries=m(E),a.some=function(t,e,r){a.each(t,function(t,n){e(t,function(t){t&&(r(!0),r=function(){}),n()})},function(){r(!1)})},a.any=a.some,a.every=function(t,e,r){a.each(t,function(t,n){e(t,function(t){t||(r(!1),r=function(){}),n()})},function(){r(!0)})},a.all=a.every,a.sortBy=function(t,e,r){a.map(t,function(t,r){e(t,function(e,n){e?r(e):r(null,{value:t,criteria:n})})},function(t,e){if(t)return r(t);var n=function(t,e){var r=t.criteria,n=e.criteria;return n>r?-1:r>n?1:0};r(null,f(e.sort(n),function(t){return t.value}))})},a.auto=function(t,e){e=e||function(){};var r=p(t),n=r.length;if(!n)return e();var i={},s=[],o=function(t){s.unshift(t)},c=function(t){for(var e=0;e<s.length;e+=1)if(s[e]===t)return void s.splice(e,1)},f=function(){n--,h(s.slice(0),function(t){t()})};o(function(){if(!n){var t=e;e=function(){},t(null,i)}}),h(r,function(r){var n=u(t[r])?t[r]:[t[r]],s=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),t){var s={};h(p(i),function(t){s[t]=i[t]}),s[r]=n,e(t,s),e=function(){}}else i[r]=n,a.setImmediate(f)},_=n.slice(0,Math.abs(n.length-1))||[],d=function(){return l(_,function(t,e){return t&&i.hasOwnProperty(e)},!0)&&!i.hasOwnProperty(r)};if(d())n[n.length-1](s,i);else{var y=function(){d()&&(c(y),n[n.length-1](s,i))};o(y)}})},a.retry=function(t,e,r){var n=5,i=[];"function"==typeof t&&(r=e,e=t,t=n),t=parseInt(t,10)||n;var s=function(n,s){for(var o=function(t,e){return function(r){t(function(t,n){r(!t||e,{err:t,result:n})},s)}};t;)i.push(o(e,!(t-=1)));a.series(i,function(t,e){e=e[e.length-1],(n||r)(e.err,e.result)})};return r?s():s},a.waterfall=function(t,e){if(e=e||function(){},!u(t)){var r=new Error("First argument to waterfall must be an array of functions");return e(r)}if(!t.length)return e();var n=function(t){return function(r){if(r)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),s=t.next();i.push(s?n(s):e),a.setImmediate(function(){t.apply(null,i)})}}};n(a.iterator(t))()};var x=function(t,e,r){if(r=r||function(){},u(e))t.map(e,function(t,e){t&&t(function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,t,r)})},r);else{var n={};t.each(p(e),function(t,r){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[t]=i,r(e)})},function(t){r(t,n)})}};a.parallel=function(t,e){x({map:a.map,each:a.each},t,e)},a.parallelLimit=function(t,e,r){x({map:g(e),each:_(e)},t,r)},a.series=function(t,e){if(e=e||function(){},u(t))a.mapSeries(t,function(t,e){t&&t(function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),e.call(null,t,r)})},e);else{var r={};a.eachSeries(p(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(t){e(t,r)})}},a.iterator=function(t){var e=function(r){var n=function(){return t.length&&t[r].apply(null,arguments),n.next()};return n.next=function(){return r<t.length-1?e(r+1):null},n};return e(0)},a.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var S=function(t,e,r,n){var i=[];t(e,function(t,e){r(t,function(t,r){i=i.concat(r||[]),e(t)})},function(t){n(t,i)})};a.concat=d(S),a.concatSeries=m(S),a.whilst=function(t,e,r){t()?e(function(n){return n?r(n):void a.whilst(t,e,r)}):r()},a.doWhilst=function(t,e,r){t(function(n){if(n)return r(n);var i=Array.prototype.slice.call(arguments,1);e.apply(null,i)?a.doWhilst(t,e,r):r()})},a.until=function(t,e,r){t()?r():e(function(n){return n?r(n):void a.until(t,e,r)})},a.doUntil=function(t,e,r){t(function(n){if(n)return r(n);var i=Array.prototype.slice.call(arguments,1);e.apply(null,i)?r():a.doUntil(t,e,r)})},a.queue=function(t,e){function n(t,e,r,n){return t.started||(t.started=!0),u(e)||(e=[e]),0==e.length?a.setImmediate(function(){t.drain&&t.drain()}):void h(e,function(e){var i={data:e,callback:"function"==typeof n?n:null};r?t.tasks.unshift(i):t.tasks.push(i),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),a.setImmediate(t.process)})}void 0===e&&(e=1);var i=0,s={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){n(s,t,!1,e)},kill:function(){s.drain=null,s.tasks=[]},unshift:function(t,e){n(s,t,!0,e)},process:function(){if(!s.paused&&i<s.concurrency&&s.tasks.length){var e=s.tasks.shift();s.empty&&0===s.tasks.length&&s.empty(),i+=1;var n=function(){i-=1,e.callback&&e.callback.apply(e,arguments),s.drain&&s.tasks.length+i===0&&s.drain(),s.process()},o=r(n);t(e.data,o)}},length:function(){return s.tasks.length},running:function(){return i},idle:function(){return s.tasks.length+i===0},pause:function(){s.paused!==!0&&(s.paused=!0,s.process())},resume:function(){s.paused!==!1&&(s.paused=!1,s.process())}};return s},a.cargo=function(t,e){var r=!1,n=[],i={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,r){u(t)||(t=[t]),h(t,function(t){n.push({data:t,callback:"function"==typeof r?r:null}),i.drained=!1,i.saturated&&n.length===e&&i.saturated()}),a.setImmediate(i.process)},process:function s(){if(!r){if(0===n.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var o="number"==typeof e?n.splice(0,e):n.splice(0,n.length),a=f(o,function(t){return t.data});i.empty&&i.empty(),r=!0,t(a,function(){r=!1;var t=arguments;h(o,function(e){e.callback&&e.callback.apply(null,t)}),s()})}},length:function(){return n.length},running:function(){return r}};return i};var A=function(t){return function(e){var r=Array.prototype.slice.call(arguments,1);e.apply(null,r.concat([function(e){var r=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&h(r,function(e){console[t](e)}))}]))}};a.log=A("log"),a.dir=A("dir"),a.memoize=function(t,e){var r={},n={};e=e||function(t){return t};var i=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),o=e.apply(null,i);o in r?a.nextTick(function(){s.apply(null,r[o])}):o in n?n[o].push(s):(n[o]=[s],t.apply(null,i.concat([function(){r[o]=arguments;var t=n[o];delete n[o];for(var e=0,i=t.length;i>e;e++)t[e].apply(null,arguments)}])))};return i.memo=r,i.unmemoized=t,i},a.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},a.times=function(t,e,r){for(var n=[],i=0;t>i;i++)n.push(i);return a.map(n,e,r)},a.timesSeries=function(t,e,r){for(var n=[],i=0;t>i;i++)n.push(i);return a.mapSeries(n,e,r)},a.seq=function(){var t=arguments;return function(){var e=this,r=Array.prototype.slice.call(arguments),n=r.pop();a.reduce(t,r,function(t,r,n){r.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))},function(t,r){n.apply(e,[t].concat(r))})}},a.compose=function(){return a.seq.apply(null,Array.prototype.reverse.call(arguments))};var T=function(t,e){var r=function(){var r=this,n=Array.prototype.slice.call(arguments),i=n.pop();return t(e,function(t,e){t.apply(r,n.concat([e]))},i)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return r.apply(this,n)}return r};a.applyEach=d(T),a.applyEachSeries=m(T),a.forever=function(t,e){function r(n){if(n){if(e)return e(n);throw n}t(r)}r()},"undefined"!=typeof t&&t.exports?t.exports=a:(n=[],i=function(){return a}.apply(null,n),!(void 0!==i&&(t.exports=i)))}()}).call(e,r(61))},function(t,e,r){function n(){}function i(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function s(){if(m.XMLHttpRequest&&("file:"!=m.location.protocol||!m.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function o(t){return t===Object(t)}function a(t){if(!o(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function c(t){for(var e,r,n={},i=t.split("&"),s=0,o=i.length;o>s;++s)r=i[s],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function u(t){var e,r,n,i,s=t.split(/\r?\n/),o={};s.pop();for(var a=0,c=s.length;c>a;++a)r=s[a],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),i=v(r.slice(e+1)),o[n]=i;return o}function h(t){return t.split(/ *; */).shift()}function f(t){return y(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(t[n]=i),t},{})}function l(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text=this.xhr.responseText,this.setStatusProperties(this.xhr.status),this.header=this.headers=u(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function p(t,e){var r=this;d.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var e=new l(r);"HEAD"==t&&(e.text=null),r.callback(null,e)})}function _(t,e){return"function"==typeof e?new p("GET",t).end(e):1==arguments.length?new p("GET",t):new p(t,e)}var d=r(72),y=r(73),m="undefined"==typeof window?this:window,v="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=a,_.parseString=c,_.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":a,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":c,"application/json":JSON.parse},l.prototype.get=function(t){return this.header[t.toLowerCase()]},l.prototype.setHeaderProperties=function(){var t=this.header["content-type"]||"";this.type=h(t);var e=f(t);for(var r in e)this[r]=e[r]},l.prototype.parseBody=function(t){var e=_.parse[this.type];return e?e(t):null},l.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},l.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",i=new Error(n);return i.status=this.status,i.method=e,i.url=r,i},_.Response=l,d(p.prototype),p.prototype.use=function(t){return t(this),this},p.prototype.timeout=function(t){return this._timeout=t,this},p.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},p.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},p.prototype.set=function(t,e){if(o(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},p.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},p.prototype.type=function(t){return this.set("Content-Type",_.types[t]||t),this},p.prototype.accept=function(t){return this.set("Accept",_.types[t]||t),this},p.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},p.prototype.query=function(t){return"string"!=typeof t&&(t=a(t)),t&&this._query.push(t),this},p.prototype.field=function(t,e){return this._formData||(this._formData=new FormData),this._formData.append(t,e),this},p.prototype.attach=function(t,e,r){return this._formData||(this._formData=new FormData),this._formData.append(t,e,r),this},p.prototype.send=function(t){var e=o(t),r=this.getHeader("Content-Type");if(e&&o(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},p.prototype.callback=function(t,e){var r=this._callback;return 2==r.length?r(t,e):t?this.emit("error",t):void r(e)},p.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},p.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype.withCredentials=function(){return this._withCredentials=!0,this},p.prototype.end=function(t){var e=this,r=this.xhr=s(),o=this._query.join("&"),a=this._timeout,c=this._formData||this._data;if(this._callback=t||n,r.onreadystatechange=function(){return 4==r.readyState?0==r.status?e.aborted?e.timeoutError():e.crossDomainError():void e.emit("end"):void 0},r.upload&&(r.upload.onprogress=function(t){t.percent=t.loaded/t.total*100,e.emit("progress",t)}),a&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},a)),o&&(o=_.serializeObject(o),this.url+=~this.url.indexOf("?")?"&"+o:"?"+o),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof c&&!i(c)){var u=_.serialize[this.getHeader("Content-Type")];u&&(c=u(c))}for(var h in this.header)null!=this.header[h]&&r.setRequestHeader(h,this.header[h]);return this.emit("request",this),r.send(c),this},_.Request=p,_.get=function(t,e,r){var n=_("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},_.head=function(t,e,r){var n=_("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},_.del=function(t,e){var r=_("DELETE",t);return e&&r.end(e),r},_.patch=function(t,e,r){var n=_("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},_.post=function(t,e,r){var n=_("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},_.put=function(t,e,r){var n=_("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},t.exports=_},function(t,e,r){"use strict";e.decode=e.parse=r(62),e.encode=e.stringify=r(63)},function(t,e,r){(function(e){!function(){var r,n,i=this;r=function(t){for(var r,r,n=new e(t),i=0;t>i;i++)0==(3&i)&&(r=4294967296*Math.random()),n[i]=r>>>((3&i)<<3)&255;return n},i.crypto&&crypto.getRandomValues&&(n=function(t){var r=new e(t);return crypto.getRandomValues(r),r}),t.exports=n||r}()}).call(e,r(41).Buffer)},function(t,e,r){(function(e){function n(t){return function(){var r=[],n={update:function(t,n){return e.isBuffer(t)||(t=new e(t,n)),r.push(t),this},digest:function(n){var i=e.concat(r),s=t(i);return r=null,n?s.toString(n):s}};return n}}var i=r(74),s=n(r(65)),o=n(r(90));t.exports=function(t){return"md5"===t?new s:"rmd160"===t?new o:i(t)}}).call(e,r(41).Buffer)},function(t,e,r){(function(e){function n(t,r){if(!(this instanceof n))return new n(t,r);this._opad=c,this._alg=t,r=this._key=e.isBuffer(r)?r:new e(r),r.length>s?r=i(t).update(r).digest():r.length<s&&(r=e.concat([r,o],s));for(var a=this._ipad=new e(s),c=this._opad=new e(s),u=0;s>u;u++)a[u]=54^r[u],c[u]=92^r[u];this._hash=i(t).update(a)}var i=r(57),s=64,o=new e(s);o.fill(0),t.exports=n,n.prototype.update=function(t,e){return this._hash.update(t,e),this},n.prototype.digest=function(t){var e=this._hash.digest();return i(this._alg).update(this._opad).update(e).digest(t)}}).call(e,r(41).Buffer)},function(t,e,r){(function(e){var r=64,n=new e(r);n.fill(0),t.exports=function(t,i){return i=i||{},i.pbkdf2=function(t,e,r,n,s){if("function"!=typeof s)throw new Error("No callback provided to pbkdf2");setTimeout(function(){s(null,i.pbkdf2Sync(t,e,r,n))})},i.pbkdf2Sync=function(i,s,o,a){if("number"!=typeof o)throw new TypeError("Iterations not a number");if(0>o)throw new TypeError("Bad iterations");if("number"!=typeof a)throw new TypeError("Key length not a number");if(0>a)throw new TypeError("Bad key length");var i=e.isBuffer(i)?i:new e(i);i.length>r?i=createHash(alg).update(i).digest():i.length<r&&(i=e.concat([i,n],r));var c,u,h,f=0,l=1,p=new e(4),_=new e(a);for(_.fill(0);a;){u=a>20?20:a,p[0]=l>>24&255,p[1]=l>>16&255,p[2]=l>>8&255,p[3]=255&l,c=t("sha1",i),c.update(s),c.update(p),h=c.digest(),h.copy(_,f,0,u);for(var d=1;o>d;d++){c=t("sha1",i),c.update(h),h=c.digest();for(var y=0;u>y;y++)_[y]^=h[y]}a-=u,l++,f+=u}return _},i}}).call(e,r(41).Buffer)},function(t){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t){function e(){}var r=t.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var r=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=e,r.once=e,r.off=e,r.emit=e,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,i,s){n=n||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(n);var c=1e3;s&&"number"==typeof s.maxKeys&&(c=s.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var h=0;u>h;++h){var f,l,p,_,d=t[h].replace(a,"%20"),y=d.indexOf(i);y>=0?(f=d.substr(0,y),l=d.substr(y+1)):(f=d,l=""),p=decodeURIComponent(f),_=decodeURIComponent(l),e(o,p)?r(o[p])?o[p].push(_):o[p]=[o[p],_]:o[p]=_}return o};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t){"use strict";function e(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,s,o,a){return s=s||"&",o=o||"=",null===t&&(t=void 0),"object"==typeof t?e(i(t),function(i){var a=encodeURIComponent(r(i))+o;return n(t[i])?e(t[i],function(t){return a+encodeURIComponent(r(t))}).join(s):a+encodeURIComponent(r(t[i]))}).join(s):a?encodeURIComponent(r(a))+o+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t,e){e.read=function(t,e,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,u=c>>1,h=-7,f=r?i-1:0,l=r?-1:1,p=t[e+f];for(f+=l,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+t[e+f],f+=l,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+t[e+f],f+=l,h-=8);if(0===s)s=1-u;else{if(s===c)return o?0/0:1/0*(p?-1:1);o+=Math.pow(2,n),s-=u}return(p?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,r,n,i,s){var o,a,c,u=8*s-i-1,h=(1<<u)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,_=n?1:-1,d=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),e+=o+f>=1?l/c:l*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=h?(a=0,o=h):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=255&a,p+=_,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+p]=255&o,p+=_,o/=256,u-=8);t[r+p-_]|=128*d}},function(t,e,r){function n(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var r=1732584193,n=-271733879,i=-1732584194,h=271733878,f=0;f<t.length;f+=16){var l=r,p=n,_=i,d=h;r=s(r,n,i,h,t[f+0],7,-680876936),h=s(h,r,n,i,t[f+1],12,-389564586),i=s(i,h,r,n,t[f+2],17,606105819),n=s(n,i,h,r,t[f+3],22,-1044525330),r=s(r,n,i,h,t[f+4],7,-176418897),h=s(h,r,n,i,t[f+5],12,1200080426),i=s(i,h,r,n,t[f+6],17,-1473231341),n=s(n,i,h,r,t[f+7],22,-45705983),r=s(r,n,i,h,t[f+8],7,1770035416),h=s(h,r,n,i,t[f+9],12,-1958414417),i=s(i,h,r,n,t[f+10],17,-42063),n=s(n,i,h,r,t[f+11],22,-1990404162),r=s(r,n,i,h,t[f+12],7,1804603682),h=s(h,r,n,i,t[f+13],12,-40341101),i=s(i,h,r,n,t[f+14],17,-1502002290),n=s(n,i,h,r,t[f+15],22,1236535329),r=o(r,n,i,h,t[f+1],5,-165796510),h=o(h,r,n,i,t[f+6],9,-1069501632),i=o(i,h,r,n,t[f+11],14,643717713),n=o(n,i,h,r,t[f+0],20,-373897302),r=o(r,n,i,h,t[f+5],5,-701558691),h=o(h,r,n,i,t[f+10],9,38016083),i=o(i,h,r,n,t[f+15],14,-660478335),n=o(n,i,h,r,t[f+4],20,-405537848),r=o(r,n,i,h,t[f+9],5,568446438),h=o(h,r,n,i,t[f+14],9,-1019803690),i=o(i,h,r,n,t[f+3],14,-187363961),n=o(n,i,h,r,t[f+8],20,1163531501),r=o(r,n,i,h,t[f+13],5,-1444681467),h=o(h,r,n,i,t[f+2],9,-51403784),i=o(i,h,r,n,t[f+7],14,1735328473),n=o(n,i,h,r,t[f+12],20,-1926607734),r=a(r,n,i,h,t[f+5],4,-378558),h=a(h,r,n,i,t[f+8],11,-2022574463),i=a(i,h,r,n,t[f+11],16,1839030562),n=a(n,i,h,r,t[f+14],23,-35309556),r=a(r,n,i,h,t[f+1],4,-1530992060),h=a(h,r,n,i,t[f+4],11,1272893353),i=a(i,h,r,n,t[f+7],16,-155497632),n=a(n,i,h,r,t[f+10],23,-1094730640),r=a(r,n,i,h,t[f+13],4,681279174),h=a(h,r,n,i,t[f+0],11,-358537222),i=a(i,h,r,n,t[f+3],16,-722521979),n=a(n,i,h,r,t[f+6],23,76029189),r=a(r,n,i,h,t[f+9],4,-640364487),h=a(h,r,n,i,t[f+12],11,-421815835),i=a(i,h,r,n,t[f+15],16,530742520),n=a(n,i,h,r,t[f+2],23,-995338651),r=c(r,n,i,h,t[f+0],6,-198630844),h=c(h,r,n,i,t[f+7],10,1126891415),i=c(i,h,r,n,t[f+14],15,-1416354905),n=c(n,i,h,r,t[f+5],21,-57434055),r=c(r,n,i,h,t[f+12],6,1700485571),h=c(h,r,n,i,t[f+3],10,-1894986606),i=c(i,h,r,n,t[f+10],15,-1051523),n=c(n,i,h,r,t[f+1],21,-2054922799),r=c(r,n,i,h,t[f+8],6,1873313359),h=c(h,r,n,i,t[f+15],10,-30611744),i=c(i,h,r,n,t[f+6],15,-1560198380),n=c(n,i,h,r,t[f+13],21,1309151649),r=c(r,n,i,h,t[f+4],6,-145523070),h=c(h,r,n,i,t[f+11],10,-1120210379),i=c(i,h,r,n,t[f+2],15,718787259),n=c(n,i,h,r,t[f+9],21,-343485551),r=u(r,l),n=u(n,p),i=u(i,_),h=u(h,d)}return Array(r,n,i,h)}function i(t,e,r,n,i,s){return u(h(u(u(e,t),u(n,s)),i),r)}function s(t,e,r,n,s,o,a){return i(e&r|~e&n,t,e,s,o,a)}function o(t,e,r,n,s,o,a){return i(e&n|r&~n,t,e,s,o,a)}function a(t,e,r,n,s,o,a){return i(e^r^n,t,e,s,o,a)}function c(t,e,r,n,s,o,a){return i(r^(e|~n),t,e,s,o,a)}function u(t,e){var r=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(r>>16);return n<<16|65535&r}function h(t,e){return t<<e|t>>>32-e}var f=r(75);t.exports=function(t){return f.hash(t,n,16)}},function(t,e,r){function n(t){var r=e[t];Object.keys(r.prototype).forEach(function(t){var e=/([A-Z]{1})[a-z]+/g;if(e.test(t)){var n=t.replace(e,function(t){return"_"+t.toLowerCase()});r.prototype[n]=r.prototype[t]}})}e.Remote=r(76).Remote,e.Request=r(77).Request,e.Amount=r(78).Amount,e.Account=r(79).Account,e.Transaction=r(80).Transaction,e.Currency=r(81).Currency,e.Base=r(82).Base,e.UInt160=r(78).UInt160,e.Seed=r(78).Seed,e.Meta=r(83).Meta,e.SerializedObject=r(84).SerializedObject,e.RippleError=r(85).RippleError,e.binformat=r(86),e.utils=r(87),e.Server=r(88).Server,e.sjcl=r(87).sjcl,e.config=r(89),["Remote","Request","Transaction","Account","Server"].forEach(n)},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){(function(t,n){function i(t,r){var n={seen:[],stylize:o};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(r)?n.showHidden=r:r&&e._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,t,n.depth)}function s(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function o(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function c(t,r,n){if(t.customInspect&&r&&T(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return g(i)||(i=c(t,i,n)),i}var s=u(t,r);if(s)return s;var o=Object.keys(r),d=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(r)),A(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(r);if(0===o.length){if(T(r)){var y=r.name?": "+r.name:"";return t.stylize("[Function"+y+"]","special")}if(E(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(A(r))return h(r)}var m="",v=!1,b=["{","}"];if(_(r)&&(v=!0,b=["[","]"]),T(r)){var w=r.name?": "+r.name:"";m=" [Function"+w+"]"}if(E(r)&&(m=" "+RegExp.prototype.toString.call(r)),S(r)&&(m=" "+Date.prototype.toUTCString.call(r)),A(r)&&(m=" "+h(r)),0===o.length&&(!v||0==r.length))return b[0]+m+b[1];if(0>n)return E(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var x;return x=v?f(t,r,n,d,o):o.map(function(e){return l(t,r,n,d,e,v)}),t.seen.pop(),p(x,m,b)}function u(t,e){if(w(e))return t.stylize("undefined","undefined");if(g(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,r,n,i){for(var s=[],o=0,a=e.length;a>o;++o)s.push(I(e,String(o))?l(t,e,r,n,String(o),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||s.push(l(t,e,r,n,i,!0))}),s}function l(t,e,r,n,i,s){var o,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),I(n,i)||(o="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(r)?c(t,u.value,null):c(t,u.value,r-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function p(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function _(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return null==t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function w(t){return void 0===t}function E(t){return x(t)&&"[object RegExp]"===j(t)}function x(t){return"object"==typeof t&&null!==t}function S(t){return x(t)&&"[object Date]"===j(t)}function A(t){return x(t)&&("[object Error]"===j(t)||t instanceof Error)}function T(t){return"function"==typeof t}function k(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function j(t){return Object.prototype.toString.call(t)}function B(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[B(t.getHours()),B(t.getMinutes()),B(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var q=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,s=n.length,o=String(t).replace(q,function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return t}}),a=n[r];s>r;a=n[++r])o+=y(a)||!x(a)?" "+a:" "+i(a);return o},e.deprecate=function(r,i){function s(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return r.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(n.noDeprecation===!0)return r;var o=!1;return s};var C,D={};e.debuglog=function(t){if(w(C)&&(C=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(C)){var r=n.pid;
D[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else D[t]=function(){};return D[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=_,e.isBoolean=d,e.isNull=y,e.isNullOrUndefined=m,e.isNumber=v,e.isString=g,e.isSymbol=b,e.isUndefined=w,e.isRegExp=E,e.isObject=x,e.isDate=S,e.isError=A,e.isFunction=T,e.isPrimitive=k,e.isBuffer=r(91);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=r(107),e._extend=function(t,e){if(!e||!x(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(e,function(){return this}(),r(61))},function(t,e,r){var n;n=function(t,e,r,n){"use strict";var i=e;i.unescape=decodeURIComponent,i.escape=encodeURIComponent;var s=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};i.stringify=i.encode=function(t,e,r,o){switch(e=e||"&",r=r||"=",t=null===t?n:t,typeof t){case"object":return Object.keys(t).map(function(n){return Array.isArray(t[n])?t[n].map(function(t){return i.escape(s(n))+r+i.escape(s(t))}).join(e):i.escape(s(n))+r+i.escape(s(t[n]))}).join(e);default:return o?i.escape(s(o))+r+i.escape(s(t)):""}},i.parse=i.decode=function(t,e,r){e=e||"&",r=r||"=";var n={};return"string"!=typeof t||0===t.length?n:(t.split(e).forEach(function(t){var e=t.split(r),s=i.unescape(e[0],!0),o=i.unescape(e.slice(1).join(r),!0);s in n?Array.isArray(n[s])?n[s].push(o):n[s]=[n[s],o]:n[s]=o}),n)}}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n,i;(function(t){!function(s){function o(t){throw RangeError(C[t])}function a(t,e){for(var r=t.length;r--;)t[r]=e(t[r]);return t}function c(t,e){var r=".";return a(t.split(r),e).join(r)}function u(t){for(var e,r,n=[],i=0,s=t.length;s>i;)e=t.charCodeAt(i++),55296==(63488&e)&&(r=t.charCodeAt(i++),(55296!=(64512&e)||56320!=(64512&r))&&o("ucs2decode"),e=((1023&e)<<10)+(1023&r)+65536),n.push(e);return n}function h(t){return a(t,function(t){var e="";return 55296==(63488&t)&&o("ucs2encode"),t>65535&&(t-=65536,e+=L(t>>>10&1023|55296),t=56320|1023&t),e+=L(t)}).join("")}function f(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:x}function l(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function p(t,e,r){var n=0;for(t=r?O(t/k):t>>1,t+=O(t/e);t>D*A>>1;n+=x)t=O(t/D);return O(n+(D+1)*t/(t+T))}function _(t){var e,r,n,i,s,a,c,u,l,_,d=[],y=t.length,m=0,v=B,g=j;for(r=t.lastIndexOf(R),0>r&&(r=0),n=0;r>n;++n)t.charCodeAt(n)>=128&&o("not-basic"),d.push(t.charCodeAt(n));for(i=r>0?r+1:0;y>i;){for(s=m,a=1,c=x;i>=y&&o("invalid-input"),u=f(t.charCodeAt(i++)),(u>=x||u>O((E-m)/a))&&o("overflow"),m+=u*a,l=g>=c?S:c>=g+A?A:c-g,!(l>u);c+=x)_=x-l,a>O(E/_)&&o("overflow"),a*=_;e=d.length+1,g=p(m-s,e,0==s),O(m/e)>E-v&&o("overflow"),v+=O(m/e),m%=e,d.splice(m++,0,v)}return h(d)}function d(t){var e,r,n,i,s,a,c,h,f,_,d,y,m,v,g,b=[];for(t=u(t),y=t.length,e=B,r=0,s=j,a=0;y>a;++a)d=t[a],128>d&&b.push(L(d));for(n=i=b.length,i&&b.push(R);y>n;){for(c=E,a=0;y>a;++a)d=t[a],d>=e&&c>d&&(c=d);for(m=n+1,c-e>O((E-r)/m)&&o("overflow"),r+=(c-e)*m,e=c,a=0;y>a;++a)if(d=t[a],e>d&&++r>E&&o("overflow"),d==e){for(h=r,f=x;_=s>=f?S:f>=s+A?A:f-s,!(_>h);f+=x)g=h-_,v=x-_,b.push(L(l(_+g%v,0))),h=O(g/v);b.push(L(l(h,0))),s=p(r,m,n==i),r=0,++n}++r,++e}return b.join("")}function y(t){return c(t,function(t){return q.test(t)?_(t.slice(4).toLowerCase()):t})}function m(t){return c(t,function(t){return I.test(t)?"xn--"+d(t):t})}var v,g,b=(r(105),"object"==typeof e&&e),w="object"==typeof t&&t,E=2147483647,x=36,S=1,A=26,T=38,k=700,j=72,B=128,R="-",I=/[^ -~]/,q=/^xn--/,C={overflow:"Overflow: input needs wider integers to process.",ucs2decode:"UCS-2(decode): illegal sequence",ucs2encode:"UCS-2(encode): illegal value","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},D=x-S,O=Math.floor,L=String.fromCharCode;if(v={version:"1.0.0",ucs2:{decode:u,encode:h},decode:_,encode:d,toASCII:m,toUnicode:y},b)if(w&&w.exports==b)w.exports=v;else for(g in v)v.hasOwnProperty(g)&&(b[g]=v[g]);else r(105)?(n=v,!("function"==typeof n?(i=n.call(e,r,e,t),void 0!==i&&(t.exports=i)):t.exports=n)):s.punycode=v}(this)}).call(e,r(106)(t))},function(t,e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===o?62:e===a?63:c>e?-1:c+10>e?e-c+26+26:h+26>e?e-h:u+26>e?e-u+26:void 0}function n(t){function r(t){u[f++]=t}var n,i,o,a,c,u;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=t.length;c="="===t.charAt(h-2)?2:"="===t.charAt(h-1)?1:0,u=new s(3*t.length/4-c),o=c>0?t.length-4:t.length;var f=0;for(n=0,i=0;o>n;n+=4,i+=3)a=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===c?(a=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&a)):1===c&&(a=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(a>>8&255),r(255&a)),u}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,s,o,a=t.length%3,c="";for(i=0,o=t.length-a;o>i;i+=3)s=(t[i]<<16)+(t[i+1]<<8)+t[i+2],c+=n(s);switch(a){case 1:s=t[t.length-1],c+=e(s>>2),c+=e(s<<4&63),c+="==";break;case 2:s=(t[t.length-2]<<8)+t[t.length-1],c+=e(s>>10),c+=e(s>>4&63),c+=e(s<<2&63),c+="="}return c}var s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),a="/".charCodeAt(0),c="0".charCodeAt(0),u="a".charCodeAt(0),h="A".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}("undefined"==typeof e?this.base64js={}:e)},function(t){function e(t){return t?r(t):void 0}function r(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,i=r.length;i>n;++n)r[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t){t.exports=function(t,e,r){for(var n=0,i=t.length,s=3==arguments.length?r:t[n++];i>n;)s=e.call(null,s,t[n],++n,t);return s}},function(t,e,r){var e=t.exports=function(t){var r=e[t];if(!r)throw new Error(t+" is not supported (we accept pull requests)");return new r},n=r(41).Buffer,i=r(93)(n);e.sha=e.sha1=r(94)(n,i),e.sha256=r(95)(n,i)},function(t,e,r){(function(e){function r(t,r){if(t.length%s!==0){var n=t.length+(s-t.length%s);t=e.concat([t,o],n)}for(var i=[],a=r?t.readInt32BE:t.readInt32LE,c=0;c<t.length;c+=s)i.push(a.call(t,c));return i}function n(t,r,n){for(var i=new e(r),s=n?i.writeInt32BE:i.writeInt32LE,o=0;o<t.length;o++)s.call(i,t[o],4*o,!0);return i}function i(t,i,s,o){e.isBuffer(t)||(t=new e(t));var c=i(r(t,o),t.length*a);return n(c,s,o)}var s=4,o=new e(s);o.fill(0);var a=8;t.exports={hash:i}}).call(e,r(41).Buffer)},function(t,e,r){function n(t){function e(t){"transaction_all"===t&&(!s._transaction_subs&&s._connected&&s.request_subscribe("transactions").request(),s._transaction_subs+=1)}function r(t){"transaction_all"===t&&(s._transaction_subs-=1,!s._transaction_subs&&s._connected&&s.request_unsubscribe("transactions").request())}function n(){t.storage.loadAccounts(function(t,e){!t&&Array.isArray(e)&&e.forEach(s.account.bind(s))})}i.call(this);var s=this;this.trusted=Boolean(t.trusted),this.local_sequence=Boolean(t.local_sequence),this.local_fee="undefined"==typeof t.local_fee?!0:Boolean(t.local_fee),this.local_signing="undefined"==typeof t.local_signing?!0:Boolean(t.local_signing),this.fee_cushion="undefined"==typeof t.fee_cushion?1.2:Number(t.fee_cushion),this.max_fee="undefined"==typeof t.max_fee?1/0:Number(t.max_fee),this.id=0,this.trace=Boolean(t.trace),this._server_fatal=!1,this._ledger_current_index=void 0,this._ledger_hash=void 0,this._ledger_time=void 0,this._stand_alone=void 0,this._testnet=void 0,this._transaction_subs=0,this.online_target=!1,this._online_state="closed",this.state="offline",this.retry_timer=void 0,this.retry=void 0,this._connection_count=0,this._connected=!1,this._connection_offset=1e3*("number"==typeof t.connection_offset?t.connection_offset:5),this._submission_timeout=1e3*("number"==typeof t.submission_timeout?t.submission_timeout:10),this._received_tx={},this._cur_path_find=null,this.local_signing&&(this.local_sequence=!0,this.local_fee=!0),this._servers=[],this._primary_server=void 0,this.accounts={},this._accounts={},this._books={},this.secrets={},this.ledgers={current:{account_root:{}}},t.hasOwnProperty("servers")||(t.servers=[{host:t.websocket_ip,port:t.websocket_port,secure:t.websocket_ssl,trusted:t.trusted}]),t.servers.forEach(function(t){for(var e=Number(t.pool)||1;e--;)s.addServer(t)});var o=t.maxListeners||t.max_listeners||0;this._servers.concat(this).forEach(function(t){t.setMaxListeners(o)}),this.on("newListener",e),this.on("removeListener",r),t.storage&&(this.storage=t.storage,this.once("connect",n))}var i=r(37).EventEmitter,s=r(38),o=r(77).Request,a=r(88).Server,c=r(78).Amount,u=r(81).Currency,h=r(96).UInt160,f=r(80).Transaction,l=r(79).Account,p=r(83).Meta,_=r(97).OrderBook,d=r(98).PathFind,y=r(85).RippleError,m=r(87),v=r(87).sjcl,g=r(89);s.inherits(n,i),n.flags={account_root:{PasswordSpent:65536,RequireDestTag:131072,RequireAuth:262144,DisallowXRP:524288,DisableMaster:1048576},offer:{Passive:65536,Sell:131072},state:{LowReserve:65536,HighReserve:131072,LowAuth:262144,HighAuth:524288,LowNoRipple:1048576,HighNoRipple:2097152}},n.from_config=function(t,e){function r(t){var e=this.accounts[t];"object"==typeof e&&e.secret&&(s.setSecret(t,e.secret),s.setSecret(e.account,e.secret))}var i="string"==typeof t?g.servers[t]:t,s=new n(i,e);return Object.keys(g.accounts||{}).forEach(r,g),s},n.prototype.addServer=function(t){function e(t){i._handleMessage(t,s)}function r(){switch((t.primary||!i._primary_server)&&i._setPrimaryServer(s),++i._connection_count){case 1:i._setState("online");break;case i._servers.length:i.emit("ready")}}function n(){i._connection_count--,0===i._connection_count&&i._setState("offline")}var i=this,s=new a(this,{host:t.host||t.websocket_ip,port:t.port||t.websocket_port,secure:t.secure||t.websocket_ssl});return s.on("message",e),s.on("connect",r),s.on("disconnect",n),this._servers.push(s),this},n.prototype.serverFatal=function(){this._server_fatal=!0},n.prototype._setState=function(t){if(this.state!==t)switch(this._trace("remote: set_state:",t),this.state=t,this.emit("state",t),t){case"online":this._online_state="open",this._connected=!0,this.emit("connect"),this.emit("connected");break;case"offline":this._online_state="closed",this._connected=!1,this.emit("disconnect"),this.emit("disconnected")}},n.prototype.setTrace=function(t){return this.trace=void 0===t||t,this},n.prototype.setSecret=function(t,e){this.secrets[t]=e},n.prototype._trace=function(){this.trace&&m.logObject.apply(m,arguments)},n.prototype.connect=function(t){if(!this._servers.length)throw new Error("No servers available.");switch(typeof t){case"undefined":break;case"function":this.once("connect",t);break;default:if(!Boolean(t))return this.disconnect()}var e=this;return function r(t){var n=e._servers[t];n.connect(),n._sid=++t,t<e._servers.length&&setTimeout(function(){r(t)},e._connection_offset)}(0),this},n.prototype.disconnect=function(t){if(!this._servers.length)throw new Error("No servers available, not disconnecting");return"function"==typeof t&&this.once("disconnect",t),this._servers.forEach(function(t){t.disconnect()}),this._set_state("offline"),this},n.prototype._handleMessage=function(t,e){var r=this;try{t=JSON.parse(t)}catch(i){}if(!n.isValidMessage(t))return void this.emit("error",new y("remoteUnexpected","Unexpected response from remote"));switch(t.type){case"response":break;case"ledgerClosed":if(!n.isValidLedgerData(t))return;t.ledger_index>=this._ledger_current_index&&(this._ledger_time=t.ledger_time,this._ledger_hash=t.ledger_hash,this._ledger_current_index=t.ledger_index+1,this.emit("ledger_closed",t,e));break;case"serverStatus":r.emit("server_status",t);break;case"transaction":var s=t.transaction.hash;if(this._received_tx.hasOwnProperty(s))break;t.validated&&(this._received_tx[s]=!0),this._trace("remote: tx:",t),t.meta?(t.mmeta=new p(t.meta),t.mmeta.getAffectedAccounts().forEach(function(e){e=r._accounts[e],e&&e.notify(t)}),t.mmeta.getAffectedBooks().forEach(function(e){e=r._books[e],e&&e.notify(t)})):["Account","Destination"].forEach(function(e){var n=t.transaction[e];n&&(n=r.account(n))&&n.notify(t)}),this.emit("transaction",t),this.emit("transaction_all",t);break;case"path_find":this._cur_path_find&&this._cur_path_find.notify_update(t),this.emit("path_find_all",t);break;default:this._trace("remote: "+t.type+": ",t),this.emit("net_"+t.type,t)}},n.isValidMessage=function(t){return"object"==typeof t&&"string"==typeof t.type},n.isValidLedgerData=function(t){return"object"==typeof t&&"number"==typeof t.fee_base&&"number"==typeof t.fee_ref&&"number"==typeof t.fee_base&&"string"==typeof t.ledger_hash&&"number"==typeof t.ledger_index&&"number"==typeof t.ledger_time&&"number"==typeof t.reserve_base&&"number"==typeof t.reserve_inc&&"number"==typeof t.txn_count},n.isLoadStatus=function(t){return"number"==typeof t.load_base&&"number"==typeof t.load_factor},n.prototype.ledgerHash=function(){return this._ledger_hash},n.prototype._setPrimaryServer=function(t){this._primary_server&&(this._primary_server._primary=!1),this._primary_server=t,this._primary_server._primary=!0},n.prototype._serverIsAvailable=function(t){return t&&t._connected},n.prototype._nextServer=function(){for(var t=null,e=0,r=this._servers.length;r>e;e++){var n=this._servers[e];if(this._serverIsAvailable(n)){t=n;break}}return t},n.prototype._getServer=function(){var t;return this._serverIsAvailable(this._primary_server)?t=this._primary_server:(t=this._nextServer(),t&&this._setPrimaryServer(t)),t},n.prototype.request=function(t){if("string"==typeof t){if(/^request_/.test(t)||(t="request_"+t),"function"==typeof this[t]){var e=Array.prototype.slice.call(arguments,1);return this[t].apply(this,e)}throw new Error("Command does not exist: "+t)}if(!(t instanceof o))throw new Error("Argument is not a Request");if(this._servers.length)if(this._connected)if(null===t.server)t.emit("error",new Error("Server does not exist"));else{var r=t.server||this._getServer();r?r.request(t):t.emit("error",new Error("No servers available"))}else this.once("connect",this.request.bind(this,t));else t.emit("error",new Error("No servers available"))},n.prototype.requestServerInfo=function(t){return new o(this,"server_info").callback(t)},n.prototype.requestLedger=function(t,e,r){var n=new o(this,"ledger");t&&(n.message.ledger=t);var i=["full","expand","transactions","accounts"];switch(typeof e){case"object":for(var s in e)~i.indexOf(s)&&(n.message[s]=!0);break;case"function":r=e,e=void 0;break;default:this._trace("request_ledger: full parameter is deprecated"),n.message.full=!0}return n.callback(r),n},n.prototype.requestLedgerHash=function(t){return new o(this,"ledger_closed").callback(t)},n.prototype.requestLedgerHeader=function(t){return new o(this,"ledger_header").callback(t)},n.prototype.requestLedgerCurrent=function(t){return new o(this,"ledger_current").callback(t)},n.prototype.requestLedgerEntry=function(t,e){var r=this,n=new o(this,"ledger_entry");return"account_root"===t&&(n.request_default=n.request,n.request=function(){var e=!0;if(!r._ledger_hash&&"account_root"===t){var i=r.ledgers.current.account_root;i||(i=r.ledgers.current.account_root={});var s=r.ledgers.current.account_root[n.message.account_root];if(s)n.emit("success",{node:s}),e=!1;else switch(t){case"account_root":n.once("success",function(t){r.ledgers.current.account_root[t.node.Account]=t.node})}}e&&n.request_default()}),n.callback(e),n},n.prototype.requestSubscribe=function(t,e){var r=new o(this,"subscribe");return t&&(r.message.streams=Array.isArray(t)?t:[t]),r.callback(e),r},n.prototype.requestUnsubscribe=function(t,e){var r=new o(this,"unsubscribe");return t&&(r.message.streams=Array.isArray(t)?t:[t]),r.callback(e),r},n.prototype.requestTransaction=n.prototype.requestTransactionEntry=function(t,e,r){var n=new o(this,"transaction_entry");switch(n.txHash(t),typeof e){case"string":n.ledgerHash(e);break;case"number":n.ledgerIndex(e);break;case"undefined":case"function":n.ledgerIndex("validated"),r=e;break;default:throw new Error("Invalid ledger_hash type")}return n.callback(r),n},n.prototype.requestTx=function(t,e){var r=new o(this,"tx");return r.message.transaction=t,r.callback(e),r},n.accountRequest=function(t,e,r,n,i){if("object"==typeof e){var s=e;i=account_index,n=s.ledger,r=s.account_index,e=s.accountID||s.account}var a=arguments[arguments.length-1];"function"==typeof a&&(i=a);var c=new o(this,t),e=h.json_rewrite(e);return c.message.ident=e,c.message.account=e,"number"==typeof r&&(c.message.index=r),"undefined"!=typeof n&&c.ledgerChoose(n),c.callback(i),c},n.prototype.requestAccountInfo=function(){var t=Array.prototype.concat.apply(["account_info"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountCurrencies=function(){var t=Array.prototype.concat.apply(["account_currencies"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountLines=function(){var t=Array.prototype.concat.apply(["account_lines"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountOffers=function(){var t=Array.prototype.concat.apply(["account_offers"],arguments);return n.accountRequest.apply(this,t)},n.prototype.requestAccountTx=function(t,e){var r=new o(this,"account_tx"),n=["account","ledger_index_min","ledger_index_max","binary","count","descending","offset","limit","forward","marker"];for(var i in t)~n.indexOf(i)&&(r.message[i]=t[i]);return r.callback(e),r},n.prototype.requestTxHistory=function(t,e){var r=new o(this,"tx_history");return r.message.start=t,r.callback(e),r},n.prototype.requestBookOffers=function(t,e,r,n){if(t.hasOwnProperty("pays")){var i=t;n=e,r=i.taker,e=i.pays,t=i.gets}var s=arguments[arguments.length-1];"function"==typeof s&&(n=s);var a=new o(this,"book_offers");return a.message.taker_gets={currency:u.json_rewrite(t.currency)},"XRP"!==a.message.taker_gets.currency&&(a.message.taker_gets.issuer=h.json_rewrite(t.issuer)),a.message.taker_pays={currency:u.json_rewrite(e.currency)},"XRP"!==a.message.taker_pays.currency&&(a.message.taker_pays.issuer=h.json_rewrite(e.issuer)),a.message.taker=r?r:h.ACCOUNT_ONE,a.callback(n),a},n.prototype.requestWalletAccounts=function(t,e){m.assert(this.trusted);var r=new o(this,"wallet_accounts");return r.message.seed=t,r.callback(e),r},n.prototype.requestSign=function(t,e,r){m.assert(this.trusted);var n=new o(this,"sign");return n.message.secret=t,n.message.tx_json=e,n.callback(r),n},n.prototype.requestSubmit=function(t){return new o(this,"submit").callback(t)},n.prototype._serverPrepareSubscribe=function(t){function e(t){if(r._stand_alone=!!t.stand_alone,r._testnet=!!t.testnet,"string"==typeof t.random){for(var e=t.random.match(/[0-9A-F]{8}/gi);e&&e.length;)v.random.addEntropy(parseInt(e.pop(),16));r.emit("random",m.hexToArray(t.random))}t.ledger_hash&&t.ledger_index&&(r._ledger_time=t.ledger_time,r._ledger_hash=t.ledger_hash,r._ledger_current_index=t.ledger_index+1,r.emit("ledger_closed",t)),r.emit("subscribed")}var r=this,n=["ledger","server"];this._transaction_subs&&n.push("transactions");var i=this.requestSubscribe(n);return i.once("success",e),r.emit("prepare_subscribe",i),i.callback(t,"subscribed"),i},n.prototype.ledgerAccept=function(t){if(this._stand_alone){var e=new o(this,"ledger_accept");e.request(),e.callback(t)}else this.emit("error",new y("notStandAlone"));return this},n.accountRootRequest=function(t,e,r,n,i){"object"==typeof r&&(i=n,n=r.ledger,r=r.account);var s=arguments[arguments.length-1];"function"==typeof s&&(i=s);var o=this.requestLedgerEntry("account_root");return o.accountRoot(r),o.ledgerChoose(n),o.once("success",function(r){o.emit(t,e(r))}),o.callback(i,t),o},n.prototype.requestAccountBalance=function(){function t(t){return c.from_json(t.node.Balance)}var e=Array.prototype.concat.apply(["account_balance",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.requestAccountFlags=function(){function t(t){return t.node.Flags}var e=Array.prototype.concat.apply(["account_flags",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.requestOwnerCount=function(){function t(t){return t.node.OwnerCount}var e=Array.prototype.concat.apply(["owner_count",t],arguments),r=n.accountRootRequest.apply(this,e);return r},n.prototype.getAccount=function(t){return this._accounts[h.json_rewrite(t)]},n.prototype.addAccount=function(t){var e=new l(this,t);return e.is_valid()&&(this._accounts[t]=e),e},n.prototype.account=function(t){var e=this.getAccount(t);return e?e:this.addAccount(t)},n.prototype.pathFind=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.src_currencies,r=i.dst_amount,e=i.dst_account,t=i.src_account}var s=new d(this,t,e,r,n);return this._cur_path_find&&this._cur_path_find.notify_superceded(),s.create(),this._cur_path_find=s,s},n.prepareTrade=function(t,e){return t+("XRP"===t?"":"/"+e)},n.prototype.book=function(t,e,r,i){if("object"==typeof t){var s=t;i=s.issuer_pays,r=s.currency_pays,e=s.issuer_gets,t=s.currency_gets}var o,a=n.prepareTrade(t,e),c=n.prepareTrade(r,i),u=a+":"+c;return this._books.hasOwnProperty(u)||(o=new _(this,t,e,r,i),o.is_valid()&&(this._books[u]=o)),this._books[u]},n.prototype.accountSeq=function(t,e){var r,t=h.json_rewrite(t),n=this.accounts[t];if(account_info&&account_info.seq){r=n.seq;var i={ADVANCE:1,REWIND:-1}[e.toUpperCase()]||0;n.seq+=i}return r},n.prototype.setAccountSeq=function(t,e){var t=h.json_rewrite(t);this.accounts.hasOwnProperty(t)||(this.accounts[t]={}),this.accounts[t].seq=e},n.prototype.accountSeqCache=function(t,e,r){function n(t){delete o.caching_seq_request;var e=t.node.Sequence;o.seq=e,a.emit("success_account_seq_cache",t)}function i(t){delete o.caching_seq_request,a.emit("error_account_seq_cache",t)}if("object"==typeof t){var s=t;r=e,e=s.ledger,t=s.account}this.accounts.hasOwnProperty(t)||(this.accounts[t]={});var o=this.accounts[t],a=o.caching_seq_request;return a||(a=this.requestLedgerEntry("account_root"),a.accountRoot(t),a.ledgerChoose(e),a.once("success",n),a.once("error",i),o.caching_seq_request=a),a.callback(r,"success_account_seq_cache","error_account_seq_cache"),a},n.prototype.dirtyAccountRoot=function(t){var t=h.json_rewrite(t);delete this.ledgers.current.account_root[t]},n.prototype.requestRippleBalance=function(t,e,r,n,i){function s(r){var n=r.node,i=c.from_json(n.LowLimit),s=c.from_json(n.HighLimit),o=c.from_json(n.Balance),u=h.from_json(t).equals(s.issuer());a.emit("ripple_state",{account_balance:(u?o.negate():o.clone()).parse_issuer(t),peer_balance:(u?o.clone():o.negate()).parse_issuer(e),account_limit:(u?s:i).clone().parse_issuer(e),peer_limit:(u?i:s).clone().parse_issuer(t),account_quality_in:u?n.HighQualityIn:n.LowQualityIn,peer_quality_in:u?n.LowQualityIn:n.HighQualityIn,account_quality_out:u?n.HighQualityOut:n.LowQualityOut,peer_quality_out:u?n.LowQualityOut:n.HighQualityOut})}if("object"==typeof t){var o=t;i=e,n=o.ledger,r=o.currency,e=o.issuer,t=o.account}var a=this.requestLedgerEntry("ripple_state");return a.rippleState(t,e,r),a.ledgerChoose(n),a.once("success",s),a.callback(i,"ripple_state"),a},n.prepareCurrencies=function(t){var e={};return t.hasOwnProperty("issuer")&&(e.issuer=h.json_rewrite(t.issuer)),t.hasOwnProperty("currency")&&(e.currency=u.json_rewrite(t.currency)),e},n.prototype.requestRipplePathFind=function(t,e,r,i,s){if("object"==typeof t){var a=t;s=e,i=a.src_currencies,r=a.dst_amount,e=a.dst_account,t=a.src_account}var u=new o(this,"ripple_path_find");return u.message.source_account=h.json_rewrite(t),u.message.destination_account=h.json_rewrite(e),u.message.destination_amount=c.json_rewrite(r),i&&(u.message.source_currencies=i.map(n.prepareCurrencies)),u.callback(s),u},n.prototype.requestPathFindCreate=function(t,e,r,i,s){if("object"==typeof t){var a=t;s=e,i=a.src_currencies,r=a.dst_amount,e=a.dst_account,t=a.src_account}var u=new o(this,"path_find");return u.message.subcommand="create",u.message.source_account=h.json_rewrite(t),u.message.destination_account=h.json_rewrite(e),u.message.destination_amount=c.json_rewrite(r),i&&(u.message.source_currencies=i.map(n.prepareCurrencies)),u.callback(s),u},n.prototype.requestPathFindClose=function(){var t=new o(this,"path_find");return t.message.subcommand="close",t},n.prototype.requestUnlList=function(t){return new o(this,"unl_list").callback(t)},n.prototype.requestUnlAdd=function(t,e,r){var n=new o(this,"unl_add");return n.message.node=t,e&&(n.message.comment=void 0),n.callback(r),n},n.prototype.requestUnlDelete=function(t,e){var r=new o(this,"unl_delete");return r.message.node=t,r.callback(e),r},n.prototype.requestPeers=function(t){return new o(this,"peers").callback(t)},n.prototype.requestConnect=function(t,e,r){var n=new o(this,"connect");return n.message.ip=t,e&&(n.message.port=e),n.callback(r),n},n.prototype.createTransaction=n.prototype.transaction=function(t,e){var r,n=new f(this),i={payment:"payment",accountset:"accountSet",trustset:"trustSet",offercreate:"offerCreate",offercancel:"offerCancel",sign:"sign"};switch(typeof t){case"object":if("string"!=typeof t.type)throw new Error("Missing transaction type");if(r=i[t.type.toLowerCase()],!r)throw new Error("Invalid transaction type: "+r);n=n[r](t);break;case"string":if(r=t.toLowerCase(),!r)throw new Error("Invalid transaction type: "+r);n=n[r](e)}var s=arguments[arguments.length-1];return"function"==typeof s&&n.submit(s),n},n.prototype.feeTx=function(t){return this._getServer().feeTx(t)},n.prototype.feeTxUnit=function(){return this._getServer().feeTxUnit()},n.prototype.reserve=function(t){return this._getServer().reserve(t)},n.prototype.ping=function(t,e){var r=new o(this,"ping");switch(typeof t){case"function":e=t;break;case"string":r.setServer(t)}var n=Date.now();return r.once("success",function(){r.emit("pong",Date.now()-n)}),r.callback(e,"pong"),r},e.Remote=n},function(t,e,r){function n(t,e){i.call(this),this.remote=t,this.requested=!1,this.message={command:e,id:void 0}}var i=r(37).EventEmitter,s=r(38),o=r(96).UInt160,a=r(81).Currency,c=(r(80).Transaction,r(79).Account,r(83).Meta,r(97).OrderBook,r(85).RippleError);s.inherits(n,i),n.prototype.broadcast=function(){return this._broadcast=!0,this.request()},n.prototype.request=function(t){return this.requested?void 0:(this.requested=!0,this.on("error",new Function),this.emit("request",t),this._broadcast?this.remote._servers.forEach(function(t){this.setServer(t),this.remote.request(this)},this):this.remote.request(this),this)},n.prototype.callback=function(t,e,r){function n(e){t.call(s,null,e)}function i(e){e instanceof c||(e=new c(e)),t.call(s,e)}if(t&&"function"==typeof t){var s=this;this.once(e||"success",n),this.once(r||"error",i),this.request()}return this},n.prototype.timeout=function(t,e){function r(){n.timeout(t,e)}var n=this;if(!this.requested)return void this.once("request",r);var i=this.emit,s=!1,o=setTimeout(function(){s=!0,"function"==typeof e&&e(),i.call(n,"timeout")},t);return this.emit=function(){s||(clearTimeout(o),i.apply(n,arguments))},this},n.prototype.setServer=function(t){var e=null;switch(typeof t){case"object":e=t;break;case"string":for(var r,n=this.remote._servers,i=0;r=n[i];i++)if(r._host===t){e=r;break}}return this.server=e,this},n.prototype.buildPath=function(t){if(this.remote.local_signing)throw new Error("`build_path` is completely ignored when doing local signing as `Paths` is a component of the signed blob. The `tx_blob` is signed,sealed and delivered, and the txn unmodified after");return t?this.message.build_path=!0:delete this.message.build_path,this},n.prototype.ledgerChoose=function(t){return t?this.message.ledger_index=this.remote._ledger_current_index:this.message.ledger_hash=this.remote._ledger_hash,this},n.prototype.ledgerHash=function(t){return this.message.ledger_hash=t,this},n.prototype.ledgerIndex=function(t){return this.message.ledger_index=t,this},n.prototype.ledgerSelect=function(t){switch(t){case"current":case"closed":case"verified":this.message.ledger_index=t;break;default:Number(t)?this.message.ledger_index=t:this.message.ledger_hash=t}return this},n.prototype.accountRoot=function(t){return this.message.account_root=o.json_rewrite(t),this},n.prototype.index=function(t){return this.message.index=t,this},n.prototype.offerId=function(t,e){return this.message.offer={account:o.json_rewrite(t),seq:e},this},n.prototype.offerIndex=function(t){return this.message.offer=t,this},n.prototype.secret=function(t){return t&&(this.message.secret=t),this},n.prototype.txHash=function(t){return this.message.tx_hash=t,this},n.prototype.txJson=function(t){return this.message.tx_json=t,this},n.prototype.txBlob=function(t){return this.message.tx_blob=t,this},n.prototype.rippleState=function(t,e,r){return this.message.ripple_state={currency:r,accounts:[o.json_rewrite(t),o.json_rewrite(e)]},this},n.prototype.accounts=function(t,e){Array.isArray(t)||(t=[t]);var r=t.map(function(t){return o.json_rewrite(t)});return e?this.message.accounts_proposed=r:this.message.accounts=r,this},n.prototype.addAccount=function(t,e){var r=o.json_rewrite(t);return e?this.message.accounts_proposed=(this.message.accounts_proposed||[]).concat(r):this.message.accounts=(this.message.accounts||[]).concat(r),this},n.prototype.rtAccounts=n.prototype.accountsProposed=function(t){return this.accounts(t,!0)},n.prototype.addAccountProposed=function(t){return this.addAccount(t,!0)},n.prototype.books=function(t,e){this.message.books=[];for(var r=0,n=t.length;n>r;r++){var i=t[r];this.addBook(i,e)}return this},n.prototype.addBook=function(t,e){function r(e){if(!t[e])throw new Error("Missing "+e);var r=n[e]={currency:a.json_rewrite(t[e].currency)};"XRP"!==r.currency&&(r.issuer=o.json_rewrite(t[e].issuer))}Array.isArray(this.message.books)||(this.message.books=[]);var n={};["taker_gets","taker_pays"].forEach(r),e&&(n.snapshot=!0),t.both&&(n.both=!0),this.message.books.push(n)},e.Request=n},function(t,e,r){function n(){this._value=new o,this._offset=0,this._is_native=!0,this._is_negative=!1,this._currency=new u,this._issuer=new a}var i=r(87),s=i.sjcl,o=(s.bn,i.jsbn.BigInteger),a=r(96).UInt160,c=r(99).Seed,u=r(81).Currency,h=e.consts={currency_xns:0,currency_one:1,xns_precision:6,bi_5:new o("5"),bi_7:new o("7"),bi_10:new o("10"),bi_1e14:new o(String(1e14)),bi_1e16:new o(String(1e16)),bi_1e17:new o(String(1e17)),bi_1e32:new o("100000000000000000000000000000000"),bi_man_max_value:new o("9999999999999999"),bi_man_min_value:new o("1000000000000000"),bi_xns_max:new o("9000000000000000000"),bi_xns_min:new o("-9000000000000000000"),bi_xns_unit:new o("1000000"),cMinOffset:-96,cMaxOffset:80};
n.text_full_rewrite=function(t){return n.from_json(t).to_text_full()},n.json_rewrite=function(t){return n.from_json(t).to_json()},n.from_number=function(t){return(new n).parse_number(t)},n.from_json=function(t){return(new n).parse_json(t)},n.from_quality=function(t,e,r){return(new n).parse_quality(t,e,r)},n.from_human=function(t){return(new n).parse_human(t)},n.is_valid=function(t){return n.from_json(t).is_valid()},n.is_valid_full=function(t){return n.from_json(t).is_valid_full()},n.NaN=function(){var t=new n;return t._value=0/0,t},n.prototype.abs=function(){return this.clone(this.is_negative())},n.prototype.add=function(t){var e;if(t=n.from_json(t),this.is_comparable(t))if(t.is_zero())e=this;else if(this.is_zero())e=t.clone(),e._is_native=this._is_native,e._currency=this._currency,e._issuer=this._issuer;else if(this._is_native){e=new n;var r=this._is_negative?this._value.negate():this._value,i=t._is_negative?t._value.negate():t._value,s=r.add(i);e._is_negative=s.compareTo(o.ZERO)<0,e._value=e._is_negative?s.negate():s,e._currency=this._currency,e._issuer=this._issuer}else{for(var r=this._is_negative?this._value.negate():this._value,a=this._offset,i=t._is_negative?t._value.negate():t._value,c=t._offset;c>a;)r=r.divide(h.bi_10),a+=1;for(;a>c;)i=i.divide(h.bi_10),c+=1;e=new n,e._is_native=!1,e._offset=a,e._value=r.add(i),e._is_negative=e._value.compareTo(o.ZERO)<0,e._is_negative&&(e._value=e._value.negate()),e._currency=this._currency,e._issuer=this._issuer,e.canonicalize()}else e=n.NaN();return e},n.prototype.canonicalize=function(){if(this._value instanceof o)if(this._is_native)if(this._value.equals(o.ZERO))this._offset=0,this._is_negative=!1;else{for(;this._offset<0;)this._value=this._value.divide(h.bi_10),this._offset+=1;for(;this._offset>0;)this._value=this._value.multiply(h.bi_10),this._offset-=1}else if(this.is_zero())this._offset=-100,this._is_negative=!1;else{for(;this._value.compareTo(h.bi_man_min_value)<0;)this._value=this._value.multiply(h.bi_10),this._offset-=1;for(;this._value.compareTo(h.bi_man_max_value)>0;)this._value=this._value.divide(h.bi_10),this._offset+=1}else;return this},n.prototype.clone=function(t){return this.copyTo(new n,t)},n.prototype.compareTo=function(t){var e;return this.is_comparable(t)?this._is_negative!==t._is_negative?e=this._is_negative?-1:1:this._value.equals(o.ZERO)?e=t._value.equals(o.ZERO)?0:-1:t._value.equals(o.ZERO)?e=1:!this._is_native&&this._offset>t._offset?e=this._is_negative?-1:1:!this._is_native&&this._offset<t._offset?e=this._is_negative?1:-1:(e=this._value.compareTo(t._value),e>0?e=this._is_negative?-1:1:0>e&&(e=this._is_negative?1:-1)):e=n.NaN(),e},n.prototype.copyTo=function(t,e){return"object"==typeof this._value?this._value.copyTo(t._value):t._value=this._value,t._offset=this._offset,t._is_native=this._is_native,t._is_negative=e?!this._is_negative:this._is_negative,t._currency=this._currency,t._issuer=this._issuer,t.is_zero()&&(t._is_negative=!1),t},n.prototype.currency=function(){return this._currency},n.prototype.equals=function(t,e){if("string"==typeof t)return this.equals(n.from_json(t));var r=!0;return r=!!(this.is_valid()&&t.is_valid()&&this._is_native===t._is_native&&this._value.equals(t._value)&&this._offset===t._offset&&this._is_negative===t._is_negative&&(this._is_native||this._currency.equals(t._currency)&&(e||this._issuer.equals(t._issuer))))},n.prototype.divide=function(t){var e;if(t.is_zero())throw"divide by zero";if(this.is_zero())e=this;else{if(!this.is_valid())throw new Error("Invalid dividend");if(!t.is_valid())throw new Error("Invalid divisor");var r=this;if(r.is_native())for(r=r.clone();r._value.compareTo(h.bi_man_min_value)<0;)r._value=r._value.multiply(h.bi_10),r._offset-=1;var i=t;if(i.is_native())for(i=i.clone();i._value.compareTo(h.bi_man_min_value)<0;)i._value=i._value.multiply(h.bi_10),i._offset-=1;e=new n,e._offset=r._offset-i._offset-17,e._value=r._value.multiply(h.bi_1e17).divide(i._value).add(h.bi_5),e._is_native=r._is_native,e._is_negative=r._is_negative!==i._is_negative,e._currency=r._currency,e._issuer=r._issuer,e.canonicalize()}return e},n.prototype.ratio_human=function(t){t=n.from_json("number"==typeof t&&parseInt(t,10)===t?""+t+".0":t);var e=this;return t=n.from_json(t),e.is_valid()&&t.is_valid()?(t._is_native&&(e=e.clone(),e._value=e._value.multiply(h.bi_xns_unit),e.canonicalize()),e.divide(t)):n.NaN()},n.prototype.product_human=function(t){if(t=n.from_json("number"==typeof t&&parseInt(t,10)===t?String(t)+".0":t),!this.is_valid()||!t.is_valid())return n.NaN();var e=this.multiply(t);return t._is_native&&(e._value=e._value.divide(h.bi_xns_unit),e.canonicalize()),e},n.prototype.is_comparable=function(t){return this._value instanceof o&&t._value instanceof o&&this._is_native===t._is_native},n.prototype.is_native=function(){return this._is_native},n.prototype.is_negative=function(){return this._value instanceof o?this._is_negative:!1},n.prototype.is_positive=function(){return!this.is_zero()&&!this.is_negative()},n.prototype.is_valid=function(){return this._value instanceof o},n.prototype.is_valid_full=function(){return this.is_valid()&&this._currency.is_valid()&&this._issuer.is_valid()},n.prototype.is_zero=function(){return this._value instanceof o?this._value.equals(o.ZERO):!1},n.prototype.issuer=function(){return this._issuer},n.prototype.multiply=function(t){var e;if(this.is_zero())e=this;else if(t.is_zero())e=this.clone(),e._value=o.ZERO;else{var r=this._value,i=this._offset,s=t._value,a=t._offset;if(this.is_native())for(;r.compareTo(h.bi_man_min_value)<0;)r=r.multiply(h.bi_10),i-=1;if(t.is_native())for(;s.compareTo(h.bi_man_min_value)<0;)s=s.multiply(h.bi_10),a-=1;e=new n,e._offset=i+a+14,e._value=r.multiply(s).divide(h.bi_1e14).add(h.bi_7),e._is_native=this._is_native,e._is_negative=this._is_negative!==t._is_negative,e._currency=this._currency,e._issuer=this._issuer,e.canonicalize()}return e},n.prototype.negate=function(){return this.clone("NEGATE")},n.prototype.invert=function(){var t=this.clone();return t._value=o.ONE,t._offset=0,t._is_negative=!1,t.canonicalize(),t.ratio_human(this)},n.human_RE=/^\s*([a-z]{3})?\s*(-)?(\d+)(?:\.(\d*))?\s*([a-z]{3})?\s*$/i,n.prototype.parse_human=function(t){var e=String(t).match(n.human_RE);if(e){var r=e[1]||e[5]||"XRP",i=e[3]||"0",s=e[4]||"",a=null;if(r=r.toUpperCase(),this._value=new o(i),this.set_currency(r),"XRP"===r){for(s=s.slice(0,6);s.length<6;)s+="0";this._is_native=!0,this._value=this._value.multiply(h.bi_xns_unit).add(new o(s))}else{s=s.replace(/0+$/,""),a=s.length,this._is_native=!1;var c=h.bi_10.clone().pow(a);this._value=this._value.multiply(c).add(new o(s)),this._offset=-a,this.canonicalize()}this._is_negative=!!e[2]}else this._value=0/0;return this},n.prototype.parse_issuer=function(t){return this._issuer=a.from_json(t),this},n.prototype.parse_quality=function(t,e,r){return this._is_negative=!1,this._value=new o(t.substring(t.length-14),16),this._offset=parseInt(t.substring(t.length-16,t.length-14),16)-100,this._currency=u.from_json(e),this._issuer=a.from_json(r),this._is_native=this._currency.is_native(),this.canonicalize(),this},n.prototype.parse_number=function(t){return this._is_native=!1,this._currency=u.from_json(1),this._issuer=a.from_json(1),this._is_negative=0>t?1:0,this._value=new o(String(this._is_negative?-t:t)),this._offset=0,this.canonicalize(),this},n.prototype.parse_json=function(t){switch(typeof t){case"string":var e=t.match(/^([^/]+)\/([^/]+)(?:\/(.+))?$/);e?(this._currency=u.from_json(e[2]),this._issuer=a.from_json(e[3]?e[3]:"1"),this.parse_value(e[1])):(this.parse_native(t),this._currency=u.from_json("0"),this._issuer=a.from_json("0"));break;case"number":this.parse_json(String(t));break;case"object":if(null===t)break;t instanceof n?t.copyTo(this):t.hasOwnProperty("value")&&(this._currency.parse_json(t.currency,!0),"string"==typeof t.issuer&&this._issuer.parse_json(t.issuer),this.parse_value(t.value));break;default:this._value=0/0}return this},n.prototype.parse_native=function(t){var e;if("string"==typeof t&&(e=t.match(/^(-?)(\d*)(\.\d{0,6})?$/)),e){if(void 0===e[3])this._value=new o(e[2]);else{var r=new o(e[2]).multiply(h.bi_xns_unit),n=new o(e[3]).multiply(new o(String(Math.pow(10,1+h.xns_precision-e[3].length))));this._value=r.add(n)}this._is_native=!0,this._offset=0,this._is_negative=!!e[1]&&0!==this._value.compareTo(o.ZERO),this._value.compareTo(h.bi_xns_max)>0&&(this._value=0/0)}else this._value=0/0;return this},n.prototype.parse_value=function(t){switch(this._is_native=!1,typeof t){case"number":this._is_negative=0>t,this._value=new o(Math.abs(t)),this._offset=0,this.canonicalize();break;case"string":var e=t.match(/^(-?)(\d+)$/),r=!e&&t.match(/^(-?)(\d*)\.(\d*)$/),n=!n&&t.match(/^(-?)(\d*)e(-?\d+)$/);if(n)this._value=new o(n[2]),this._offset=parseInt(n[3]),this._is_negative=!!n[1],this.canonicalize();else if(r){var i=new o(r[2]),s=new o(r[3]),a=r[3].length;this._value=i.multiply(h.bi_10.clone().pow(a)).add(s),this._offset=-a,this._is_negative=!!r[1],this.canonicalize()}else e?(this._value=new o(e[2]),this._offset=0,this._is_negative=!!e[1],this.canonicalize()):this._value=0/0;break;default:this._value=t instanceof o?t:0/0}return this},n.prototype.set_currency=function(t){return this._currency=u.from_json(t),this._is_native=this._currency.is_native(),this},n.prototype.set_issuer=function(t){return this._issuer=t instanceof a?t:a.from_json(t),this},n.prototype.subtract=function(t){return this.add(n.from_json(t).negate())},n.prototype.to_number=function(t){var e=this.to_text(t);return"string"==typeof e?Number(e):e},n.prototype.to_text=function(t){var e=0/0;if(this._is_native)this.is_valid()&&this._value.compareTo(h.bi_xns_max)<=0&&(e=this._value.toString());else if(this.is_zero())e="0";else if(this._offset&&(this._offset<-25||this._offset>-4))e=this._value.toString()+"e"+this._offset;else{var r="000000000000000000000000000"+this._value.toString()+"00000000000000000000000",n=r.substring(0,this._offset+43),i=r.substring(this._offset+43),s=n.match(/[1-9].*$/),o=i.match(/[1-9]0*$/);e=""+(s?s[0]:"0")+(o?"."+i.substring(0,1+i.length-o[0].length):"")}return!t&&"number"==typeof e&&isNaN(e)?e="0":this._is_negative&&(e="-"+e),e},n.prototype.to_human=function(t){if(t=t||{},!this.is_valid())return"";"undefined"==typeof t.signed&&(t.signed=!0),"undefined"==typeof t.group_sep&&(t.group_sep=!0),t.group_width=t.group_width||3;var e=this;if(t.reference_date&&this._currency.has_interest()){var r=this._currency.get_interest_at(t.reference_date),s=n.from_json(""+r+"/1/1");s.is_valid()&&(e=this.multiply(s))}for(var o=e._is_native?h.xns_precision:-e._offset,a=h.bi_10.clone().pow(o),c=e._value.divide(a).toString(),u=e._value.mod(a).toString();u.length<o;)u="0"+u;if(c=c.replace(/^0*/,""),u=u.replace(/0*$/,""),u.length||!t.skip_empty_fraction){if("number"==typeof t.precision&&(0===t.precision&&u.charCodeAt(0)>=53&&(c=(Number(c)+1).toString()),u=u.slice(0,t.precision)),"number"==typeof t.max_sig_digits){var f=0===+c,l=f?0:c.length,p=f?u.replace(/^0*/,""):u;l+=p.length;var _=l-t.max_sig_digits;_=Math.max(_,0),_=Math.min(_,u.length),_>0&&(u=u.slice(0,-_))}if("number"==typeof t.min_precision)for(;u.length<t.min_precision;)u+="0"}t.group_sep&&("string"!=typeof t.group_sep&&(t.group_sep=","),c=i.chunkString(c,t.group_width,!0).join(t.group_sep));var d="";return t.signed&&this._is_negative&&("string"!=typeof t.signed&&(t.signed="-"),d+=t.signed),d+=c.length?c:"0",d+=u.length?"."+u:""},n.prototype.to_human_full=function(t){var t=t||{},e=this.to_human(t),r=this._currency.to_human(),n=this._issuer.to_json(t),i=i=this.is_native?e+"/"+r:e+"/"+r+"/"+n;return i},n.prototype.to_json=function(){var t;if(this._is_native)t=this.to_text();else{var e={value:this.to_text(),currency:this._currency.to_json()};this._issuer.is_valid()&&(e.issuer=this._issuer.to_json()),t=e}return t},n.prototype.to_text_full=function(t){return this._value instanceof o?this._is_native?this.to_human()+"/XRP":this.to_text()+"/"+this._currency.to_json()+"/"+this._issuer.to_json(t):0/0},n.prototype.not_equals_why=function(t,e){var r=!1;if("string"==typeof t)r=this.not_equals_why(n.from_json(t));else if(t instanceof n)if(this.is_valid()&&t.is_valid())if(this._is_native!==t._is_native)r="Native mismatch.";else{var i=this._is_native?"XRP":"Non-XRP";this._value.equals(t._value)&&this._offset===t._offset?this._is_negative!==t._is_negative?r=i+" sign differs.":this._is_native||(this._currency.equals(t._currency)?e||this._issuer.equals(t._issuer)||(r="Non-XRP issuer differs: "+t._issuer.to_json()+"/"+this._issuer.to_json()):r="Non-XRP currency differs."):r=i+" value differs."}else r="Invalid amount.";else r="Wrong constructor.";return r},e.Amount=n,e.Currency=u,e.Seed=c,e.UInt160=a},function(t,e,r){function n(t,e){function r(t){~n.subscribeEvents.indexOf(t)&&(!f._subs&&f._remote._connected&&f._remote.request_subscribe().add_account(f._account_id).broadcast(),f._subs+=1)}function s(t){~n.subscribeEvents.indexOf(t)&&(f._subs-=1,!f._subs&&f._remote._connected&&f._remote.request_unsubscribe().add_account(f._account_id).broadcast())}function u(t){f._account.is_valid()&&f._subs&&t.add_account(f._account_id)}function h(t){if(t.mmeta){var e=!1;t.mmeta.each(function(t){var r=t.fields.Account===f._account_id,n=r&&"AccountRoot"===t.entryType;n&&(o(f._entry,t.fieldsNew,t.fieldsFinal),e=!0)}),e&&f.emit("entry",f._entry)}}i.call(this);var f=this;return this._remote=t,this._account=a.from_json(e),this._account_id=this._account.to_json(),this._subs=0,this._entry={},this.on("newListener",r),this.on("removeListener",s),this._remote.on("prepare_subscribe",u),this.on("transaction",h),this._transactionManager=new c(this),this}var i=r(37).EventEmitter,s=r(38),o=r(109),a=(r(78).Amount,r(96).UInt160),c=r(100).TransactionManager;s.inherits(n,i),n.subscribeEvents=["transaction","entry"],n.prototype.toJson=function(){return this._account.to_json()},n.prototype.isValid=function(){return this._account.is_valid()},n.prototype.getInfo=function(t){return this._remote.request_account_info(this._account_id,t)},n.prototype.entry=function(t){function e(e,n){e?t(e):(o(r._entry,n.account_data),r.emit("entry",r._entry),t(null,n))}var r=this,t="function"==typeof t?t:function(){};return this.getInfo(e),this},n.prototype.getNextSequence=function(t){function e(e,r){e&&"object"==typeof e&&"object"==typeof e.remote&&"actNotFound"===e.remote.error?t(null,0):e?t(e):t(null,r.account_data.Sequence)}var t="function"==typeof t?t:function(){};return this.getInfo(e),this},n.prototype.lines=function(t){function e(e,n){e?t(e):(r._lines=n.lines,r.emit("lines",r._lines),t(null,n))}var r=this,t="function"==typeof t?t:function(){};return this._remote.requestAccountLines(this._account_id,e),this},n.prototype.line=function(t,e,r){var n=this,r="function"==typeof r?r:function(){};return n.lines(function(n,i){if(n)r(n);else{var s=i.lines.filter(function(r){return r.account===e&&r.currency===t?r:void 0})[0];r(null,s)}}),this},n.prototype.notify=n.prototype.notifyTx=function(t){if(this._subs){this.emit("transaction",t);var e=t.transaction.Account;if(!e)return;var r=e===this._account_id;this.emit(r?"transaction-outbound":"transaction-inbound",t)}},n.prototype.submit=function(t){this._transactionManager.submit(t)},e.Account=n},function(t,e,r){function n(t){i.call(this);this.remote=t,this._secret=void 0,this.tx_json={Flags:0},this._build_path=!1,this.submitIndex=void 0,this.state=void 0,this.finalized=!1,this.previousSigningHash=void 0,this.submittedIDs=[]}var i=r(37).EventEmitter,s=r(38),o=r(87).sjcl,a=r(78).Amount,c=r(78).Currency,u=r(78).UInt160,h=r(99).Seed,f=r(84).SerializedObject,l=r(85).RippleError,p=r(101),_=r(89);s.inherits(n,i),n.fee_units={"default":10},n.flags={AccountSet:{RequireDestTag:65536,OptionalDestTag:131072,RequireAuth:262144,OptionalAuth:524288,DisallowXRP:1048576,AllowXRP:2097152},TrustSet:{SetAuth:65536,NoRipple:131072,ClearNoRipple:262144},OfferCreate:{Passive:65536,ImmediateOrCancel:131072,FillOrKill:262144,Sell:524288},Payment:{NoRippleDirect:65536,PartialPayment:131072,LimitQuality:262144}},n.formats=r(86).tx,n.prototype.consts={telLOCAL_ERROR:-399,temMALFORMED:-299,tefFAILURE:-199,terRETRY:-99,tesSUCCESS:0,tecCLAIMED:100},n.from_json=function(t){return(new n).parse_json(t)},n.prototype.parseJson=function(t){return this.tx_json=t,this},n.prototype.isTelLocal=function(t){return t>=this.consts.telLOCAL_ERROR&&t<this.consts.temMALFORMED},n.prototype.isTemMalformed=function(t){return t>=this.consts.temMALFORMED&&t<this.consts.tefFAILURE},n.prototype.isTefFailure=function(t){return t>=this.consts.tefFAILURE&&t<this.consts.terRETRY},n.prototype.isTerRetry=function(t){return t>=this.consts.terRETRY&&t<this.consts.tesSUCCESS},n.prototype.isTepSuccess=function(t){return t>=this.consts.tesSUCCESS},n.prototype.isTecClaimed=function(t){return t>=this.consts.tecCLAIMED},n.prototype.isRejected=function(t){return this.isTelLocal(t)||this.isTemMalformed(t)||this.isTefFailure(t)},n.prototype.setState=function(t){this.state!==t&&(this.state=t,this.emit("state",t))},n.prototype._accountSecret=function(t){return this.remote.secrets[t]},n.prototype.getFee=n.prototype.feeUnits=function(){return n.fee_units["default"]},n.prototype._getServer=function(){for(var t,e=this.remote._servers,r=1/0,n=0;n<e.length;n++){var i=e[n];if(i._connected){var s=i.computeFee(this);r>s&&(t=i,r=s)}}return t},n.prototype.complete=function(){if(this._secret||(this._secret=this._account_secret(this.tx_json.Account)),this.remote&&"undefined"==typeof this.tx_json.Fee&&(this.remote.local_fee||!this.remote.trusted)&&(this._server=this._getServer(),this.tx_json.Fee=this._server.computeFee(this)),"undefined"==typeof this.tx_json.SigningPubKey){var t=h.from_json(this._secret),e=t.get_key(this.tx_json.Account);this.tx_json.SigningPubKey=e.to_hex_pub()}return this.tx_json},n.prototype.serialize=function(){return f.from_json(this.tx_json)},n.prototype.signingHash=function(){return this.hash(_.testnet?"HASH_TX_SIGN_TESTNET":"HASH_TX_SIGN")},n.prototype.hash=function(t,e){if("string"==typeof t){if("undefined"==typeof p[t])throw new Error("Unknown hashing prefix requested.");t=p[t]}else t||(t=p.HASH_TX_ID);var r=f.from_json(this.tx_json).hash(t);return e?r:r.to_hex()},n.prototype.sign=function(){var t=h.from_json(this._secret),e=this.tx_json.TxnSignature;delete this.tx_json.TxnSignature;var r=this.signingHash();if(e&&r===this.previousSigningHash)return this.tx_json.TxnSignature=e,this;var n=t.get_key(this.tx_json.Account),i=n.sign(r,0),s=o.codec.hex.fromBits(i).toUpperCase();return this.tx_json.TxnSignature=s,this.previousSigningHash=r,this},n.prototype.addId=function(t){-1===this.submittedIDs.indexOf(t)&&(this.submittedIDs.unshift(t),this.emit("signed",t),this.transactionManager()._pending.save())},n.prototype.findId=function(t){for(var e,r=0;r<this.submittedIDs.length;r++){var n=this.submittedIDs[r];if(e=t[n])break}return e},n.prototype.buildPath=function(t){return this._build_path=t,this},n.prototype.destinationTag=function(t){return void 0!==t&&(this.tx_json.DestinationTag=t),this},n.prototype.invoiceID=function(t){if("string"==typeof t){for(;t.length<64;)t+="0";this.tx_json.InvoiceID=t}return this},n._pathRewrite=function(t){return t.map(function(t){var e={};return t.hasOwnProperty("account")&&(e.account=u.json_rewrite(t.account)),t.hasOwnProperty("issuer")&&(e.issuer=u.json_rewrite(t.issuer)),t.hasOwnProperty("currency")&&(e.currency=c.json_rewrite(t.currency)),e})},n.prototype.pathAdd=function(t){return Array.isArray(t)&&(this.tx_json.Paths=this.tx_json.Paths||[],this.tx_json.Paths.push(n._pathRewrite(t))),this},n.prototype.paths=function(t){if(Array.isArray(t))for(var e=0,r=t.length;r>e;e++)this.pathAdd(t[e]);return this},n.prototype.secret=function(t){return this._secret=t,this},n.prototype.sendMax=function(t){return t&&(this.tx_json.SendMax=a.json_rewrite(t)),this},n.prototype.sourceTag=function(t){return t&&(this.tx_json.SourceTag=t),this},n.prototype.transferRate=function(t){if(this.tx_json.TransferRate=Number(t),this.tx_json.TransferRate<1e9)throw new Error("invalidTransferRate");return this},n.prototype.setFlags=function(t){if(!t)return this;var e=n.flags[this.tx_json.TransactionType],r=Array.isArray(t)?t:Array.prototype.slice.call(arguments);void 0===this.tx_json.Flags&&(this.tx_json.Flags=0);for(var i=0,s=r.length;s>i;i++){var o=r[i];e.hasOwnProperty(o)&&(this.tx_json.Flags+=e[o])}return this},n.prototype.accountSet=function(t){if("object"==typeof t){var e=t;t=e.source||e.from}if(!u.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="AccountSet",this.tx_json.Account=u.json_rewrite(t),this},n.prototype.claim=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.signature,r=i.public_key,e=i.generator,t=i.source||i.from}return this.tx_json.TransactionType="Claim",this.tx_json.Generator=e,this.tx_json.PublicKey=r,this.tx_json.Signature=n,this},n.prototype.offerCancel=function(t,e){if("object"==typeof t){var r=t;e=r.sequence,t=r.source||r.from}if(!u.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="OfferCancel",this.tx_json.Account=u.json_rewrite(t),this.tx_json.OfferSequence=Number(e),this},n.prototype.offerCreate=function(t,e,r,n,i){if("object"==typeof t){var s=t;i=s.cancel_sequence,n=s.expiration,r=s.taker_gets||s.sell,e=s.taker_pays||s.buy,t=s.source||s.from}if(!u.is_valid(t))throw new Error("Source address invalid");if(this.tx_json.TransactionType="OfferCreate",this.tx_json.Account=u.json_rewrite(t),this.tx_json.TakerPays=a.json_rewrite(e),this.tx_json.TakerGets=a.json_rewrite(r),n)switch(n.constructor){case Date:this.tx_json.Expiration=n.getTime()-9466848e5;break;case Number:this.tx_json.Expiration=n}return i&&(this.tx_json.OfferSequence=Number(i)),this},n.prototype.passwordFund=function(t,e){if("object"==typeof t){var r=t;e=r.destination||r.to,t=r.source||r.from}if(!u.is_valid(e))throw new Error("Destination address invalid");return this.tx_json.TransactionType="PasswordFund",this.tx_json.Destination=u.json_rewrite(e),this},n.prototype.passwordSet=function(t,e,r,n,i){if("object"==typeof t){var s=t;i=s.signature,n=s.public_key,r=s.generator,e=s.authorized_key,t=s.source||s.from}if(!u.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="PasswordSet",this.tx_json.RegularKey=e,this.tx_json.Generator=r,this.tx_json.PublicKey=n,this.tx_json.Signature=i,this},n.prototype.payment=function(t,e,r){if("object"==typeof t){var n=t;r=n.amount,e=n.destination||n.to,t=n.source||n.from,n.invoiceID&&this.invoiceID(n.invoiceID)}if(!u.is_valid(t))throw new Error("Payment source address invalid");if(!u.is_valid(e))throw new Error("Payment destination address invalid");return/^[\d]+[A-Z]{3}$/.test(r)&&(r=a.from_human(r)),this.tx_json.TransactionType="Payment",this.tx_json.Account=u.json_rewrite(t),this.tx_json.Amount=a.json_rewrite(r),this.tx_json.Destination=u.json_rewrite(e),this},n.prototype.trustSet=n.prototype.rippleLineSet=function(t,e,r,n){if("object"==typeof t){var i=t;n=i.quality_out,r=i.quality_in,e=i.limit,t=i.source||i.from}if(!u.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="TrustSet",this.tx_json.Account=u.json_rewrite(t),void 0!==e&&(this.tx_json.LimitAmount=a.json_rewrite(e)),r&&(this.tx_json.QualityIn=r),n&&(this.tx_json.QualityOut=n),this},n.prototype.walletAdd=function(t,e,r,n,i){if("object"==typeof t){var s=t;i=s.signature,n=s.public_key,r=s.authorized_key,e=s.amount,t=s.source||s.from}if(!u.is_valid(t))throw new Error("Source address invalid");return this.tx_json.TransactionType="WalletAdd",this.tx_json.Amount=a.json_rewrite(e),this.tx_json.RegularKey=r,this.tx_json.PublicKey=n,this.tx_json.Signature=i,this},n.prototype.submit=function(t){function e(t,e){t instanceof l||(t=new l(t,e)),n.callback(t)}function r(t){n.callback(null,t)}var n=this;this.callback="function"==typeof t?t:function(){},this.once("error",e),this.once("success",r),this.on("error",function(){});var i=this.tx_json.Account;return"string"!=typeof i?this.emit("error",new l("tejInvalidAccount","Account is unspecified")):this.remote.account(i).submit(this),this},n.prototype.transactionManager=function(){return this.remote.account(this.tx_json.Account)._transactionManager},n.prototype.abort=function(t){if(!this.finalized){var t="function"==typeof t?t:function(){};this.once("final",t),this.emit("abort")}},e.Transaction=n},function(t,e,r){var n=r(109),i=r(96).UInt160,s=r(102).Float,o=r(87),a=n(function(){this._value=0/0,this._update()},i);a.prototype=n({},i.prototype),a.prototype.constructor=a,a.HEX_CURRENCY_BAD="0000000000000000000000005852500000000000",a.from_json=function(t,e){return t instanceof this?t.clone():(new this).parse_json(t,e)},a.prototype.parse_json=function(t,e){switch(this._value=0/0,typeof t){case"string":if(!t||/^(0|XRP)$/.test(t))this.parse_hex(e?a.HEX_CURRENCY_BAD:a.HEX_ZERO);else if(/^[a-zA-Z0-9]{3}$/.test(t)){var r=t.toUpperCase(),n=o.arraySet(20,0);n[12]=255&r.charCodeAt(0),n[13]=255&r.charCodeAt(1),n[14]=255&r.charCodeAt(2),this.parse_bytes(n)}else this.parse_hex(t);break;case"number":isNaN(t)||this.parse_number(t);break;case"object":t instanceof a&&(this._value=t.copyTo({})._value,this._update())}return this},a.prototype._update=function(){var t=this.to_bytes(),e=!0;if(!t)return"XRP";this._native=!1,this._type=-1,this._interest_start=new Date,this._interest_period=0/0,this._iso_code="";for(var r=0;20>r;r++)e=e&&(12===r||13===r||14===r||0===t[r]);e?(this._iso_code=String.fromCharCode(t[12])+String.fromCharCode(t[13])+String.fromCharCode(t[14]),"\x00\x00\x00"===this._iso_code&&(this._native=!0,this._iso_code="XRP"),this._type=0):1===t[0]&&(this._iso_code=String.fromCharCode(t[1])+String.fromCharCode(t[2])+String.fromCharCode(t[3]),this._type=1,this._interest_start=(t[4]<<24)+(t[5]<<16)+(t[6]<<8)+t[7],this._interest_period=s.fromBytes(t.slice(8,16)))},a.prototype.is_native=function(){return this._native},a.prototype.has_interest=function(){return 1===this._type&&this._interest_start&&!isNaN(this._interest_period)},a.prototype.get_interest_at=function(t){return this.has_interest?(t instanceof Date&&(t=o.fromTimestamp(t.getTime())),Math.pow(Math.E,(t-this._interest_start)/this._interest_period)):1},a.prototype.to_json=function(){if(!this.is_valid())return"XRP";if(/^[A-Z0-9]{3}$/.test(this._iso_code))return this._iso_code;var t=this.to_hex();return t===a.HEX_ONE?1:t},a.prototype.to_human=function(){return this.to_json()},e.Currency=a},function(t,e,r){function n(t){return s.codec.bytes.fromBits(s.hash.sha256.hash(s.codec.bytes.toBits(t)))}function i(t){return n(n(t))}var s=r(87).sjcl,o=r(87),a=r(109),c=o.jsbn.BigInteger,u={},h=u.alphabets={ripple:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz",tipple:"RPShNAF39wBUDnEGHJKLM4pQrsT7VWXYZ2bcdeCg65jkm8ofqi1tuvaxyz",bitcoin:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"};a(u,{VER_NONE:1,VER_NODE_PUBLIC:28,VER_NODE_PRIVATE:32,VER_ACCOUNT_ID:0,VER_ACCOUNT_PUBLIC:35,VER_ACCOUNT_PRIVATE:34,VER_FAMILY_GENERATOR:41,VER_FAMILY_SEED:33}),u.encode=function(t,e){for(var r=h[e||"ripple"],n=new c(String(r.length)),i=new c,s=new c,o=new c(t),a=[];o.compareTo(c.ZERO)>0;)o.divRemTo(n,i,s),i.copyTo(o),a.push(r[s.intValue()]);for(var u=0;u!==t.length&&!t[u];u+=1)a.push(r[0]);return a.reverse().join("")},u.decode=function(t,e){if("string"!=typeof t)return void 0;var r,n=h[e||"ripple"],i=new c(String(n.length)),s=new c;for(r=0;r!=t.length&&t[r]===n[0];r+=1);for(;r!==t.length;r+=1){var a=n.indexOf(t[r]);if(0>a)return void 0;var u=new c;u.fromInt(a),s=s.multiply(i).add(u)}for(var f=s.toByteArray().map(function(t){return t?0>t?256+t:t:0}),l=0;l!=f.length&&!f[l];)l+=1;l&&(f=f.slice(l));for(var p=0;p!==t.length&&t[p]===n[0];)p+=1;return[].concat(o.arraySet(p,0),f)},u.verify_checksum=function(t){for(var e=i(t.slice(0,-4)).slice(0,4),r=t.slice(-4),n=!0,s=0;4>s;s++)if(e[s]!==r[s]){n=!1;break}return n},u.encode_check=function(t,e,r){var i=[].concat(t,e),s=n(n(i)).slice(0,4);return u.encode([].concat(i,s),r)},u.decode_check=function(t,e,r){var n=u.decode(e,r);if(!n||n.length<5)return 0/0;if("number"==typeof t&&n[0]!==t)return 0/0;if(Array.isArray(t)){for(var i=!1,s=0,o=t.length;o>s;s++)i|=t[s]===n[0];if(!i)return 0/0}return u.verify_checksum(n)?(n[0]=0,new c(n.slice(0,-4),256)):0/0},e.Base=u},function(t,e,r){function n(t){var e=this;this.nodes=[],t.AffectedNodes.forEach(function(t){var r={};(r.diffType=e.diffType(t))&&(t=t[r.diffType],r.entryType=t.LedgerEntryType,r.ledgerIndex=t.LedgerIndex,r.fields=i({},t.PreviousFields,t.NewFields,t.FinalFields),r.fieldsPrev=t.PreviousFields||{},r.fieldsNew=t.NewFields||{},r.fieldsFinal=t.FinalFields||{},e.nodes.push(r))})}var i=r(109),s=r(87),o=r(96).UInt160,a=r(78).Amount;n.node_types=["CreatedNode","ModifiedNode","DeletedNode"],n.prototype.diffType=function(t){for(var e=!1,r=0;r<n.node_types.length;r++){var i=n.node_types[r];if(t.hasOwnProperty(i)){e=i;break}}return e},n.prototype.each=function(t){for(var e=0,r=this.nodes.length;r>e;e++)t(this.nodes[e],e)},["forEach","map","filter","every","reduce"].forEach(function(t){n.prototype[t]=function(){return Array.prototype[t].apply(this.nodes,arguments)}});var c=["LowLimit","HighLimit","TakerPays","TakerGets"];n.prototype.getAffectedAccounts=function(){var t=[];return this.nodes.forEach(function(e){var r="CreatedNode"===e.diffType?e.fieldsNew:e.fieldsFinal;for(var n in r){var i=r[n];if("string"==typeof i&&o.is_valid(i))t.push(i);else if(-1!==c.indexOf(n)){var s=a.from_json(i),u=s.issuer();u.is_valid()&&!u.is_zero()&&t.push(u.to_json())}}}),s.arrayUnique(t)},n.prototype.getAffectedBooks=function(){var t=[];return this.nodes.forEach(function(e){if("Offer"===e.entryType){var r=a.from_json(e.fields.TakerGets),n=a.from_json(e.fields.TakerPays),i=r.currency().to_json();"XRP"!==i&&(i+="/"+r.issuer().to_json());var s=n.currency().to_json();"XRP"!==s&&(s+="/"+n.issuer().to_json());var o=[i,s].join(":");t.push(o)}}),s.arrayUnique(t)},e.Meta=n},function(t,e,r){(function(t){function n(e){if(Array.isArray(e)||t&&t.isBuffer(e))this.buffer=e;else if("string"==typeof e)this.buffer=f.codec.bytes.fromBits(f.codec.hex.toBits(e));else{if(e)throw new Error("Invalid buffer passed.");this.buffer=[]}this.pointer=0}function i(t){return function(e){var r=this.pointer,n=r+e;if(n>this.buffer.length)throw new Error("Buffer length exceeded");var i=this.buffer.slice(r,n);return t&&(this.pointer=n),i}}var s=r(86),o=r(109),a=r(103),c=r(104).UInt256,u=r(40),h=r(87),f=h.sjcl,l=h.jsbn.BigInteger,p={};Object.keys(s.tx).forEach(function(t){p[s.tx[t][0]]=t});var _={};Object.keys(s.ledger).forEach(function(t){_[s.ledger[t][0]]=t});var d={};Object.keys(s.ter).forEach(function(t){d[s.ter[t]]=t}),n.from_json=function(t){var e,t=o({},t),r=new n;if("number"==typeof t.TransactionType&&(t.TransactionType=n.lookup_type_tx(t.TransactionType),!t.TransactionType))throw new Error("Transaction type ID is invalid.");if("string"==typeof t.TransactionType){if(e=s.tx[t.TransactionType],!Array.isArray(e))throw new Error("Transaction type is invalid");e=e.slice(),t.TransactionType=e.shift()}else{if("undefined"!=typeof t.LedgerEntryType)throw new Error("Ledger entry binary format not yet implemented.");if("object"!=typeof t.AffectedNodes)throw new Error("Object to be serialized must contain either TransactionType, LedgerEntryType or AffectedNodes.");e=s.metadata}return n.check_no_missing_fields(e,t),r.serialize(e,t),r},n.check_no_missing_fields=function(t,e){for(var r=[],i=t.length-1;i>=0;i--){var o=t[i],a=o[0],c=o[1];s.REQUIRED===c&&null==e[a]&&r.push(a)}if(r.length>0){var u;throw u=null!=e.TransactionType?n.lookup_type_tx(e.TransactionType):"TransactionMetaData",new Error(u+" is missing fields: "+JSON.stringify(r))}},n.prototype.append=function(t){t instanceof n&&(t=t.buffer),this.buffer=this.buffer.concat(t),this.pointer+=t.length},n.prototype.resetPointer=function(){this.pointer=0},n.prototype.read=i(!0),n.prototype.peek=i(!1),n.prototype.to_bits=function(){return f.codec.bytes.toBits(this.buffer)
},n.prototype.to_hex=function(){return f.codec.hex.fromBits(this.to_bits()).toUpperCase()},n.prototype.to_json=function(){var t=this.pointer;this.resetPointer();for(var e={};this.pointer<this.buffer.length;){var r=a.parse(this),i=r[0],s=r[1];e[i]=n.jsonify_structure(s,i)}return this.pointer=t,e},n.jsonify_structure=function(t,e){var r;switch(typeof t){case"number":switch(e){case"LedgerEntryType":r=_[t];break;case"TransactionResult":r=d[t];break;case"TransactionType":r=p[t];break;default:r=t}break;case"object":if(!t)break;if("function"==typeof t.to_json)r=t.to_json();else if(t instanceof l)r=t.toString(16).toUpperCase();else{r=new t.constructor;for(var i=Object.keys(t),s=0,o=i.length;o>s;s++){var a=i[s];r[a]=n.jsonify_structure(t[a],a)}}break;default:r=t}return r},n.prototype.serialize=function(t,e){a.Object.serialize(this,e,!0)},n.prototype.hash=function(t){var e=new n;return a.Int32.serialize(e,t),e.append(this.buffer),e.hash_sha512_half()},n.prototype.signing_hash=n.prototype.hash,n.prototype.hash_sha512_half=function(){var t=f.codec.bytes.toBits(this.buffer),e=f.bitArray.bitSlice(f.hash.sha512.hash(t),0,256);return c.from_hex(f.codec.hex.fromBits(e))},n.prototype.serialize_field=function(t,e){{var r=t[0],n=t[1];t[2],a[t[3]]}if("undefined"!=typeof e[r])try{a.serialize(this,r,e[r])}catch(i){throw i.message='Error serializing "'+r+'": '+i.message,i}else if(n===s.REQUIRED)throw new Error("Missing required field "+r)},n.get_field_header=function(t,e){var r=[0];return t>15?r.push(255&t):r[0]+=(15&t)<<4,e>15?r.push(255&e):r[0]+=15&e,r},n.sort_typedef=function(t){function e(t,e){return t[3]!==e[3]?a[t[3]].id-a[e[3]].id:t[2]-e[2]}return u(Array.isArray(t)),t.sort(e)},n.lookup_type_tx=function(t){return u("number"==typeof t),p[t]},e.SerializedObject=n}).call(e,r(41).Buffer)},function(t,e,r){function n(t,e){switch(typeof t){case"object":s(this,t);break;case"string":this.result=t,this.result_message=e}this.engine_result=this.result=this.result||this.engine_result||this.error||"Error",this.engine_result_message=this.result_message=this.result_message||this.engine_result_message||this.error_message||"Error",this.result_message=this.message=this.result_message;var r;Error.captureStackTrace?Error.captureStackTrace(this,t||this):(r=(new Error).stack)&&(this.stack=r)}var i=r(38),s=r(109);i.inherits(n,Error),n.prototype.name="RippleError",e.RippleError=n},function(t,e){var r=e.REQUIRED=0,n=e.OPTIONAL=1,i=e.DEFAULT=2,s=[["TransactionType",r,2,"Int16"],["Flags",n,2,"Int32"],["SourceTag",n,3,"Int32"],["Account",r,1,"Account"],["Sequence",r,4,"Int32"],["Fee",r,8,"Amount"],["OperationLimit",n,29,"Int32"],["SigningPubKey",r,3,"VariableLength"],["TxnSignature",n,4,"VariableLength"]];e.tx={AccountSet:[3].concat(s,[["EmailHash",n,1,"Hash128"],["WalletLocator",n,7,"Hash256"],["WalletSize",n,12,"Int32"],["MessageKey",n,2,"VariableLength"],["Domain",n,7,"VariableLength"],["TransferRate",n,11,"Int32"]]),TrustSet:[20].concat(s,[["LimitAmount",n,3,"Amount"],["QualityIn",n,20,"Int32"],["QualityOut",n,21,"Int32"]]),OfferCreate:[7].concat(s,[["TakerPays",r,4,"Amount"],["TakerGets",r,5,"Amount"],["Expiration",n,10,"Int32"]]),OfferCancel:[8].concat(s,[["OfferSequence",r,25,"Int32"]]),SetRegularKey:[5].concat(s,[["RegularKey",r,8,"Account"]]),Payment:[0].concat(s,[["Destination",r,3,"Account"],["Amount",r,1,"Amount"],["SendMax",n,9,"Amount"],["Paths",i,1,"PathSet"],["InvoiceID",n,17,"Hash256"],["DestinationTag",n,14,"Int32"]]),Contract:[9].concat(s,[["Expiration",r,10,"Int32"],["BondAmount",r,23,"Int32"],["StampEscrow",r,22,"Int32"],["RippleEscrow",r,17,"Amount"],["CreateCode",n,11,"VariableLength"],["FundCode",n,8,"VariableLength"],["RemoveCode",n,9,"VariableLength"],["ExpireCode",n,10,"VariableLength"]]),RemoveContract:[10].concat(s,[["Target",r,7,"Account"]]),EnableFeature:[100].concat(s,[["Feature",r,19,"Hash256"]]),SetFee:[101].concat(s,[["Features",r,9,"Array"],["BaseFee",r,5,"Int64"],["ReferenceFeeUnits",r,30,"Int32"],["ReserveBase",r,31,"Int32"],["ReserveIncrement",r,32,"Int32"]])},e.ledger={AccountRoot:[97],Contract:[99],DirectoryNode:[100],Features:[102],GeneratorMap:[103],LedgerHashes:[104],Nickname:[110],Offer:[111],RippleState:[114],FeeSettings:[115]},e.metadata=[["TransactionIndex",r,28,"Int32"],["TransactionResult",r,3,"Int8"],["AffectedNodes",r,8,"Array"]],e.ter={tesSUCCESS:0,tecCLAIM:100,tecPATH_PARTIAL:101,tecUNFUNDED_ADD:102,tecUNFUNDED_OFFER:103,tecUNFUNDED_PAYMENT:104,tecFAILED_PROCESSING:105,tecDIR_FULL:121,tecINSUF_RESERVE_LINE:122,tecINSUF_RESERVE_OFFER:123,tecNO_DST:124,tecNO_DST_INSUF_XRP:125,tecNO_LINE_INSUF_RESERVE:126,tecNO_LINE_REDUNDANT:127,tecPATH_DRY:128,tecUNFUNDED:129,tecMASTER_DISABLED:130,tecNO_REGULAR_KEY:131,tecOWNERS:132}},function(t,e,r){var e=t.exports=r(92);e.logObject=function(t){var e=Array.prototype.slice.call(arguments,1);e=e.map(function(t){return/MSIE/.test(navigator.userAgent)?JSON.stringify(t,null,2):t}),e.unshift(t),console.log.apply(console,e)}},function(t,e,r){function n(t,e){if(s.call(this),"object"!=typeof e)throw new Error("Invalid server configuration.");var r=this;this._remote=t,this._opts=e,this._host=e.host,this._port=e.port,this._secure="boolean"==typeof e.secure?e.secure:!0,this._ws=void 0,this._connected=!1,this._shouldConnect=!1,this._state="offline",this._id=0,this._retry=0,this._requests={},this._load_base=256,this._load_factor=256,this._fee_ref=10,this._fee_base=10,this._reserve_base=void 0,this._reserve_inc=void 0,this._fee_cushion=this._remote.fee_cushion,this._opts.url=(e.secure?"wss://":"ws://")+e.host+":"+e.port,this.on("message",function(t){r._handleMessage(t)}),this.on("response_subscribe",function(t){r._handleResponseSubscribe(t)}),this.on("disconnect",function(){clearInterval(r._activityInterval)}),this.once("ledger_closed",function(){})}{var i=r(38),s=r(37).EventEmitter,o=r(80).Transaction,a=r(78).Amount;r(87)}i.inherits(n,s),n.onlineStates=["syncing","tracking","proposing","validating","full"],n.prototype._setState=function(t){if(t!==this._state)switch(this._remote._trace("server: set_state:",t),this._state=t,this.emit("state",t),t){case"online":this._connected=!0,this.emit("connect");break;case"offline":this._connected=!1,this.emit("disconnect")}},n.prototype._remoteAddress=function(){try{var t=this._ws._socket.remoteAddress}catch(e){}return t},n.websocketConstructor=function(){return r(116)},n.prototype.disconnect=function(){this._shouldConnect=!1,this._setState("offline"),this._ws&&this._ws.close()},n.prototype.reconnect=function(){this._ws&&(this.once("disconnect",this.connect.bind(this)),this.disconnect())},n.prototype.connect=function(){var t=this;if(!this._connected){this._remote._trace("server: connect:",this._opts.url),this._ws&&this._ws.close();var e=n.websocketConstructor();if(!e)throw new Error("No websocket support detected!");var r=this._ws=new e(this._opts.url);this._shouldConnect=!0,t.emit("connecting"),r.onmessage=function(e){t.emit("message",e.data)},r.onopen=function(){r===t._ws&&(t.emit("socket_open"),t.request(t._remote._serverPrepareSubscribe()))},r.onerror=function(e){r===t._ws&&(t.emit("socket_error"),t._remote._trace("server: onerror:",t._opts.url,e.data||e),t._handleClose())},r.onclose=function(){r===t._ws&&(t._remote._trace("server: onclose:",t._opts.url,r.readyState),t._handleClose())}}},n.prototype._retryConnect=function(){function t(){e._shouldConnect&&(e._remote._trace("server: retry",e._opts.url),e.connect())}var e=this;this._retry+=1;var r=this._retry<40?50:this._retry<100?1e3:this._retry<160?1e4:3e4;this._retryTimer=setTimeout(t,r)},n.prototype._handleClose=function(){var t=this,e=this._ws;this.emit("socket_close"),this._setState("offline"),e.onopen=e.onerror=e.onclose=e.onmessage=function(){},t._shouldConnect&&this._retryConnect()},n.prototype._handleMessage=function(t){var e=this;try{t=JSON.parse(t)}catch(r){}if(n.isValidMessage(t))switch(t.type){case"ledgerClosed":this._lastLedgerClose=Date.now(),this.emit("ledger_closed",t);break;case"serverStatus":if(this._setState(~n.onlineStates.indexOf(t.server_status)?"online":"offline"),n.isLoadStatus(t)){e.emit("load",t,e),e._remote.emit("load",t,e);var i=t.load_base!==e._load_base||t.load_factor!==e._load_factor;i&&(e._load_base=t.load_base,e._load_factor=t.load_factor,e.emit("load_changed",t,e),e._remote.emit("load_changed",t,e))}break;case"response":var s=e._requests[t.id];delete e._requests[t.id],s?"success"===t.status?(this._remote._trace("server: response:",e._opts.url,t),s.emit("success",t.result),[e,e._remote].forEach(function(e){e.emit("response_"+s.message.command,t.result,s,t)})):t.error&&(this._remote._trace("server: error:",e._opts.url,t),s.emit("error",{error:"remoteError",error_message:"Remote reported an error.",remote:t})):this._remote._trace("server: UNEXPECTED:",e._opts.url,t);break;case"path_find":this._remote._trace("server: path_find:",e._opts.url,t)}},n.isValidMessage=function(t){return"object"==typeof t&&"string"==typeof t.type},n.isLoadStatus=function(t){return"number"==typeof t.load_base&&"number"==typeof t.load_factor},n.prototype._handleResponseSubscribe=function(t){~n.onlineStates.indexOf(t.server_status)&&this._setState("online"),n.isLoadStatus(t)&&(this._load_base=t.load_base||256,this._load_factor=t.load_factor||256,this._fee_ref=t.fee_ref,this._fee_base=t.fee_base,this._reserve_base=t.reserve_base,this._reserve_inc=t.reserve_inc)},n.prototype.sendMessage=function(t){this._ws&&(this._remote._trace("server: request:",this._opts.url,t),this._ws.send(JSON.stringify(t)))},n.prototype.request=function(t){function e(){r.sendMessage(t.message)}var r=this;return this._ws?(t.server=this,t.message.id=this._id,this._requests[t.message.id]=t,this._id++,void(this._isConnected(t)?this.sendMessage(t.message):this.once("connect",e))):void this._remote._trace("server: request: DROPPING:",r._opts.url,t.message)},n.prototype._isConnected=function(t){var e=t&&"subscribe"===t.message.command&&1===this._ws.readyState;return this._connected||this._ws&&e},n.prototype.computeFee=function(t){var e;if(t instanceof o)e=t.feeUnits();else{if("number"!=typeof t)throw new Error("Invalid argument");e=t}return this.feeTx(e).to_json()},n.prototype.feeTx=function(t){var e=this.feeTxUnit();return a.from_json(String(Math.ceil(t*e)))},n.prototype.feeTxUnit=function(){var t=this._fee_base/this._fee_ref;return t*=this._load_factor/this._load_base,t*=this._fee_cushion},n.prototype.reserve=function(t){var e=a.from_json(String(this._reserve_base)),r=a.from_json(String(this._reserve_inc)),t=t||0;if(0>t)throw new Error("Owner count must not be negative.");return e.add(r.product_human(t))},e.Server=n},function(t,e,r){var n=r(109),i=t.exports={load:function(t){return n(i,t),i}}},function(t,e,r){(function(e){function r(t,e,r){return t^e^r}function n(t,e,r){return t&e|~t&r}function i(t,e,r){return(t|~e)^r}function s(t,e,r){return t&r|e&~r}function o(t,e,r){return t^(e|~r)}function a(t,e){return t<<e|t>>>32-e}function c(t){var r=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof t&&(t=new e(t,"utf8"));var n=d(t),i=8*t.length,s=8*t.length;n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);for(var o=0;o<n.length;o+=16)m(r,n,o);for(var o=0;5>o;o++){var a=r[o];r[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var c=y(r);return new e(c)}t.exports=c;/** @preserve
	(c) 2012 by Cédric Mesnil. All rights reserved.
	
	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
	
	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
	
	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/
var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],_=[1352829926,1548603684,1836072691,2053994217,0],d=function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},y=function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},m=function(t,e,c){for(var d=0;16>d;d++){var y=c+d,m=e[y];e[y]=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8)}var v,g,b,w,E,x,S,A,T,k;x=v=t[0],S=g=t[1],A=b=t[2],T=w=t[3],k=E=t[4];for(var j,d=0;80>d;d+=1)j=v+e[c+u[d]]|0,j+=16>d?r(g,b,w)+p[0]:32>d?n(g,b,w)+p[1]:48>d?i(g,b,w)+p[2]:64>d?s(g,b,w)+p[3]:o(g,b,w)+p[4],j=0|j,j=a(j,f[d]),j=j+E|0,v=E,E=w,w=a(b,10),b=g,g=j,j=x+e[c+h[d]]|0,j+=16>d?o(S,A,T)+_[0]:32>d?s(S,A,T)+_[1]:48>d?i(S,A,T)+_[2]:64>d?n(S,A,T)+_[3]:r(S,A,T)+_[4],j=0|j,j=a(j,l[d]),j=j+k|0,x=k,k=T,T=a(A,10),A=S,S=j;j=t[1]+b+T|0,t[1]=t[2]+w+k|0,t[2]=t[3]+E+x|0,t[3]=t[4]+v+S|0,t[4]=t[0]+g+A|0,t[0]=j}}).call(e,r(41).Buffer)},function(t){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,r){function n(t,e){return function(){console.log("%s: %s",n,arguments.toString),e(arguments)}}function i(t,e){for(var r=new Array(t),n=0;t>n;n++)r[n]=e;return r}function s(t){var e=[],r=0;for(t.length%2&&(e.push(String.fromCharCode(parseInt(t.substring(0,1),16))),r=1);r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substring(r,r+2),16)));return e.join("")}function o(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);e+=16>n?"0"+n.toString(16):n.toString(16)}return e}function a(t){for(var e=new Array(t.length),r=0;r<e.length;r+=1)e[r]=t.charCodeAt(r);return e}function c(t){return a(s(t))}function u(t,e,r){var n=[],i=0,s=t.length;for(r&&(i=t.length%e,i&&n.push(t.slice(0,i)));s>i;i+=e)n.push(t.slice(i,e+i));return n}function h(t){var e=Array.prototype.slice.call(arguments,1);e=e.map(function(t){return JSON.stringify(t,null,2)}),e.unshift(t),console.log.apply(console,e)}function f(t,e){if(!t)throw new Error("Assertion failed"+(e?": "+e:"."))}function l(t){for(var e={},r=[],n=0,i=t.length;i>n;n++){var s=t[n];e[s]||(r.push(s),e[s]=!0)}return r}function p(t){return 1e3*(t+946684800)}function _(t){return t instanceof Date&&(t=t.getTime()),Math.round(t/1e3)-946684800}Function.prototype.method=function(t,e){return this.prototype[t]=e,this},e.trace=n,e.arraySet=i,e.hexToString=s,e.hexToArray=c,e.stringToArray=a,e.stringToHex=o,e.chunkString=u,e.logObject=h,e.assert=f,e.arrayUnique=l,e.toTimestamp=p,e.fromTimestamp=_,e.sjcl=r(114),e.jsbn=r(115)},function(t,e,r){var n=r(108),i=n.write,s=n.zeroFill;t.exports=function(t){function e(e,r){this._block=new t(e),this._finalSize=r,this._blockSize=e,this._len=0,this._s=0}function r(t,e){return null==e?t.byteLength||t.length:"ascii"==e||"binary"==e?t.length:"hex"==e?t.length/2:"base64"==e?t.length/3:void 0}return e.prototype.init=function(){this._s=0,this._len=0},e.prototype.update=function(e,n){var s,o=this._blockSize;n||"string"!=typeof e||(n="utf8"),n?("utf-8"===n&&(n="utf8"),("base64"===n||"utf8"===n)&&(e=new t(e,n),n=null),s=r(e,n)):s=e.byteLength||e.length;for(var a=this._len+=s,c=this._s=this._s||0,u=0,h=this._block;a>c;){var f=Math.min(s,u+o);i(h,e,n,c%o,u,f);var l=f-u;c+=l,u+=l,c%o||this._update(h)}return this._s=c,this},e.prototype.digest=function(t){var e=this._blockSize,r=this._finalSize,i=8*this._len,o=this._block,a=i%(8*e);o[this._len%e]=128,s(this._block,this._len%e+1),a>=8*r&&(this._update(this._block),n.zeroFill(this._block,0)),o.writeInt32BE(i,r+4);var c=this._update(this._block)||this._hash();return null==t?c:c.toString(t)},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e}},function(t,e,r){t.exports=function(t,e){function n(){return d.length?d.pop().init():this instanceof n?(this._w=_,e.call(this,64,56),this._h=null,void this.init()):new n}function i(t,e,r,n){return 20>t?e&r|~e&n:40>t?e^r^n:60>t?e&r|e&n|r&n:e^r^n}function s(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514}function o(t,e){return t+e|0}function a(t,e){return t<<e|t>>>32-e}var c=r(38).inherits;c(n,e);var u=0,h=4,f=8,l=12,p=16,_=new Int32Array(80),d=[];n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,e.prototype.init.call(this),this},n.prototype._POOL=d;new t(1)instanceof DataView;return n.prototype._update=function(){{var t,e,r,n,c,u,h,f,l,p,_=this._block;this._h}t=u=this._a,e=h=this._b,r=f=this._c,n=l=this._d,c=p=this._e;for(var d=this._w,y=0;80>y;y++){var m=d[y]=16>y?_.readInt32BE(4*y):a(d[y-3]^d[y-8]^d[y-14]^d[y-16],1),v=o(o(a(t,5),i(y,e,r,n)),o(o(c,m),s(y)));c=n,n=r,r=a(e,30),e=t,t=v}this._a=o(t,u),this._b=o(e,h),this._c=o(r,f),this._d=o(n,l),this._e=o(c,p)},n.prototype._hash=function(){d.length<100&&d.push(this);var e=new t(20);return e.writeInt32BE(0|this._a,u),e.writeInt32BE(0|this._b,h),e.writeInt32BE(0|this._c,f),e.writeInt32BE(0|this._d,l),e.writeInt32BE(0|this._e,p),e},n}},function(t,e,r){{var n=r(38).inherits;r(108)}t.exports=function(t,e){function r(){_.length,this.init(),this._w=p,e.call(this,64,56)}function i(t,e){return t>>>e|t<<32-e}function s(t,e){return t>>>e}function o(t,e,r){return t&e^~t&r}function a(t,e,r){return t&e^t&r^e&r}function c(t){return i(t,2)^i(t,13)^i(t,22)}function u(t){return i(t,6)^i(t,11)^i(t,25)}function h(t){return i(t,7)^i(t,18)^s(t,3)}function f(t){return i(t,17)^i(t,19)^s(t,10)}var l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];n(r,e);var p=new Array(64),_=[];r.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this};return r.prototype._update=function(){var t,e,r,n,i,s,p,_,d,y,m=this._block,v=this._w;t=0|this._a,e=0|this._b,r=0|this._c,n=0|this._d,i=0|this._e,s=0|this._f,p=0|this._g,_=0|this._h;for(var g=0;64>g;g++){var b=v[g]=16>g?m.readInt32BE(4*g):f(v[g-2])+v[g-7]+h(v[g-15])+v[g-16];d=_+u(i)+o(i,s,p)+l[g]+b,y=c(t)+a(t,e,r),_=p,p=s,s=i,i=n+d,n=r,r=e,e=t,t=d+y}this._a=t+this._a|0,this._b=e+this._b|0,this._c=r+this._c|0,this._d=n+this._d|0,this._e=i+this._e|0,this._f=s+this._f|0,this._g=p+this._g|0,this._h=_+this._h|0},r.prototype._hash=function(){_.length<10&&_.push(this);var e=new t(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},r}},function(t,e,r){var n=(r(87).sjcl,r(87)),i=r(89),s=r(109),o=n.jsbn.BigInteger,a=r(110).UInt,c=r(82).Base,u=s(function(){this._value=0/0,this._version_byte=void 0,this._update()},a);u.width=20,u.prototype=s({},a.prototype),u.prototype.constructor=u;{var h=(u.ACCOUNT_ZERO="rrrrrrrrrrrrrrrrrrrrrhoLvTp",u.ACCOUNT_ONE="rrrrrrrrrrrrrrrrrrrrBZbvji",u.HEX_ZERO="0000000000000000000000000000000000000000"),f=u.HEX_ONE="0000000000000000000000000000000000000001";u.STR_ZERO=n.hexToString(h),u.STR_ONE=n.hexToString(f)}u.prototype.set_version=function(t){return this._version_byte=t,this},u.prototype.get_version=function(){return this._version_byte},u.prototype.parse_json=function(t){return i.accounts&&t in i.accounts&&(t=i.accounts[t].account),"number"!=typeof t||isNaN(t)?"string"!=typeof t?this._value=0/0:"r"===t[0]?(this._value=c.decode_check(c.VER_ACCOUNT_ID,t),this._version_byte=c.VER_ACCOUNT_ID):this.parse_hex(t):(this._value=new o(String(t)),this._version_byte=c.VER_ACCOUNT_ID),this._update(),this},u.prototype.parse_generic=function(t){return a.prototype.parse_generic.call(this,t),isNaN(this._value)&&"string"==typeof t&&"r"===t[0]&&(this._value=c.decode_check(c.VER_ACCOUNT_ID,t)),this._update(),this},u.prototype.to_json=function(t){if(t=t||{},this._value instanceof o){if("number"==typeof this._version_byte){var e=c.encode_check(this._version_byte,this.to_bytes());return t.gateways&&e in t.gateways&&(e=t.gateways[e]),e}return this.to_hex()}return 0/0},e.UInt160=u},function(t,e,r){function n(t,e,r,s,o){function a(t){~n.subscribe_events.indexOf(t)&&(h._subs+=1,1==h._subs&&h._remote._connected&&h._subscribe())}function c(t){~n.subscribe_events.indexOf(t)&&(h._subs-=1,!h._subs&&h._remote._connected&&(h._sync=!1,h._remote.request_unsubscribe().books([h.to_json()]).request()))}function u(){h._sync=!1}i.call(this);var h=this;return this._remote=t,this._currency_gets=e,this._issuer_gets=r,this._currency_pays=s,this._issuer_pays=o,this._subs=0,this._sync=!1,this._offers=[],this.on("newListener",a),this.on("removeListener",c),this._remote.on("prepare_subscribe",function(t){h._subscribe(t)}),this._remote.on("disconnect",u),this}var i=r(37).EventEmitter,s=r(38),o=r(109),a=r(78).Amount,c=r(96).UInt160,u=r(81).Currency;s.inherits(n,i),n.subscribe_events=["transaction","model","trade"],n.prototype._subscribe=function(t){var e=this;if(e.is_valid()&&e._subs){var t=this._remote.request_subscribe();t.addBook(e.to_json(),!0),t.once("success",function(t){e._sync=!0,e._offers=t.offers,e.emit("model",e._offers)}),t.once("error",function(){}),t.request()}},n.prototype.to_json=function(){var t={taker_gets:{currency:this._currency_gets},taker_pays:{currency:this._currency_pays}};return"XRP"!==this._currency_gets&&(t.taker_gets.issuer=this._issuer_gets),"XRP"!==this._currency_pays&&(t.taker_pays.issuer=this._issuer_pays),t},n.prototype.is_valid=function(){return u.is_valid(this._currency_pays)&&("XRP"===this._currency_pays||c.is_valid(this._issuer_pays))&&u.is_valid(this._currency_gets)&&("XRP"===this._currency_gets||c.is_valid(this._issuer_gets))&&!("XRP"===this._currency_pays&&"XRP"===this._currency_gets)},n.prototype.trade=function(t){var e="0"+("XRP"===this["_currency_"+t]?"":"/"+this["_currency_"+t]+"/"+this["_issuer_"+t]);return a.from_json(e)},n.prototype.notify=function(t){function e(e){if("Offer"===e.entryType){var c,u,h;switch(e.diffType){case"DeletedNode":case"ModifiedNode":var f="DeletedNode"===e.diffType;for(c=0,u=r._offers.length;u>c;c++)if(h=r._offers[c],h.index===e.ledgerIndex){f?r._offers.splice(c,1):o(h,e.fieldsFinal),n=!0;break}if("OfferCancel"===t.transaction.TransactionType)return;i=i.add(e.fieldsPrev.TakerGets),s=s.add(e.fieldsPrev.TakerPays),f||(i=i.subtract(e.fieldsFinal.TakerGets),s=s.subtract(e.fieldsFinal.TakerPays));break;case"CreatedNode":var l=a.from_json(e.fields.TakerPays).ratio_human(e.fields.TakerGets);for(c=0,u=r._offers.length;u>c;c++){h=r._offers[c];var p=a.from_json(h.TakerPays).ratio_human(h.TakerGets);if(l.compareTo(p)<=0){var _=e.fields;_.index=e.ledgerIndex,r._offers.splice(c,0,e.fields),n=!0;break}}}}}var r=this,n=!1,i=this.trade("gets"),s=this.trade("pays");t.mmeta.each(e),this._subs&&(this.emit("transaction",t),n&&this.emit("model",this._offers),i.is_zero()||this.emit("trade",s,i))},n.prototype.notifyTx=n.prototype.notify,n.prototype.offers=function(t){return"function"==typeof t&&(this._sync?t(this._offers):this.once("model",t)),this},n.prototype.offersSync=function(){return this._offers},e.OrderBook=n},function(t,e,r){function n(t,e,r,n,s){i.call(this),this.remote=t,this.src_account=e,this.dst_account=r,this.dst_amount=n,this.src_currencies=s}{var i=r(37).EventEmitter,s=r(38),o=r(78).Amount;r(109)}s.inherits(n,i),n.prototype.create=function(){function t(t,r){t?e.emit("error",t):e.notify_update(r)}var e=this,r=this.remote.request_path_find_create(this.src_account,this.dst_account,this.dst_amount,this.src_currencies,t);r.request()},n.prototype.close=function(){this.remote.request_path_find_close().request(),this.emit("end"),this.emit("close")},n.prototype.notify_update=function(t){var e=t.source_account,r=t.destination_account,n=o.from_json(t.destination_amount);this.src_account===e&&this.dst_account===r&&this.dst_amount.equals(n)&&this.emit("update",t)},n.prototype.notify_superceded=function(){this.emit("end"),this.emit("superceded")},e.PathFind=n},function(t,e,r){function n(t,e){return[].concat(t,e>>24,e>>16&255,e>>8&255,255&e)}function i(t){return o.bitArray.bitSlice(o.hash.sha512.hash(o.codec.bytes.toBits(t)),0,256)}var s=r(87),o=s.sjcl,a=r(109),c=s.jsbn.BigInteger,u=r(82).Base,h=r(110).UInt,f=(r(104).UInt256,r(111).KeyPair),l=a(function(){this._curve=o.ecc.curves.c256,this._value=0/0},h);l.width=16,l.prototype=a({},h.prototype),l.prototype.constructor=l,l.prototype.parse_json=function(t){return"string"==typeof t&&t.length?"s"===t[0]?this._value=u.decode_check(u.VER_FAMILY_SEED,t):32===t.length?this._value=this.parse_hex(t):this.parse_passphrase(t):this._value=0/0,this},l.prototype.parse_passphrase=function(t){if("string"!=typeof t)throw new Error("Passphrase must be a string");var e=o.hash.sha512.hash(o.codec.utf8String.toBits(t)),r=o.bitArray.bitSlice(e,0,128);return this.parse_bits(r),this},l.prototype.to_json=function(){if(!(this._value instanceof c))return 0/0;var t=u.encode_check(u.VER_FAMILY_SEED,this.to_bytes());return t},l.prototype.get_key=function(){if(!this.is_valid())throw new Error("Cannot generate keys from invalid seed!");var t,e,r=this._curve,s=0,a=0;do t=o.bn.fromBits(i(n(this.to_bytes(),a))),a++;while(!r.r.greaterEquals(t));e=r.G.mult(t);var c;a=0;do c=o.bn.fromBits(i(n(n(e.toBytesCompressed(),s),a))),a++;while(!r.r.greaterEquals(c));return c=c.add(t).mod(r.r),f.from_bn_secret(c)},e.Seed=l},function(t,e,r){function n(t){function e(t){var e=n.normalizeTransaction(t),r=e.transaction.Sequence,i=e.transaction.hash;if(e.validated){f._pending.addReceivedSequence(r);var s=f._pending.getSubmission(i);f._remote._trace("transactionmanager: transaction_received:",e.transaction),s?s.emit("success",e):f._pending.addReceivedId(i,e)}}function r(t,e){f._pending.forEach(function(t){var r=t._server===e&&f._remote.local_fee&&t.tx_json.Fee;if(r){var n=t.tx_json.Fee,i=e.computeFee(t);t.tx_json.Fee=i,t.emit("fee_adjusted",n,i),f._remote._trace("transactionmanager: adjusting_fees:",t.tx_json,n,i)}})}function i(t){f._pending.forEach(function(e){switch(e.lastLedger=t,t.ledger_index-e.submitIndex){case 8:e.emit("lost",t),f._remote._trace("transactionmanager: update_pending:",e.tx_json);break;case 4:e.setState("client_missing"),e.emit("missing",t)}})}function o(t){var r={account:f._accountID,ledger_index_min:-1,ledger_index_max:-1,limit:100};f._remote.requestAccountTx(r,function(r,n){!r&&n.transactions&&n.transactions.forEach(e),f._remote.on("ledger_closed",i),f._loadSequence(function(){f._resubmit()}),"function"==typeof t&&t()}),f.emit("reconnect")}function a(){f._remote.once("connect",o),f._remote.removeListener("ledger_closed",i)}function u(){f._remote.storage.loadAccount(f._accountID,function(t,e){!t&&e&&(e||[]).forEach(function(t){var e=f._remote.transaction();e.parseJson(t.tx_json),e.submittedIDs=t.submittedIDs,f.submit(e)})})}function h(t){f._remote.storage.saveAccount(f._accountID,t)}s.call(this);var f=this;this._account=t,this._accountID=t._account_id,this._remote=t._remote,this._nextSequence=void 0,this._maxFee=this._remote.max_fee,this._submissionTimeout=this._remote._submission_timeout,this._pending=new c,this._loadSequence(),this._account.on("transaction-outbound",e),this._remote.on("load_changed",r),this._remote.on("ledger_closed",i),this._remote.on("disconnect",a),this._remote.storage&&(o(u),this._pending._save=h)}var i=r(38),s=r(37).EventEmitter,o=r(80).Transaction,a=r(85).RippleError,c=r(112).TransactionQueue;i.inherits(n,s),n.normalizeTransaction=function(t){var e=t;return t.engine_result||(e={engine_result:t.meta.TransactionResult,transaction:t.tx,hash:t.tx.hash,ledger_index:t.tx.ledger_index,meta:t.meta,type:"transaction",validated:!0},e.result=e.engine_result,e.result_message=e.engine_result_message),e.metadata=e.meta,e.tx_json||(e.tx_json=e.transaction),e},n.prototype._fillSequence=function(t,e){function r(t,e){var r=i._remote.transaction();r.account_set(i._accountID),r.tx_json.Sequence=t,r.once("submitted",e),r.submit()}function n(n,i){if("number"!=typeof i)return void e(new Error("Failed to fetch account transaction sequence"));for(var s=t.tx_json.Sequence-i,o=0,a=i;a<t.tx_json.Sequence;a++)r(a,function(){++o===s&&e()})}var i=this;this._loadSequence(n)},n.prototype._loadSequence=function(t){function e(e,n){"number"==typeof n?(r._nextSequence=n,r.emit("sequence_loaded",n),"function"==typeof t&&t(e,n)):setTimeout(function(){r._loadSequence(t)},3e3)}var r=this;this._account.getNextSequence(e)},n.prototype._resubmit=function(t,e){function r(t){if(t&&!t.finalized){var e=t.findId(i._pending._idCache);if(i._remote._trace("transactionmanager: resubmit:",t.tx_json),e)return t.emit("success",e);for(;i._pending.hasSequence(t.tx_json.Sequence);)i._remote._trace("transactionmanager: incrementing sequence:",t.tx_json),t.tx_json.Sequence+=1;i._request(t)}}function n(){!function t(n){var s=e[n];s instanceof o&&(s.once("submitted",function(r){s.emit("resubmitted",r),i._loadSequence(),++n<e.length&&t(n)}),r(s))}(0)}var i=this,e=e?[e]:this._pending,t=Number(t)||0;this._waitLedgers(t,n)},n.prototype._waitLedgers=function(t,e){function r(){++i===t&&(e(),n._remote.removeListener("ledger_closed",r))}if(1>t)return e();var n=this,i=0;this._remote.on("ledger_closed",r)},n.prototype._request=function(t){function e(e){t.setState("client_proposed"),e.rejected=t.isRejected(e.engine_result_code),t.emit("proposed",e)}function r(e){switch(e.engine_result){case"tefPAST_SEQ":u._resubmit(3,t);break;default:t.emit("error",e)}}function i(){n._isNoOp(t)?u._resubmit(1,t):u._fillSequence(t,function(){u._resubmit(1,t)})}function s(e){t.emit("error",e)}function o(e){t.finalized||(n._isTooBusy(e)?u._resubmit(1,t):(u._nextSequence--,t.setState("remoteError"),t.emit("error",e)))}function c(n){if(!t.finalized)switch(n.tx_json&&n.tx_json.hash&&t.addId(n.tx_json.hash),n.result=n.engine_result||"",h._trace("transactionmanager: submit_response:",n),t.emit("submitted",n),n.result.slice(0,3)){case"tes":e(n);break;case"tec":s(n);break;case"ter":i(n);break;case"tef":r(n);break;default:o(n)}}var u=this,h=this._remote;if(t.attempts>10)return t.emit("error",new a("tejAttemptsExceeded"));if(t.attempts>0&&!h.local_signing){var f="It is not possible to resubmit transactions automatically safely without synthesizing the transactionID locally. See `local_signing` config option";return t.emit("error",new a("tejLocalSigning",f))}var l=h.requestSubmit();return h.local_signing?(t.sign(),l.tx_blob(t.serialize().to_hex()),t.addId(t.hash())):(l.build_path(t._build_path),l.secret(t._secret),l.tx_json(t.tx_json)),h._trace("transactionmanager: submit:",t.tx_json),l.timeout(this._submissionTimeout,function(){t.finalized||(t.emit("timeout"),h._connected&&(h._trace("transactionmanager: timeout:",t.tx_json),u._resubmit(3,t)))}),l.once("error",c),l.once("success",c),t._server&&(l.server=t._server),l.request(),t.setState("client_submitted"),t.attempts++,l},n._isNoOp=function(t){return"object"==typeof t&&"object"==typeof t.tx_json&&"AccountSet"===t.tx_json.TransactionType&&0===t.tx_json.Flags},n._isRemoteError=function(t){return"object"==typeof t&&"remoteError"===t.error&&"object"==typeof t.remote},n._isNotFound=function(t){return n._isRemoteError(t)&&/^(txnNotFound|transactionNotFound)$/.test(t.remote.error)},n._isTooBusy=function(t){return n._isRemoteError(t)&&"tooBusy"===t.remote.error},n.prototype.submit=function(t){function e(){n.submit(t)}function r(e){t.finalized||(n._pending.remove(t),s._trace("transactionmanager: finalize_transaction:",t.tx_json),t.finalized=!0,t.emit("final",e))}var n=this;if("undefined"==typeof this._nextSequence)return void this.once("sequence_loaded",e);if(!t.finalized){"number"!=typeof t.tx_json.Sequence&&(t.tx_json.Sequence=this._nextSequence++),t.submitIndex=this._remote._ledger_current_index,t.lastLedger=void 0,t.attempts=0,t.complete(),t.on("error",r),t.once("success",r),t.once("abort",function(){t.emit("error",new a("tejAbort","Transaction aborted"))});var i=Number(t.tx_json.Fee),s=this._remote;t._secret||t.tx_json.TxnSignature?s.trusted||s.local_signing?i&&i>this._maxFee?t.emit("error",new a("tejMaxFeeExceeded","Max fee exceeded")):(this._pending.push(t),this._request(t)):t.emit("error",new a("tejServerUntrusted","Attempt to give secret to untrusted server")):t.emit("error",new a("tejSecretUnknown","Missing secret"))}},e.TransactionManager=n},function(t,e){e.HASH_TX_ID=1415073280,e.HASH_TX_NODE=1397638144,e.HASH_INNER_NODE=1296649728,e.HASH_TX_SIGN=1398036480,e.HASH_TX_SIGN_TESTNET=1937012736},function(t,e){var r=e.Float={},n=/^0+$/,i=/^1+$/;r.fromBytes=function(t){for(var e="",r=0,s=t.length;s>r;r++){for(var o=(255&t[r]).toString(2);o.length<8;)o="0"+o;e+=o}var a=4===t.length?4:11,c=8*t.length-a-1,u=Math.pow(2,a-1)-1,h=1-u-c,f=e[0],l=e.substring(1,a+1),p=e.substring(a+1),_=0,d="0"===f?1:-1;if(n.test(l))n.test(p)||(_=parseInt(p,2)*Math.pow(2,h));else if(i.test(l))_=n.test(p)?1/0:0/0;else{var y=parseInt(l,2)-u,m=parseInt(p,2);_=(1+m*Math.pow(2,-c))*Math.pow(2,y)}return _*d}},function(t,e,r){function n(t){return"number"==typeof t&&isFinite(t)}function i(t){return"string"==typeof t}function s(t){return i(t)&&/^[0-9A-F]{0,16}$/i.test(t)}function o(t){return t instanceof j}function a(t,e,r){var n=k.fromBits(T.toBits(e));r||B.serialize_varint(t,n.length),t.append(n)}function c(t){return v.codec.hex.fromBits(v.codec.bytes.toBits(t)).toUpperCase()}function u(t,e,r){if(!n(e))throw new Error("Value is not a number");if(0>e||e>=Math.pow(256,r))throw new Error("Value out of bounds");for(var i=[],s=0;r>s;s++)i.unshift(e>>>8*s&255);t.append(i)}function h(t,e){var r=0;if(e>4)throw new Error("This function only supports up to four bytes.");for(var n=0;e>n;n++){var i=t.read(1)[0];r+=i<<8*(e-n-1)}return r>>>0}function f(t,e,r){var n=X[e],i=n[0],s=n[1],o=(16>i?i<<4:0)|(16>s?s:0);"LedgerEntryType"===e&&"string"==typeof r&&(r=y.ledger[r][0]),"TransactionResult"===e&&"string"==typeof r&&(r=y.ter[r]),R.serialize(t,o),i>=16&&R.serialize(t,i),s>=16&&R.serialize(t,s);var a=G[i];a.serialize(t,r)}function l(t){var e=t.read(1)[0],r=e>>4;0===r&&(r=t.read(1)[0]);var n=G[r];_(n,"Unknown type - header byte is 0x"+e.toString(16));var i=15&e,s=s=0===i?K[r][t.read(1)[0]]:K[r][i];return _(s,"Unknown field - header byte is 0x"+e.toString(16)),[s,n.parse(t)]}function p(t){function e(t,e){var r=X[t],n=r[0],i=r[1],s=X[e],o=s[0],a=s[1];return n!==o?n-o:i-a}return t.sort(e)}var _=r(40),d=r(109),y=r(86),m=r(87),v=m.sjcl,g=r(113).UInt128,b=r(96).UInt160,w=r(104).UInt256,E=r(82).Base,x=r(78),S=x.Amount,A=x.Currency,T=v.codec.hex,k=v.codec.bytes,j=m.jsbn.BigInteger,B=function(t){d(this,t)};B.serialize_varint=function(t,e){if(0>e)throw new Error("Variable integers are unsigned.");if(192>=e)t.append([e]);else if(12480>=e)e-=193,t.append([193+(e>>>8),255&e]);else{if(!(918744>=e))throw new Error("Variable integer overflow.");e-=12481,t.append([241+(e>>>16),e>>>8&255,255&e])}},B.prototype.parse_varint=function(t){var e,r,n,i=t.read(1)[0];if(i>254)throw new Error("Invalid varint length indicator");return 192>=i?n=i:240>=i?(e=t.read(1)[0],n=193+256*(i-193)+e):254>=i&&(e=t.read(1)[0],r=t.read(1)[0],n=12481+65536*(i-241)+256*e+r),n};var R=e.Int8=new B({serialize:function(t,e){u(t,e,1)},parse:function(t){return h(t,1)}});R.id=16;var I=e.Int16=new B({serialize:function(t,e){u(t,e,2)},parse:function(t){return h(t,2)}});I.id=1;var q=e.Int32=new B({serialize:function(t,e){u(t,e,4)},parse:function(t){return h(t,4)}});q.id=2;var C=e.Int64=new B({serialize:function(t,e){var r;if(n(e)){if(e=Math.floor(e),0>e)throw new Error("Negative value for unsigned Int64 is invalid.");r=new j(String(e),10)}else if(i(e)){if(!s(e))throw new Error("Not a valid hex Int64.");r=new j(e,16)}else{if(!o(e))throw new Error("Invalid type for Int64");if(e.compareTo(j.ZERO)<0)throw new Error("Negative value for unsigned Int64 is invalid.");r=e}var c=r.toString(16);if(c.length>16)throw new Error("Int64 is too large");for(;c.length<16;)c="0"+c;a(t,c,!0)},parse:function(t){var e=new j(t.read(8),256);return _(e instanceof j),e}});C.id=3;var D=e.Hash128=new B({serialize:function(t,e){var r=g.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash128");a(t,r.to_hex(),!0)},parse:function(t){return g.from_bytes(t.read(16))}});D.id=4;var O=e.Hash256=new B({serialize:function(t,e){var r=w.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash256");a(t,r.to_hex(),!0)},parse:function(t){return w.from_bytes(t.read(32))}});O.id=5;var L=e.Hash160=new B({serialize:function(t,e){var r=b.from_json(e);if(!r.is_valid())throw new Error("Invalid Hash160");a(t,r.to_hex(),!0)},parse:function(t){return b.from_bytes(t.read(20))}});L.id=17;var M=new B({serialize:function(t,e){var r=e.to_bytes();if(!r)throw new Error("Tried to serialize invalid/unimplemented currency type.");t.append(r)},parse:function(t){var e=t.read(20),r=A.from_bytes(e);return r}}),N=e.Amount=new B({serialize:function(t,e){var r=S.from_json(e);if(!r.is_valid())throw new Error("Not a valid Amount object.");var n=m.arraySet(8,0);if(r.is_native()){var i=r._value.toString(16);if(i.length>16)throw new Error("Value out of bounds");for(;i.length<16;)i="0"+i;n=k.fromBits(T.toBits(i)),n[0]&=63,r.is_negative()||(n[0]|=64)}else{var s=0,o=0;s|=1<<31,r.is_zero()||(r.is_negative()||(s|=1<<30),s|=(97+r._offset&255)<<22,s|=4194303&r._value.shiftRight(32).intValue(),o=4294967295&r._value.intValue()),n=v.codec.bytes.fromBits([s,o])}if(t.append(n),!r.is_native()){var a=r.currency();M.serialize(t,a,!0),t.append(r.issuer().to_bytes())}},parse:function(t){for(var e=new S,r=t.read(8),n=!(127&r[0]),i=1;8>i;i++)n=n&&!r[i];if(128&r[0]){var s=M.parse(t),o=t.read(20),a=b.from_bytes(o);a.set_version(E.VER_ACCOUNT_ID);var c=((63&r[0])<<2)+(r[1]>>>6)-97,u=r.slice(1);u[0]&=63;var h=new j(u,256);if(h.equals(j.ZERO)&&!n)throw new Error("Invalid zero representation");e._value=h,e._offset=c,e._currency=s,e._issuer=a,e._is_native=!1}else{var f=r.slice();f[0]&=63,e._value=new j(f,256),e._is_native=!0}return e._is_negative=!(n||64&r[0]),e}});N.id=6;var F=e.VariableLength=new B({serialize:function(t,e){if("string"!=typeof e)throw new Error("Unknown datatype.");a(t,e)},parse:function(t){var e=this.parse_varint(t);return c(t.read(e))}});F.id=7;var P=e.Account=new B({serialize:function(t,e){var r=b.from_json(e);if(!r.is_valid())throw new Error("Invalid account!");a(t,r.to_hex())},parse:function(t){var e=this.parse_varint(t);if(20!==e)throw new Error("Non-standard-length account ID");var r=b.from_bytes(t.read(e));return r.set_version(E.VER_ACCOUNT_ID),r}});P.id=8;var z=e.PathSet=new B({typeBoundary:255,typeEnd:0,typeAccount:1,typeCurrency:16,typeIssuer:32,serialize:function(t,e){for(var r=0,n=e.length;n>r;r++){r&&R.serialize(t,this.typeBoundary);for(var i=0,s=e[r].length;s>i;i++){var o=e[r][i],a=0;if(o.account&&(a|=this.typeAccount),o.currency&&(a|=this.typeCurrency),o.issuer&&(a|=this.typeIssuer),R.serialize(t,a),o.account&&t.append(b.from_json(o.account).to_bytes()),o.currency){var c=A.from_json(o.currency,o.non_native);M.serialize(t,c)}o.issuer&&t.append(b.from_json(o.issuer).to_bytes())}}R.serialize(t,this.typeEnd)},parse:function(t){for(var e,r=[],n=[];(e=t.read(1)[0])!==this.typeEnd;)if(e===this.typeBoundary)n&&r.push(n),n=[];else{var i={};if(e&this.typeAccount&&(i.account=L.parse(t),i.account.set_version(E.VER_ACCOUNT_ID)),e&this.typeCurrency&&(i.currency=M.parse(t),"XRP"!==i.currency.to_json()||i.currency.is_native()||(i.non_native=!0)),e&this.typeIssuer&&(i.issuer=L.parse(t),i.issuer.set_version(E.VER_ACCOUNT_ID)),!(i.account||i.currency||i.issuer))throw new Error("Invalid path entry");n.push(i)}return n&&r.push(n),r}});z.id=18;var U=e.Vector256=new B({serialize:function(t,e){for(var r=(B.serialize_varint(t,e.length),0),n=e.length;n>r;r++)O.serialize(t,e[r])},parse:function(t){for(var e=this.parse_varint(t),r=[],n=0;e>n;n++)r.push(O.parse(t));return r}});U.id=19,e.serialize=e.serialize_whatever=f,e.parse=e.parse_whatever=l;var H=e.Object=new B({serialize:function(t,e,r){var n=Object.keys(e);n=n.filter(function(t){return t[0]!==t[0].toLowerCase()}),n=p(n);for(var i=0;i<n.length;i++)f(t,n[i],e[n[i]]);r||R.serialize(t,225)},parse:function(t){for(var e={};225!==t.peek(1)[0];){var r=l(t);e[r[0]]=r[1]}return t.read(1),e}});H.id=14;var V=e.Array=new B({serialize:function(t,e){for(var r=0,n=e.length;n>r;r++){var i=Object.keys(e[r]);if(1!==i.length)throw Error("Cannot serialize an array containing non-single-key objects");var s=i[0],o=e[r][s];f(t,s,o)}R.serialize(t,241)},parse:function(t){for(var e=[];241!==t.peek(1)[0];){var r=l(t),n={};n[r[0]]=r[1],e.push(n)}return t.read(1),e}});V.id=15;var G=[void 0,I,q,C,D,O,N,F,P,void 0,void 0,void 0,void 0,void 0,H,V,R,L,z,U],K={1:{1:"LedgerEntryType",2:"TransactionType"},2:{2:"Flags",3:"SourceTag",4:"Sequence",5:"PreviousTxnLgrSeq",6:"LedgerSequence",7:"CloseTime",8:"ParentCloseTime",9:"SigningTime",10:"Expiration",11:"TransferRate",12:"WalletSize",13:"OwnerCount",14:"DestinationTag",16:"HighQualityIn",17:"HighQualityOut",18:"LowQualityIn",19:"LowQualityOut",20:"QualityIn",21:"QualityOut",22:"StampEscrow",23:"BondAmount",24:"LoadFee",25:"OfferSequence",26:"FirstLedgerSequence",27:"LastLedgerSequence",28:"TransactionIndex",29:"OperationLimit",30:"ReferenceFeeUnits",31:"ReserveBase",32:"ReserveIncrement",33:"SetFlag",34:"ClearFlag"},3:{1:"IndexNext",2:"IndexPrevious",3:"BookNode",4:"OwnerNode",5:"BaseFee",6:"ExchangeRate",7:"LowNode",8:"HighNode"},4:{1:"EmailHash"},5:{1:"LedgerHash",2:"ParentHash",3:"TransactionHash",4:"AccountHash",5:"PreviousTxnID",6:"LedgerIndex",7:"WalletLocator",8:"RootIndex",16:"BookDirectory",17:"InvoiceID",18:"Nickname",19:"Feature"},6:{1:"Amount",2:"Balance",3:"LimitAmount",4:"TakerPays",5:"TakerGets",6:"LowLimit",7:"HighLimit",8:"Fee",9:"SendMax",16:"MinimumOffer",17:"RippleEscrow"},7:{1:"PublicKey",2:"MessageKey",3:"SigningPubKey",4:"TxnSignature",5:"Generator",6:"Signature",7:"Domain",8:"FundCode",9:"RemoveCode",10:"ExpireCode",11:"CreateCode"},8:{1:"Account",2:"Owner",3:"Destination",4:"Issuer",7:"Target",8:"RegularKey"},14:{1:void 0,2:"TransactionMetaData",3:"CreatedNode",4:"DeletedNode",5:"ModifiedNode",6:"PreviousFields",7:"FinalFields",8:"NewFields",9:"TemplateEntry"},15:{1:void 0,2:"SigningAccounts",3:"TxnSignatures",4:"Signatures",5:"Template",6:"Necessary",7:"Sufficient",8:"AffectedNodes"},16:{1:"CloseResolution",2:"TemplateEntryType",3:"TransactionResult"},17:{1:"TakerPaysCurrency",2:"TakerPaysIssuer",3:"TakerGetsCurrency",4:"TakerGetsIssuer"},18:{1:"Paths"},19:{1:"Indexes",2:"Hashes",3:"Features"}},X={};Object.keys(K).forEach(function(t){Object.keys(K[t]).forEach(function(e){X[K[t][e]]=[Number(t),Number(e)]})})},function(t,e,r){var n=(r(87).sjcl,r(87)),i=(r(89),r(109)),s=(n.jsbn.BigInteger,r(110).UInt),o=(r(82).Base,i(function(){this._value=0/0
},s));o.width=32,o.prototype=i({},s.prototype),o.prototype.constructor=o;{var a=o.HEX_ZERO="0000000000000000000000000000000000000000000000000000000000000000",c=o.HEX_ONE="0000000000000000000000000000000000000000000000000000000000000001";o.STR_ZERO=n.hexToString(a),o.STR_ONE=n.hexToString(c)}e.UInt256=o},function(t){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){function r(t,e,r,n,i,s){var o=s-i;if("ascii"===r||"binary"===r)for(var a=0;o>a;a++)t[n+a]=e.charCodeAt(a+i);else if(null==r)for(var a=0;o>a;a++)t[n+a]=e[a+i];else{if("hex"!==r)throw new Error("base64"===r?"base64 encoding not yet supported":r+" encoding not yet supported");for(var a=0;o>a;a++){var c=i+a;t[n+a]=parseInt(e[2*c]+e[2*c+1],16)}}}function n(t,e){for(var r=e;r<t.length;r++)t[r]=0}e.write=r,e.zeroFill=n,e.toString=toString},function(t){function e(t){if(!t||"[object Object]"!==n.call(t)||t.nodeType||t.setInterval)return!1;var e=r.call(t,"constructor"),i=r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;var s;for(s in t);return void 0===s||r.call(t,s)}var r=Object.prototype.hasOwnProperty,n=Object.prototype.toString;t.exports=function i(){var t,r,n,s,o,a,c=arguments[0]||{},u=1,h=arguments.length,f=!1;for("boolean"==typeof c&&(f=c,c=arguments[1]||{},u=2),"object"!=typeof c&&"function"!=typeof c&&(c={});h>u;u++)if(null!=(t=arguments[u]))for(r in t)n=c[r],s=t[r],c!==s&&(f&&s&&(e(s)||(o=Array.isArray(s)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&e(n)?n:{},c[r]=i(f,a,s)):void 0!==s&&(c[r]=s));return c}},function(t,e,r){var n=r(87),i=n.sjcl,s=r(89),o=n.jsbn.BigInteger,a=(r(82).Base,function(){this._value=0/0,this._update()});a.json_rewrite=function(t,e){return this.from_json(t).to_json(e)},a.from_generic=function(t){return t instanceof this?t.clone():(new this).parse_generic(t)},a.from_hex=function(t){return t instanceof this?t.clone():(new this).parse_hex(t)},a.from_json=function(t){return t instanceof this?t.clone():(new this).parse_json(t)},a.from_bits=function(t){return t instanceof this?t.clone():(new this).parse_bits(t)},a.from_bytes=function(t){return t instanceof this?t.clone():(new this).parse_bytes(t)},a.from_bn=function(t){return t instanceof this?t.clone():(new this).parse_bn(t)},a.from_number=function(t){return t instanceof this?t.clone():(new this).parse_number(t)},a.is_valid=function(t){return this.from_json(t).is_valid()},a.prototype.clone=function(){return this.copyTo(new this.constructor)},a.prototype.copyTo=function(t){return t._value=this._value,"function"==typeof t._update&&t._update(),t},a.prototype.equals=function(t){return this._value instanceof o&&t._value instanceof o&&this._value.equals(t._value)},a.prototype.is_valid=function(){return this._value instanceof o},a.prototype.is_zero=function(){return this._value.equals(o.ZERO)},a.prototype._update=function(){},a.prototype.parse_generic=function(t){switch(s.accounts&&t in s.accounts&&(t=s.accounts[t].account),t){case void 0:case"0":case this.constructor.STR_ZERO:case this.constructor.ACCOUNT_ZERO:case this.constructor.HEX_ZERO:this._value=o.valueOf();break;case"1":case this.constructor.STR_ONE:case this.constructor.ACCOUNT_ONE:case this.constructor.HEX_ONE:this._value=new o([1]);break;default:this._value="string"!=typeof t?0/0:this.constructor.width===t.length?new o(n.stringToArray(t),256):2*this.constructor.width===t.length?new o(t,16):0/0}return this._update(),this},a.prototype.parse_hex=function(t){return this._value="string"==typeof t&&t.length===2*this.constructor.width?new o(t,16):0/0,this._update(),this},a.prototype.parse_bits=function(t){if(i.bitArray.bitLength(t)!==8*this.constructor.width)this._value=0/0;else{var e=i.codec.bytes.fromBits(t);this.parse_bytes(e)}return this._update(),this},a.prototype.parse_bytes=function(t){return this._value=Array.isArray(t)&&t.length===this.constructor.width?new o([0].concat(t),256):0/0,this._update(),this},a.prototype.parse_json=a.prototype.parse_hex,a.prototype.parse_bn=function(t){if(t instanceof i.bn&&t.bitLength()<=8*this.constructor.width){var e=i.codec.bytes.fromBits(t.toBits());this._value=new o(e,256)}else this._value=0/0;return this._update(),this},a.prototype.parse_number=function(t){return this._value=0/0,"number"==typeof t&&t===+t&&t>0&&(this._value=new o(""+t)),this._update(),this},a.prototype.to_bytes=function(){if(!(this._value instanceof o))return null;var t=this._value.toByteArray();t=t.map(function(t){return(t+256)%256});var e=this.constructor.width;for(t=t.slice(-e);t.length<e;)t.unshift(0);return t},a.prototype.to_hex=function(){if(!(this._value instanceof o))return null;var t=this.to_bytes();return i.codec.hex.fromBits(i.codec.bytes.toBits(t)).toUpperCase()},a.prototype.to_json=a.prototype.to_hex,a.prototype.to_bits=function(){if(!(this._value instanceof o))return null;var t=this.to_bytes();return i.codec.bytes.toBits(t)},a.prototype.to_bn=function(){if(!(this._value instanceof o))return null;var t=this.to_bits();return i.bn.fromBits(t)},e.UInt=a},function(t,e,r){function n(){this._curve=s.ecc.curves.c256,this._secret=null,this._pubkey=null}function i(t){return s.hash.ripemd160.hash(s.hash.sha256.hash(t))}var s=r(87).sjcl,o=r(96).UInt160,a=r(104).UInt256;n.from_bn_secret=function(t){return t instanceof this?t.clone():(new this).parse_bn_secret(t)},n.prototype.parse_bn_secret=function(t){return this._secret=new s.ecc.ecdsa.secretKey(s.ecc.curves.c256,t),this},n.prototype._pub=function(){var t=this._curve;if(!this._pubkey&&this._secret){var e=this._secret._exponent;this._pubkey=new s.ecc.ecdsa.publicKey(t,t.G.mult(e))}return this._pubkey},n.prototype._pub_bits=function(){var t=this._pub();if(!t)return null;var e=t._point,r=e.y.mod(2).equals(0);return s.bitArray.concat([s.bitArray.partial(8,r?2:3)],e.x.toBits(this._curve.r.bitLength()))},n.prototype.to_hex_pub=function(){var t=this._pub_bits();return t?s.codec.hex.fromBits(t).toUpperCase():null},n.prototype.get_address=function(){var t=this._pub_bits();if(!t)return null;var e=i(t);return o.from_bits(e)},n.prototype.sign=function(t){var t=a.from_json(t);return this._secret.signDER(t.to_bits(),0)},e.KeyPair=n},function(t,e,r){function n(){this._queue=[],this._idCache={},this._sequenceCache={},this._save=void 0}r(80).Transaction;n.prototype.save=function(){"function"==typeof this._save&&this._save(this._queue.map(function(t){return{tx_json:t.tx_json,submittedIDs:t.submittedIDs}}))},n.prototype.addReceivedSequence=function(t){this._sequenceCache[t]=!0},n.prototype.addReceivedId=function(t,e){this._idCache[t]=e},n.prototype.getReceived=function(t){return this._idCache[t]},n.prototype.hasSequence=function(t){return this._sequenceCache[t]||!1},n.prototype.getSubmission=function(t){for(var e,r=!1,n=0;e=this._queue[n];n++)if(~e.submittedIDs.indexOf(t)){r=e;break}return r},n.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(this._queue[e]===t){this._queue.splice(e,1);break}this.save()},n.prototype.push=function(t){this._queue.push(t),this.save()},n.prototype.forEach=function(t){this._queue.forEach(t)},n.prototype.length=function(){return this._queue.length},e.TransactionQueue=n},function(t,e,r){var n=(r(87).sjcl,r(87)),i=(r(89),r(109)),s=(n.jsbn.BigInteger,r(110).UInt),o=(r(82).Base,i(function(){this._value=0/0},s));o.width=16,o.prototype=i({},s.prototype),o.prototype.constructor=o;{var a=o.HEX_ZERO="00000000000000000000000000000000",c=o.HEX_ONE="00000000000000000000000000000000";o.STR_ZERO=n.hexToString(a),o.STR_ONE=n.hexToString(c)}e.UInt128=o},function(t){"use strict";function e(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}var r={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof t&&t.exports&&(t.exports=r),r.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,n,i,s,o,a=this._tables[0][4],c=this._tables[1],u=t.length,h=1;if(4!==u&&6!==u&&8!==u)throw new r.exception.invalid("invalid aes key size");for(this._key=[s=t.slice(0),o=[]],e=u;4*u+28>e;e++)i=s[e-1],(e%u===0||8===u&&e%u===4)&&(i=a[i>>>24]<<24^a[i>>16&255]<<16^a[i>>8&255]<<8^a[255&i],e%u===0&&(i=i<<8^i>>>24^h<<24,h=h<<1^283*(h>>7))),s[e]=s[e-u]^i;for(n=0;e;n++,e--)i=s[3&n?e:e-4],o[n]=4>=e||4>n?i:c[0][a[i>>>24]]^c[1][a[i>>16&255]]^c[2][a[i>>8&255]]^c[3][a[255&i]]},r.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,r,n,i,s,o,a,c,u=this._tables[0],h=this._tables[1],f=u[4],l=h[4],p=[],_=[];for(t=0;256>t;t++)_[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!f[e];e^=n||1,r=_[r]||1)for(o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^255&o^99,f[e]=o,l[o]=e,s=p[i=p[n=p[e]]],c=16843009*s^65537*i^257*n^16843008*e,a=257*p[o]^16843008*o,t=0;4>t;t++)u[t][e]=a=a<<24^a>>>8,h[t][o]=c=c<<24^c>>>8;for(t=0;5>t;t++)u[t]=u[t].slice(0),h[t]=h[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new r.exception.invalid("invalid aes block size");var n,i,s,o,a=this._key[e],c=t[0]^a[0],u=t[e?3:1]^a[1],h=t[2]^a[2],f=t[e?1:3]^a[3],l=a.length/4-2,p=4,_=[0,0,0,0],d=this._tables[e],y=d[0],m=d[1],v=d[2],g=d[3],b=d[4];for(o=0;l>o;o++)n=y[c>>>24]^m[u>>16&255]^v[h>>8&255]^g[255&f]^a[p],i=y[u>>>24]^m[h>>16&255]^v[f>>8&255]^g[255&c]^a[p+1],s=y[h>>>24]^m[f>>16&255]^v[c>>8&255]^g[255&u]^a[p+2],f=y[f>>>24]^m[c>>16&255]^v[u>>8&255]^g[255&h]^a[p+3],p+=4,c=n,u=i,h=s;for(o=0;4>o;o++)_[e?3&-o:o]=b[c>>>24]<<24^b[u>>16&255]<<16^b[h>>8&255]<<8^b[255&f]^a[p++],n=c,c=u,u=h,h=f,f=n;return _}},r.bitArray={bitSlice:function(t,e,n){return t=r.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===n?t:r.bitArray.clamp(t,n-e)},extract:function(t,e,r){var n,i=Math.floor(-e-r&31);return n=-32&(e+r-1^e)?t[e/32|0]<<32-i^t[e/32+1|0]>>>i:t[e/32|0]>>>i,n&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],i=r.bitArray.getPartial(n);return 32===i?t.concat(e):r.bitArray._shiftRight(e,i,0|n,t.slice(0,t.length-1))},bitLength:function(t){var e,n=t.length;return 0===n?0:(e=t[n-1],32*(n-1)+r.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var n=t.length;return e=31&e,n>0&&e&&(t[n-1]=r.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(r.bitArray.bitLength(t)!==r.bitArray.bitLength(e))return!1;var n,i=0;for(n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},_shiftRight:function(t,e,n,i){var s,o,a=0;for(void 0===i&&(i=[]);e>=32;e-=32)i.push(n),n=0;if(0===e)return i.concat(t);for(s=0;s<t.length;s++)i.push(n|t[s]>>>e),n=t[s]<<32-e;return a=t.length?t[t.length-1]:0,o=r.bitArray.getPartial(a),i.push(r.bitArray.partial(e+o&31,e+o>32?n:i.pop(),1)),i},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},r.codec.utf8String={fromBits:function(t){var e,n,i="",s=r.bitArray.bitLength(t);for(e=0;s/8>e;e++)0===(3&e)&&(n=t[e/4]),i+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3===(3&e)&&(n.push(i),i=0);return 3&e&&n.push(r.bitArray.partial(8*(3&e),i)),n}},r.codec.hex={fromBits:function(t){var e,n="";for(e=0;e<t.length;e++)n+=((0|t[e])+0xf00000000000).toString(16).substr(4);return n.substr(0,r.bitArray.bitLength(t)/4)},toBits:function(t){var e,n,i=[];for(t=t.replace(/\s|0x/g,""),n=t.length,t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return r.bitArray.clamp(i,4*n)}},r.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var i,s="",o=0,a=r.codec.base64._chars,c=0,u=r.bitArray.bitLength(t);for(n&&(a=a.substr(0,62)+"-_"),i=0;6*s.length<u;)s+=a.charAt((c^t[i]>>>o)>>>26),6>o?(c=t[i]<<6-o,o+=26,i++):(c<<=6,o-=6);for(;3&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,i,s=[],o=0,a=r.codec.base64._chars,c=0;for(e&&(a=a.substr(0,62)+"-_"),n=0;n<t.length;n++){if(i=a.indexOf(t.charAt(n)),0>i)throw new r.exception.invalid("this isn't base64!");o>26?(o-=26,s.push(c^i>>>o),c=i<<32-o):(o+=6,c^=i<<32-o)}return 56&o&&s.push(r.bitArray.partial(56&o,c,1)),s}},r.codec.base64url={fromBits:function(t){return r.codec.base64.fromBits(t,1,1)},toBits:function(t){return r.codec.base64.toBits(t,1)}},r.codec.bytes={fromBits:function(t){var e,n,i=[],s=r.bitArray.bitLength(t);for(e=0;s/8>e;e++)0===(3&e)&&(n=t[e/4]),i.push(n>>>24),n<<=8;return i},toBits:function(t){var e,n=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t[e],3===(3&e)&&(n.push(i),i=0);return 3&e&&n.push(r.bitArray.partial(8*(3&e),i)),n}},r.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.sha256.hash=function(t){return(new r.hash.sha256).update(t).finalize()},r.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,n=this._buffer=r.bitArray.concat(this._buffer,t),i=this._length,s=this._length=i+r.bitArray.bitLength(t);for(e=512+i&-512;s>=e;e+=512)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(e=r.bitArray.concat(e,[r.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,r=0,n=2;t:for(;64>r;n++){for(e=2;n>=e*e;e++)if(n%e===0)continue t;8>r&&(this._init[r]=t(Math.pow(n,.5))),this._key[r]=t(Math.pow(n,1/3)),r++}},_block:function(t){var e,r,n,i,s=t.slice(0),o=this._h,a=this._key,c=o[0],u=o[1],h=o[2],f=o[3],l=o[4],p=o[5],_=o[6],d=o[7];for(e=0;64>e;e++)16>e?r=s[e]:(n=s[e+1&15],i=s[e+14&15],r=s[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[15&e]+s[e+9&15]|0),r=r+d+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(_^l&(p^_))+a[e],d=_,_=p,p=l,l=f+r|0,f=h,h=u,u=c,c=r+(u&h^f&(u^h))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;o[0]=o[0]+c|0,o[1]=o[1]+u|0,o[2]=o[2]+h|0,o[3]=o[3]+f|0,o[4]=o[4]+l|0,o[5]=o[5]+p|0,o[6]=o[6]+_|0,o[7]=o[7]+d|0}},r.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.sha512.hash=function(t){return(new r.hash.sha512).update(t).finalize()},r.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,n=this._buffer=r.bitArray.concat(this._buffer,t),i=this._length,s=this._length=i+r.bitArray.bitLength(t);for(e=1024+i&-1024;s>=e;e+=1024)this._block(n.splice(0,32));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(e=r.bitArray.concat(e,[r.bitArray.partial(1,1)]),t=e.length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32));return this.reset(),n},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}function e(t){return 1099511627776*(t-Math.floor(t))&255}var r,n=0,i=2;t:for(;80>n;i++){for(r=2;i>=r*r;r++)if(i%r===0)continue t;8>n&&(this._init[2*n]=t(Math.pow(i,.5)),this._init[2*n+1]=e(Math.pow(i,.5))<<24|this._initr[n]),this._key[2*n]=t(Math.pow(i,1/3)),this._key[2*n+1]=e(Math.pow(i,1/3))<<24|this._keyr[n],n++}},_block:function(t){var e,r,n,i=t.slice(0),s=this._h,o=this._key,a=s[0],c=s[1],u=s[2],h=s[3],f=s[4],l=s[5],p=s[6],_=s[7],d=s[8],y=s[9],m=s[10],v=s[11],g=s[12],b=s[13],w=s[14],E=s[15],x=a,S=c,A=u,T=h,k=f,j=l,B=p,R=_,I=d,q=y,C=m,D=v,O=g,L=b,M=w,N=E;for(e=0;80>e;e++){if(16>e)r=i[2*e],n=i[2*e+1];else{var F=i[2*(e-15)],P=i[2*(e-15)+1],z=(P<<31|F>>>1)^(P<<24|F>>>8)^F>>>7,U=(F<<31|P>>>1)^(F<<24|P>>>8)^(F<<25|P>>>7),H=i[2*(e-2)],V=i[2*(e-2)+1],G=(V<<13|H>>>19)^(H<<3|V>>>29)^H>>>6,K=(H<<13|V>>>19)^(V<<3|H>>>29)^(H<<26|V>>>6),X=i[2*(e-7)],Z=i[2*(e-7)+1],J=i[2*(e-16)],$=i[2*(e-16)+1];n=U+Z,r=z+X+(U>>>0>n>>>0?1:0),n+=K,r+=G+(K>>>0>n>>>0?1:0),n+=$,r+=J+($>>>0>n>>>0?1:0)}i[2*e]=r|=0,i[2*e+1]=n|=0;var Q=I&C^~I&O,W=q&D^~q&L,Y=x&A^x&k^A&k,te=S&T^S&j^T&j,ee=(S<<4|x>>>28)^(x<<30|S>>>2)^(x<<25|S>>>7),re=(x<<4|S>>>28)^(S<<30|x>>>2)^(S<<25|x>>>7),ne=(q<<18|I>>>14)^(q<<14|I>>>18)^(I<<23|q>>>9),ie=(I<<18|q>>>14)^(I<<14|q>>>18)^(q<<23|I>>>9),se=o[2*e],oe=o[2*e+1],ae=N+ie,ce=M+ne+(N>>>0>ae>>>0?1:0);ae+=W,ce+=Q+(W>>>0>ae>>>0?1:0),ae+=oe,ce+=se+(oe>>>0>ae>>>0?1:0),ae+=n,ce+=r+(n>>>0>ae>>>0?1:0);var ue=re+te,he=ee+Y+(re>>>0>ue>>>0?1:0);M=O,N=L,O=C,L=D,C=I,D=q,q=R+ae|0,I=B+ce+(R>>>0>q>>>0?1:0)|0,B=k,R=j,k=A,j=T,A=x,T=S,S=ae+ue|0,x=ce+he+(ae>>>0>S>>>0?1:0)|0}c=s[1]=c+S|0,s[0]=a+x+(S>>>0>c>>>0?1:0)|0,h=s[3]=h+T|0,s[2]=u+A+(T>>>0>h>>>0?1:0)|0,l=s[5]=l+j|0,s[4]=f+k+(j>>>0>l>>>0?1:0)|0,_=s[7]=_+R|0,s[6]=p+B+(R>>>0>_>>>0?1:0)|0,y=s[9]=y+q|0,s[8]=d+I+(q>>>0>y>>>0?1:0)|0,v=s[11]=v+D|0,s[10]=m+C+(D>>>0>v>>>0?1:0)|0,b=s[13]=b+L|0,s[12]=g+O+(L>>>0>b>>>0?1:0)|0,E=s[15]=E+N|0,s[14]=w+M+(N>>>0>E>>>0?1:0)|0}},r.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.sha1.hash=function(t){return(new r.hash.sha1).update(t).finalize()},r.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,n=this._buffer=r.bitArray.concat(this._buffer,t),i=this._length,s=this._length=i+r.bitArray.bitLength(t);for(e=this.blockSize+i&-this.blockSize;s>=e;e+=this.blockSize)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(e=r.bitArray.concat(e,[r.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,r,n){return 19>=t?e&r|~e&n:39>=t?e^r^n:59>=t?e&r|e&n|r&n:79>=t?e^r^n:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){{var e,r,n,i,s,o,a,c=t.slice(0),u=this._h;this._key}for(n=u[0],i=u[1],s=u[2],o=u[3],a=u[4],e=0;79>=e;e++)e>=16&&(c[e]=this._S(1,c[e-3]^c[e-8]^c[e-14]^c[e-16])),r=this._S(5,n)+this._f(e,i,s,o)+a+c[e]+this._key[Math.floor(e/20)]|0,a=o,o=s,s=this._S(30,i),i=n,n=r;u[0]=u[0]+n|0,u[1]=u[1]+i|0,u[2]=u[2]+s|0,u[3]=u[3]+o|0,u[4]=u[4]+a|0}},r.mode.ccm={name:"ccm",encrypt:function(t,e,n,i,s){var o,a,c=e.slice(0),u=r.bitArray,h=u.bitLength(n)/8,f=u.bitLength(c)/8;if(s=s||64,i=i||[],7>h)throw new r.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;4>o&&f>>>8*o;o++);return 15-h>o&&(o=15-h),n=u.clamp(n,8*(15-o)),a=r.mode.ccm._computeTag(t,e,n,i,s,o),c=r.mode.ccm._ctrMode(t,c,n,a,s,o),u.concat(c.data,c.tag)},decrypt:function(t,e,n,i,s){s=s||64,i=i||[];var o,a,c=r.bitArray,u=c.bitLength(n)/8,h=c.bitLength(e),f=c.clamp(e,h-s),l=c.bitSlice(e,h-s);if(h=(h-s)/8,7>u)throw new r.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;4>o&&h>>>8*o;o++);if(15-u>o&&(o=15-u),n=c.clamp(n,8*(15-o)),f=r.mode.ccm._ctrMode(t,f,n,l,s,o),a=r.mode.ccm._computeTag(t,f.data,n,i,s,o),!c.equal(f.tag,a))throw new r.exception.corrupt("ccm: tag doesn't match");return f.data},_computeTag:function(t,e,n,i,s,o){var a,c,u,h=[],f=r.bitArray,l=f._xor4;if(s/=8,s%2||4>s||s>16)throw new r.exception.invalid("ccm: invalid tag length");if(i.length>4294967295||e.length>4294967295)throw new r.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[f.partial(8,(i.length?64:0)|s-2<<2|o-1)],a=f.concat(a,n),a[3]|=f.bitLength(e)/8,a=t.encrypt(a),i.length)for(c=f.bitLength(i)/8,65279>=c?h=[f.partial(16,c)]:4294967295>=c&&(h=f.concat([f.partial(16,65534)],[c])),h=f.concat(h,i),u=0;u<h.length;u+=4)a=t.encrypt(l(a,h.slice(u,u+4).concat([0,0,0])));for(u=0;u<e.length;u+=4)a=t.encrypt(l(a,e.slice(u,u+4).concat([0,0,0])));return f.clamp(a,8*s)},_ctrMode:function(t,e,n,i,s,o){var a,c,u,h=r.bitArray,f=h._xor4,l=e.length,p=h.bitLength(e);if(u=h.concat([h.partial(8,o-1)],n).concat([0,0,0]).slice(0,4),i=h.bitSlice(f(i,t.encrypt(u)),0,s),!l)return{tag:i,data:[]};for(c=0;l>c;c+=4)u[3]++,a=t.encrypt(u),e[c]^=a[0],e[c+1]^=a[1],e[c+2]^=a[2],e[c+3]^=a[3];return{tag:i,data:h.clamp(e,p)}}},r.misc.hmac=function(t,e){this._hash=e=e||r.hash.sha256;var n,i=[[],[]],s=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>s&&(t=e.hash(t)),n=0;s>n;n++)i[0][n]=909522486^t[n],i[1][n]=1549556828^t[n];this._baseHash[0].update(i[0]),this._baseHash[1].update(i[1])},r.misc.hmac.prototype.encrypt=r.misc.hmac.prototype.mac=function(t){var e=new this._hash(this._baseHash[0]).update(t).finalize();return new this._hash(this._baseHash[1]).update(e).finalize()},r.misc.pbkdf2=function(t,e,n,i,s){if(n=n||1e3,0>i||0>n)throw r.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=r.codec.utf8String.toBits(t)),s=s||r.misc.hmac;var o,a,c,u,h,f=new s(t),l=[],p=r.bitArray;for(h=1;32*l.length<(i||1);h++){for(o=a=f.encrypt(p.concat(e,[h])),c=1;n>c;c++)for(a=f.encrypt(a),u=0;u<a.length;u++)o[u]^=a[u];l=l.concat(o)}return i&&(l=p.clamp(l,i)),l},r.prng=function(t){this._pools=[new r.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},r.prng.prototype={randomWords:function(t,e){var n,i,s=[],o=this.isReady(e);if(o===this._NOT_READY)throw new r.exception.notReady("generator isn't seeded");for(o&this._REQUIRES_RESEED&&this._reseedFromPools(!(o&this._READY)),n=0;t>n;n+=4)(n+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),i=this._gen4words(),s.push(i[0],i[1],i[2],i[3]);return this._gate(),s.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,n){n=n||"user";var i,s,o,a=(new Date).valueOf(),c=this._robins[n],u=this.isReady(),h=0;switch(i=this._collectorIds[n],void 0===i&&(i=this._collectorIds[n]=this._collectorIdNext++),void 0===c&&(c=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[c].update([i,this._eventId++,1,e,a,1,0|t]);break;case"object":var f=Object.prototype.toString.call(t);if("[object Uint32Array]"===f){for(o=[],s=0;s<t.length;s++)o.push(t[s]);t=o}else for("[object Array]"!==f&&(h=1),s=0;s<t.length&&!h;s++)"number"!=typeof t[s]&&(h=1);if(!h){if(void 0===e)for(e=0,s=0;s<t.length;s++)for(o=t[s];o>0;)e++,o>>>=1;this._pools[c].update([i,this._eventId++,2,e,a,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[c].update([i,this._eventId++,3,e,a,t.length]),this._pools[c].update(t);break;default:h=1}if(h)throw new r.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[c]+=e,this._poolStrength+=e,u===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new r.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var r,n,i=this._callbacks[t],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===e&&s.push(n);for(r=0;r<s.length;r++)n=s[r],delete i[n]},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new r.cipher.aes(this._key)},_reseed:function(t){this._key=r.hash.sha256.hash(this._key.concat(t)),this._cipher=new r.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,n=[],i=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)n.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(n=n.concat(this._pools[e].finalize()),i+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new r.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=i,i>this._strength&&(this._strength=i),this._reseedCount++,this._reseed(n)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,n=t.y||t.clientY||t.offsetY||0;r.random.addEntropy([e,n],2,"mouse")},_loadTimeCollector:function(){r.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(t,e){var n,i=r.random._callbacks[t],s=[];for(n in i)i.hasOwnProperty(n)&&s.push(i[n]);for(n=0;n<s.length;n++)s[n](e)}},r.random=new r.prng(6),function(){try{var t=new Uint32Array(32);crypto.getRandomValues(t),r.random.addEntropy(t,1024,"crypto.getRandomValues")}catch(e){}}(),r.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(t,e,n,i){n=n||{},i=i||{};var s,o,a,c=r.json,u=c._add({iv:r.random.randomWords(4,0)},c.defaults);if(c._add(u,n),a=u.adata,"string"==typeof u.salt&&(u.salt=r.codec.base64.toBits(u.salt)),"string"==typeof u.iv&&(u.iv=r.codec.base64.toBits(u.iv)),!r.mode[u.mode]||!r.cipher[u.cipher]||"string"==typeof t&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||u.iv.length<2||u.iv.length>4)throw new r.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(s=r.misc.cachedPbkdf2(t,u),t=s.key.slice(0,u.ks/32),u.salt=s.salt):r.ecc&&t instanceof r.ecc.elGamal.publicKey&&(s=t.kem(),u.kemtag=s.tag,t=s.key.slice(0,u.ks/32)),"string"==typeof e&&(e=r.codec.utf8String.toBits(e)),"string"==typeof a&&(a=r.codec.utf8String.toBits(a)),o=new r.cipher[u.cipher](t),c._add(i,u),i.key=t,u.ct=r.mode[u.mode].encrypt(o,e,u.iv,a,u.ts),c.encode(u)},decrypt:function(t,e,n,i){n=n||{},i=i||{};var s,o,a,c=r.json,u=c._add(c._add(c._add({},c.defaults),c.decode(e)),n,!0),h=u.adata;if("string"==typeof u.salt&&(u.salt=r.codec.base64.toBits(u.salt)),"string"==typeof u.iv&&(u.iv=r.codec.base64.toBits(u.iv)),!r.mode[u.mode]||!r.cipher[u.cipher]||"string"==typeof t&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||!u.iv||u.iv.length<2||u.iv.length>4)throw new r.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(o=r.misc.cachedPbkdf2(t,u),t=o.key.slice(0,u.ks/32),u.salt=o.salt):r.ecc&&t instanceof r.ecc.elGamal.secretKey&&(t=t.unkem(r.codec.base64.toBits(u.kemtag)).slice(0,u.ks/32)),"string"==typeof h&&(h=r.codec.utf8String.toBits(h)),a=new r.cipher[u.cipher](t),s=r.mode[u.mode].decrypt(a,u.ct,u.iv,h,u.ts),c._add(i,u),i.key=t,r.codec.utf8String.fromBits(s)},encode:function(t){var e,n="{",i="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new r.exception.invalid("json encode: invalid property name");switch(n+=i+'"'+e+'":',i=",",typeof t[e]){case"number":case"boolean":n+=t[e];break;case"string":n+='"'+escape(t[e])+'"';break;case"object":n+='"'+r.codec.base64.fromBits(t[e],0)+'"';break;default:throw new r.exception.bug("json encode: unsupported type")}}return n+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new r.exception.invalid("json decode: this isn't json!");var e,n,i=t.replace(/^\{|\}$/g,"").split(/,/),s={};for(e=0;e<i.length;e++){if(!(n=i[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new r.exception.invalid("json decode: this isn't json!");s[n[2]]=n[3]?parseInt(n[3],10):n[2].match(/^(ct|salt|iv)$/)?r.codec.base64.toBits(n[4]):unescape(n[4])}return s},_add:function(t,e,n){if(void 0===t&&(t={}),void 0===e)return t;var i;for(i in e)if(e.hasOwnProperty(i)){if(n&&void 0!==t[i]&&t[i]!==e[i])throw new r.exception.invalid("required parameter overridden");t[i]=e[i]}return t},_subtract:function(t,e){var r,n={};for(r in t)t.hasOwnProperty(r)&&t[r]!==e[r]&&(n[r]=t[r]);return n},_filter:function(t,e){var r,n={};for(r=0;r<e.length;r++)void 0!==t[e[r]]&&(n[e[r]]=t[e[r]]);return n}},r.encrypt=r.json.encrypt,r.decrypt=r.json.decrypt,r.misc._pbkdf2Cache={},r.misc.cachedPbkdf2=function(t,e){var n,i,s,o,a=r.misc._pbkdf2Cache;return e=e||{},o=e.iter||1e3,i=a[t]=a[t]||{},n=i[o]=i[o]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):r.random.randomWords(2,0)},s=void 0===e.salt?n.firstSalt:e.salt,n[s]=n[s]||r.misc.pbkdf2(t,s,e.iter),{key:n[s].slice(0),salt:s.slice(0)}},r.bn=function(t){this.initWith(t)},r.bn.prototype={radix:24,maxMul:8,_class:r.bn,copy:function(){return new this._class(this)
},initWith:function(t){var e,r=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,r=0;r<t.length;r+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-r-e,0),t.length-r),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)r|=this.getLimb(e)^t.getLimb(e);return 0===r},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,n,i=0,s=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)r=this.getLimb(e),n=t.getLimb(e),s|=n-r&~i,i|=r-n&~s;return(s|~i)>>>31},toString:function(){this.fullReduce();var t,e,r="",n=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=n[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;r=e+r}return"0x"+r},addM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,n=t.limbs;for(e=r.length;e<n.length;e++)r[e]=0;for(e=0;e<n.length;e++)r[e]+=n[e];return this},doubleM:function(){var t,e,r=0,n=this.radix,i=this.radixMask,s=this.limbs;for(t=0;t<s.length;t++)e=s[t],e=e+e+r,s[t]=e&i,r=e>>n;return r&&s.push(r),this},halveM:function(){var t,e,r=0,n=this.radix,i=this.limbs;for(t=i.length-1;t>=0;t--)e=i[t],i[t]=e+r>>1,r=(1&e)<<n;return i[i.length-1]||i.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,n=t.limbs;for(e=r.length;e<n.length;e++)r[e]=0;for(e=0;e<n.length;e++)r[e]-=n[e];return this},mod:function(t){var e=!this.greaterEquals(new r.bn(0));t=new r.bn(t).normalize();var n=new r.bn(this).normalize(),i=0;for(e&&(n=new r.bn(0).subM(n).normalize());n.greaterEquals(t);i++)t.doubleM();for(e&&(n=t.sub(n).normalize());i>0;i--)t.halveM(),n.greaterEquals(t)&&n.subM(t).normalize();return n.trim()},inverseMod:function(t){var e,n,i=new r.bn(1),s=new r.bn(0),o=new r.bn(this),a=new r.bn(t),c=1;if(!(1&t.limbs[0]))throw new r.exception.invalid("inverseMod: p must be odd");do for(1&o.limbs[0]&&(o.greaterEquals(a)||(e=o,o=a,a=e,e=i,i=s,s=e),o.subM(a),o.normalize(),i.greaterEquals(s)||i.addM(t),i.subM(s)),o.halveM(),1&i.limbs[0]&&i.addM(t),i.normalize(),i.halveM(),n=c=0;n<o.limbs.length;n++)c|=o.limbs[n];while(c);if(!a.equals(1))throw new r.exception.invalid("inverseMod: p and x must be relatively prime");return s},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,n,i=this.limbs,s=t.limbs,o=i.length,a=s.length,c=new this._class,u=c.limbs,h=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)u[e]=0;for(e=0;o>e;e++){for(n=i[e],r=0;a>r;r++)u[e+r]+=n*s[r];--h||(h=this.maxMul,c.cnormalize())}return c.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var e,r,n=new this._class(1),i=this;for(e=0;e<t.length;e++)for(r=0;r<this.radix;r++)t[e]&1<<r&&(n=n.mul(i)),i=i.square();return n},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var n=new r.bn(1),i=new r.bn(this),s=new r.bn(t);;){if(1&s.limbs[0]&&(n=n.mulmod(i,e)),s.halveM(),s.equals(0))break;i=i.mulmod(i,e)}return n.normalize().reduce()},trim:function(){var t,e=this.limbs;do t=e.pop();while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,r,n=0,i=(this.placeVal,this.ipv),s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o>t||0!==n&&-1!==n;t++)e=(s[t]||0)+n,r=s[t]=e&a,n=(e-r)*i;return-1===n&&(s[t-1]-=this.placeVal),this},cnormalize:function(){var t,e,r,n=0,i=this.ipv,s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o-1>t;t++)e=s[t]+n,r=s[t]=e&a,n=(e-r)*i;return s[t]+=n,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),n=r.bitArray,i=(t+7&-8)%this.radix||this.radix,s=[n.partial(i,this.getLimb(e))];for(e--;e>=0;e--)s=n.concat(s,[n.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return s},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},r.bn.fromBits=function(t){var e=this,n=new e,i=[],s=r.bitArray,o=this.prototype,a=Math.min(this.bitLength||4294967296,s.bitLength(t)),c=a%o.radix||o.radix;for(i[0]=s.extract(t,0,c);a>c;c+=o.radix)i.unshift(s.extract(t,c,o.radix));return n.limbs=i,n},r.bn.prototype.ipv=1/(r.bn.prototype.placeVal=Math.pow(2,r.bn.prototype.radix)),r.bn.prototype.radixMask=(1<<r.bn.prototype.radix)-1,r.bn.pseudoMersennePrime=function(t,e){function n(t){this.initWith(t)}var i,s,o,a=n.prototype=new r.bn;for(o=a.modOffset=Math.ceil(s=t/a.radix),a.exponent=t,a.offset=[],a.factor=[],a.minOffset=o,a.fullMask=0,a.fullOffset=[],a.fullFactor=[],a.modulus=n.modulus=new r.bn(Math.pow(2,t)),a.fullMask=0|-Math.pow(2,t%a.radix),i=0;i<e.length;i++)a.offset[i]=Math.floor(e[i][0]/a.radix-s),a.fullOffset[i]=Math.ceil(e[i][0]/a.radix-s),a.factor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+a.offset[i]*a.radix),a.fullFactor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+a.fullOffset[i]*a.radix),a.modulus.addM(new r.bn(Math.pow(2,e[i][0])*e[i][1])),a.minOffset=Math.min(a.minOffset,-a.offset[i]);return a._class=n,a.modulus.cnormalize(),a.reduce=function(){var t,e,r,n,i=this.modOffset,s=this.limbs,o=this.offset,a=this.offset.length,c=this.factor;for(t=this.minOffset;s.length>i;){for(r=s.pop(),n=s.length,e=0;a>e;e++)s[n+o[e]]-=c[e]*r;t--,t||(s.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},a._strongReduce=-1===a.fullMask?a.reduce:function(){var t,e,r=this.limbs,n=r.length-1;if(this.reduce(),n===this.modOffset-1){for(e=r[n]&this.fullMask,r[n]-=e,t=0;t<this.fullOffset.length;t++)r[n+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},a.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},a.inverse=function(){return this.power(this.modulus.sub(2))},n.fromBits=r.bn.fromBits,n},r.bn.prime={p127:r.bn.pseudoMersennePrime(127,[[0,-1]]),p25519:r.bn.pseudoMersennePrime(255,[[0,-19]]),p192:r.bn.pseudoMersennePrime(192,[[0,-1],[64,-1]]),p224:r.bn.pseudoMersennePrime(224,[[0,1],[96,-1]]),p256:r.bn.pseudoMersennePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:r.bn.pseudoMersennePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:r.bn.pseudoMersennePrime(521,[[0,-1]])},r.bn.random=function(t,e){"object"!=typeof t&&(t=new r.bn(t));for(var n,i,s=t.limbs.length,o=t.limbs[s-1]+1,a=new r.bn;;){do n=r.random.randomWords(s,e),n[s-1]<0&&(n[s-1]+=4294967296);while(Math.floor(n[s-1]/o)===Math.floor(4294967296/o));for(n[s-1]%=o,i=0;s-1>i;i++)n[i]&=t.radixMask;if(a.limbs=n,!a.greaterEquals(t))return a}},r.ecc={},r.ecc.point=function(t,e,r){void 0===e?this.isIdentity=!0:(this.x=e,this.y=r,this.isIdentity=!1),this.curve=t},r.ecc.point.prototype={toJac:function(){return new r.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,r){return this.toJac().mult2(t,this,e,r).toAffine()},multiples:function(){var t,e,n;if(void 0===this._multiples)for(n=this.toJac().doubl(),t=this._multiples=[new r.ecc.point(this.curve),this,n.toAffine()],e=3;16>e;e++)n=n.add(this),t.push(n.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return r.bitArray.concat(this.x.toBits(),this.y.toBits())}},r.ecc.pointJac=function(t,e,r,n){void 0===e?this.isIdentity=!0:(this.x=e,this.y=r,this.z=n,this.isIdentity=!1),this.curve=t},r.ecc.pointJac.prototype={add:function(t){var e,n,i,s,o,a,c,u,h,f,l,p=this;if(p.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return p.isIdentity?t.toJac():t.isIdentity?p:(e=p.z.square(),n=t.x.mul(e).subM(p.x),n.equals(0)?p.y.equals(t.y.mul(e.mul(p.z)))?p.doubl():new r.ecc.pointJac(p.curve):(i=t.y.mul(e.mul(p.z)).subM(p.y),s=n.square(),o=i.square(),a=n.square().mul(n).addM(p.x.add(p.x).mul(s)),c=o.subM(a),u=p.x.mul(s).subM(c).mul(i),h=p.y.mul(n.square().mul(n)),f=u.subM(h),l=p.z.mul(n),new r.ecc.pointJac(this.curve,c,f,l)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),n=t.square().mul(8),i=this.z.square(),s=this.x.sub(i).mul(3).mul(this.x.add(i)),o=s.square().subM(e).subM(e),a=e.sub(o).mul(s).subM(n),c=this.y.add(this.y).mul(this.z);return new r.ecc.pointJac(this.curve,o,a,c)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new r.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new r.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var n,i,s=new r.ecc.point(this.curve).toJac(),o=e.multiples();for(n=t.length-1;n>=0;n--)for(i=r.bn.prototype.radix-4;i>=0;i-=4)s=s.doubl().doubl().doubl().doubl().add(o[t[n]>>i&15]);return s},mult2:function(t,e,n,i){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"==typeof n?n=[n]:void 0!==n.limbs&&(n=n.normalize().limbs);var s,o,a,c,u=new r.ecc.point(this.curve).toJac(),h=e.multiples(),f=i.multiples();for(s=Math.max(t.length,n.length)-1;s>=0;s--)for(a=0|t[s],c=0|n[s],o=r.bn.prototype.radix-4;o>=0;o-=4)u=u.doubl().doubl().doubl().doubl().add(h[a>>o&15]).add(f[c>>o&15]);return u},isValid:function(){var t=this.z.square(),e=t.square(),r=e.mul(t);return this.y.square().equals(this.curve.b.mul(r).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},r.ecc.curve=function(t,e,n,i,s,o){this.field=t,this.r=t.prototype.modulus.sub(e),this.a=new t(n),this.b=new t(i),this.G=new r.ecc.point(this,new t(s),new t(o))},r.ecc.curve.prototype.fromBits=function(t){var e=r.bitArray,n=this.field.prototype.exponent+7&-8,i=new r.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,n)),this.field.fromBits(e.bitSlice(t,n,2*n)));if(!i.isValid())throw new r.exception.corrupt("not on the curve!");return i},r.ecc.curves={c192:new r.ecc.curve(r.bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new r.ecc.curve(r.bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new r.ecc.curve(r.bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new r.ecc.curve(r.bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},r.ecc._dh=function(t){r.ecc[t]={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._point=e instanceof Array?t.fromBits(e):e,this.get=function(){var t=this._point.toBits(),e=r.bitArray.bitLength(t),n=r.bitArray.bitSlice(t,0,e/2),i=r.bitArray.bitSlice(t,e/2);return{x:n,y:i}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}},generateKeys:function(e,n,i){if(void 0===e&&(e=256),"number"==typeof e&&(e=r.ecc.curves["c"+e],void 0===e))throw new r.exception.invalid("no such curve");if(void 0===i)var i=r.bn.random(e.r,n);var s=e.G.mult(i);return{pub:new r.ecc[t].publicKey(e,s),sec:new r.ecc[t].secretKey(e,i)}}}},r.ecc._dh("elGamal"),r.ecc.elGamal.publicKey.prototype={kem:function(t){var e=r.bn.random(this._curve.r,t),n=this._curve.G.mult(e).toBits(),i=r.hash.sha256.hash(this._point.mult(e).toBits());return{key:i,tag:n}}},r.ecc.elGamal.secretKey.prototype={unkem:function(t){return r.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return r.hash.sha256.hash(t._point.mult(this._exponent).toBits())}},r.ecc._dh("ecdsa"),r.ecc.ecdsa.secretKey.prototype={sign:function(t,e,n,i){r.bitArray.bitLength(t)>this._curveBitLength&&(t=r.bitArray.clamp(t,this._curveBitLength));var s=this._curve.r,o=s.bitLength(),a=i||r.bn.random(s.sub(1),e).add(1),c=this._curve.G.mult(a).x.mod(s),u=r.bn.fromBits(t).add(c.mul(this._exponent)),h=n?u.inverseMod(s).mul(a).mod(s):u.mul(a.inverseMod(s)).mod(s);return r.bitArray.concat(c.toBits(o),h.toBits(o))}},r.ecc.ecdsa.publicKey.prototype={verify:function(t,e,n){r.bitArray.bitLength(t)>this._curveBitLength&&(t=r.bitArray.clamp(t,this._curveBitLength));var i=r.bitArray,s=this._curve.r,o=this._curveBitLength,a=r.bn.fromBits(i.bitSlice(e,0,o)),c=r.bn.fromBits(i.bitSlice(e,o,2*o)),u=n?c:c.inverseMod(s),h=r.bn.fromBits(t).mul(u).mod(s),f=a.mul(u).mod(s),l=this._curve.G.mult2(h,f,this._point).x;if(a.equals(0)||c.equals(0)||a.greaterEquals(s)||c.greaterEquals(s)||!l.equals(a)){if(void 0===n)return this.verify(t,e,!0);throw new r.exception.corrupt("signature didn't check out")}return!0}},r.keyexchange.srp={makeVerifier:function(t,e,n,i){var s;return s=r.keyexchange.srp.makeX(t,e,n),s=r.bn.fromBits(s),i.g.powermod(s,i.N)},makeX:function(t,e,n){var i=r.hash.sha1.hash(t+":"+e);return r.hash.sha1.hash(r.bitArray.concat(n,i))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),r.keyexchange.srp._didInitKnownGroups||r.keyexchange.srp._initKnownGroups(),r.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){var t,e,n;for(t=0;t<r.keyexchange.srp._knownGroupSizes.length;t++)e=r.keyexchange.srp._knownGroupSizes[t].toString(),n=r.keyexchange.srp._knownGroups[e],n.N=new r.bn(n.N),n.g=new r.bn(n.g);r.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},r.ecc.curves.c256=new r.ecc.curve(r.bn.pseudoMersennePrime(256,[[0,-1],[4,-1],[6,-1],[7,-1],[8,-1],[9,-1],[32,-1]]),"0x14551231950b75fc4402da1722fc9baee",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),r.ecc.pointJac.prototype.add=function(t){var e=this;if(e.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";if(e.isIdentity)return t.toJac();if(t.isIdentity)return e;var n=e.z.square(),i=t.x.mul(n).subM(e.x),s=t.y.mul(e.z).mul(n);if(i.equals(0))return e.y.equals(t.y.mul(n.mul(e.z)))?e.doubl():new r.ecc.pointJac(e.curve);var o=i.square(),a=o.copy().doubleM().doubleM(),c=i.mul(a),u=s.sub(e.y).doubleM(),h=e.x.mul(a),f=u.square().subM(c).subM(h.copy().doubleM()),l=u.mul(h.sub(f)).subM(e.y.mul(c).doubleM()),p=e.z.add(i).square().subM(n).subM(o);return new r.ecc.pointJac(this.curve,f,l,p)},r.ecc.pointJac.prototype.doubl=function(){if(this.isIdentity)return this;var t=this.x.square(),e=this.y.square(),n=e.square(),i=this.x.add(e).square().subM(t).subM(n).doubleM(),s=t.mul(3),o=s.square(),a=o.sub(i.copy().doubleM()),c=s.mul(i.sub(a)).subM(n.doubleM().doubleM().doubleM()),u=this.y.mul(this.z).doubleM();return new r.ecc.pointJac(this.curve,a,c,u)},r.ecc.point.prototype.toBytesCompressed=function(){var t="0x0"==this.y.mod(2).toString()?2:3;return[t].concat(r.codec.bytes.fromBits(this.x.toBits()))},function(){function t(t,e,r){return t^e^r}function e(t,e,r){return t&e|~t&r}function n(t,e,r){return(t|~e)^r}function i(t,e,r){return t&r|e&~r}function s(t,e,r){return t^(e|~r)}function o(t,e){return t<<e|t>>>32-e}function a(t){return(255&t)<<24|(65280&t)<<8|(t&255<<16)>>>8|(t&255<<24)>>>24}function c(r){for(var a,c=this._h[0],u=this._h[1],l=this._h[2],p=this._h[3],v=this._h[4],g=this._h[0],b=this._h[1],w=this._h[2],E=this._h[3],x=this._h[4],S=0;16>S;++S)a=o(c+t(u,l,p)+r[_[S]]+h[S],y[S])+v,c=v,v=p,p=o(l,10),l=u,u=a,a=o(g+s(b,w,E)+r[d[S]]+f[S],m[S])+x,g=x,x=E,E=o(w,10),w=b,b=a;for(;32>S;++S)a=o(c+e(u,l,p)+r[_[S]]+h[S],y[S])+v,c=v,v=p,p=o(l,10),l=u,u=a,a=o(g+i(b,w,E)+r[d[S]]+f[S],m[S])+x,g=x,x=E,E=o(w,10),w=b,b=a;for(;48>S;++S)a=o(c+n(u,l,p)+r[_[S]]+h[S],y[S])+v,c=v,v=p,p=o(l,10),l=u,u=a,a=o(g+n(b,w,E)+r[d[S]]+f[S],m[S])+x,g=x,x=E,E=o(w,10),w=b,b=a;for(;64>S;++S)a=o(c+i(u,l,p)+r[_[S]]+h[S],y[S])+v,c=v,v=p,p=o(l,10),l=u,u=a,a=o(g+e(b,w,E)+r[d[S]]+f[S],m[S])+x,g=x,x=E,E=o(w,10),w=b,b=a;for(;80>S;++S)a=o(c+s(u,l,p)+r[_[S]]+h[S],y[S])+v,c=v,v=p,p=o(l,10),l=u,u=a,a=o(g+t(b,w,E)+r[d[S]]+f[S],m[S])+x,g=x,x=E,E=o(w,10),w=b,b=a;a=this._h[1]+l+E,this._h[1]=this._h[2]+p+x,this._h[2]=this._h[3]+v+g,this._h[3]=this._h[4]+c+b,this._h[4]=this._h[0]+u+w,this._h[0]=a}r.hash.ripemd160=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.ripemd160.hash=function(t){return(new r.hash.ripemd160).update(t).finalize()},r.hash.ripemd160.prototype={reset:function(){return this._h=u.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,n=this._buffer=r.bitArray.concat(this._buffer,t),i=this._length,s=this._length=i+r.bitArray.bitLength(t);for(e=512+i&-512;s>=e;e+=512){for(var o=n.splice(0,16),u=0;16>u;++u)o[u]=a(o[u]);c.call(this,o)}return this},finalize:function(){var t=r.bitArray.concat(this._buffer,[r.bitArray.partial(1,1)]),e=(this._length+1)%512,n=(e>448?512:448)-e%448,i=n%32;for(i>0&&(t=r.bitArray.concat(t,[r.bitArray.partial(i,0)]));n>=32;n-=32)t.push(0);for(t.push(a(0|this._length)),t.push(a(Math.floor(this._length/4294967296)));t.length;){for(var s=t.splice(0,16),o=0;16>o;++o)s[o]=a(s[o]);c.call(this,s)}var u=this._h;this.reset();for(var o=0;5>o;++o)u[o]=a(u[o]);return u}};for(var u=[1732584193,4023233417,2562383102,271733878,3285377520],h=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0],l=4;l>=0;--l)for(var p=1;16>p;++p)h.splice(l,0,h[l]),f.splice(l,0,f[l]);var _=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}(),r.bn.ZERO=new r.bn(0),r.bn.prototype.divRem=function(t){"object"!=typeof t&&(t=new this._class(t));var e=this.abs(),n=t.abs(),i=new this._class(0),s=0;if(!e.greaterEquals(n))return[new r.bn(0),this.copy()];if(e.equals(n))return[new r.bn(1),new r.bn(0)];for(;e.greaterEquals(n);s++)n.doubleM();for(;s>0;s--)i.doubleM(),n.halveM(),e.greaterEquals(n)&&(i.addM(1),e.subM(t).normalize());return[i,e]},r.bn.prototype.divRound=function(t){var e=this.divRem(t),r=e[0],n=e[1];return n.doubleM().greaterEquals(t)&&r.addM(1),r},r.bn.prototype.div=function(t){var e=this.divRem(t);return e[0]},r.bn.prototype.sign=function(){return this.greaterEquals(r.bn.ZERO)?1:-1},r.bn.prototype.neg=function(){return r.bn.ZERO.sub(this)},r.bn.prototype.abs=function(){return-1===this.sign()?this.neg():this},r.bn.prototype.shiftRight=function(t){if("number"!=typeof t)throw new Error("shiftRight expects a number");if(t=+t,0>t)return this.shiftLeft(t);for(var e=new r.bn(this);t>=this.radix;)e.limbs.shift(),t-=this.radix;for(;t--;)e.halveM();return e},r.bn.prototype.shiftLeft=function(t){if("number"!=typeof t)throw new Error("shiftLeft expects a number");if(t=+t,0>t)return this.shiftRight(t);for(var e=new r.bn(this);t>=this.radix;)e.limbs.unshift(0),t-=this.radix;for(;t--;)e.doubleM();return e},r.bn.prototype.toNumber=function(){return 0|this.limbs[0]},r.bn.prototype.testBit=function(t){var e=Math.floor(t/this.radix),r=t%this.radix;return e>=this.limbs.length?0:this.limbs[e]>>>r&1},r.bn.prototype.setBitM=function(t){for(var e=Math.floor(t/this.radix),r=t%this.radix;e>=this.limbs.length;)this.limbs.push(0);return this.limbs[e]|=1<<r,this.cnormalize(),this},r.bn.prototype.modInt=function(t){return this.toNumber()%t},r.bn.prototype.invDigit=function(){var t=1+this.radixMask;if(this.limbs.length<1)return 0;var e=this.limbs[0];if(0==(1&e))return 0;var r=3&e;return r=r*(2-(15&e)*r)&15,r=r*(2-(255&e)*r)&255,r=r*(2-((65535&e)*r&65535))&65535,r=r*(2-e*r%t)%t,r>0?t-r:-r},r.bn.prototype.am=function(t,e,r,n,i,s){for(var o=4095&e,a=e>>12;--s>=0;){var c=4095&this.limbs[t],u=this.limbs[t++]>>12,h=a*c+u*o;c=o*c+((4095&h)<<12)+r.limbs[n]+i,i=(c>>24)+(h>>12)+a*u,r.limbs[n++]=16777215&c}return i};var n=function(t){this.m=t,this.mt=t.limbs.length,this.mt2=2*this.mt,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.radix-15)-1};n.prototype.reduce=function(t){for(var e=t.radixMask+1;t.limbs.length<=this.mt2;)t.limbs[t.limbs.length]=0;for(var r=0;r<this.mt;++r){var n=32767&t.limbs[r],i=n*this.mpl+((n*this.mph+(t.limbs[r]>>15)*this.mpl&this.um)<<15)&t.radixMask;for(n=r+this.mt,t.limbs[n]+=this.m.am(0,i,t,r,0,this.mt);t.limbs[n]>=e;)t.limbs[n]-=e,t.limbs[++n]++}return t.trim(),t=t.shiftRight(this.mt*this.m.radix),t.greaterEquals(this.m)&&(t=t.sub(this.m)),t.trim().normalize().reduce()},n.prototype.square=function(t){return this.reduce(t.square())},n.prototype.multiply=function(t,e){return this.reduce(t.mul(e))},n.prototype.convert=function(t){return t.abs().shiftLeft(this.mt*this.m.radix).mod(this.m)},n.prototype.revert=function(t){return this.reduce(t.copy())},r.bn.prototype.powermodMontgomery=function(t,r){var i,s=t.bitLength(),o=new this._class(1);if(0>=s)return o;if(i=18>s?1:48>s?3:144>s?4:768>s?5:6,8>s||!r.testBit(0))return this.powermod(t,r);var a=new n(r);t.trim().normalize();var c=new Array,u=3,h=i-1,f=(1<<i)-1;if(c[1]=a.convert(this),i>1)for(var l=a.square(c[1]);f>=u;)c[u]=a.multiply(l,c[u-2]),u+=2;var p,_,d=t.limbs.length-1,y=!0,m=new this._class;for(s=e(t.limbs[d])-1;d>=0;){for(s>=h?p=t.limbs[d]>>s-h&f:(p=(t.limbs[d]&(1<<s+1)-1)<<h-s,d>0&&(p|=t.limbs[d-1]>>this.radix+s-h)),u=i;0==(1&p);)p>>=1,--u;if((s-=u)<0&&(s+=this.radix,--d),y)o=c[p].copy(),y=!1;else{for(;u>1;)m=a.square(o),o=a.square(m),u-=2;u>0?m=a.square(o):(_=o,o=m,m=_),o=a.multiply(m,c[p])}for(;d>=0&&0==(t.limbs[d]&1<<s);)m=a.square(o),_=o,o=m,m=_,--s<0&&(s=this.radix-1,--d)}return a.revert(o)},r.ecc.ecdsa.secretKey.prototype={sign:function(t,e){var n=this._curve.r,i=n.bitLength(),s=r.bn.random(n.sub(1),e).add(1),o=this._curve.G.mult(s).x.mod(n),a=r.bn.fromBits(t).add(o.mul(this._exponent)).mul(s.inverseMod(n)).mod(n);return r.bitArray.concat(o.toBits(i),a.toBits(i))}},r.ecc.ecdsa.publicKey.prototype={verify:function(t,e){var n=r.bitArray,i=this._curve.r,s=i.bitLength(),o=r.bn.fromBits(n.bitSlice(e,0,s)),a=r.bn.fromBits(n.bitSlice(e,s,2*s)),c=a.modInverse(i),u=r.bn.fromBits(t).mul(c).mod(i),h=o.mul(c).mod(i),f=this._curve.G.mult2(u,h,this._point).x;if(o.equals(0)||a.equals(0)||o.greaterEquals(i)||a.greaterEquals(i)||!f.equals(o))throw new r.exception.corrupt("signature didn't check out");return!0}},r.ecc.ecdsa.secretKey.prototype.signDER=function(t,e){return this.encodeDER(this.sign(t,e))},r.ecc.ecdsa.secretKey.prototype.encodeDER=function(t){for(var e=r.bitArray,n=this._curve.r,i=n.bitLength(),s=r.codec.bytes.fromBits(e.bitSlice(t,0,i)),o=r.codec.bytes.fromBits(e.bitSlice(t,i,2*i));!s[0]&&s.length;)s.shift();for(;!o[0]&&o.length;)o.shift();128&s[0]&&s.unshift(0),128&o[0]&&o.unshift(0);var a=[].concat(48,4+s.length+o.length,2,s.length,s,2,o.length,o);return r.codec.bytes.toBits(a)},r.bn.prototype.jacobi=function(t){var e=this;if(t=new r.bn(t),-1!==t.sign()){if(e.equals(0))return 0;if(e.equals(1))return 1;for(var n=0,i=0;!e.testBit(i);)i++;var s=e.shiftRight(i);if(0===(1&i))n=1;else{var o=t.modInt(8);1===o||7===o?n=1:(3===o||5===o)&&(n=-1)}return 3===t.modInt(4)&&3===s.modInt(4)&&(n=-n),s.equals(1)?n:n*t.mod(s).jacobi(s)}}},function(t,e){function r(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function n(){return new r(null)}function i(t,e,r,n,i,s){for(;--s>=0;){var o=e*this[t++]+r[n]+i;i=Math.floor(o/67108864),r[n++]=67108863&o}return i}function s(t,e,r,n,i,s){for(var o=32767&e,a=e>>15;--s>=0;){var c=32767&this[t],u=this[t++]>>15,h=a*c+u*o;c=o*c+((32767&h)<<15)+r[n]+(1073741823&i),i=(c>>>30)+(h>>>15)+a*u+(i>>>30),r[n++]=1073741823&c}return i}function o(t,e,r,n,i,s){for(var o=16383&e,a=e>>14;--s>=0;){var c=16383&this[t],u=this[t++]>>14,h=a*c+u*o;c=o*c+((16383&h)<<14)+r[n]+i,i=(c>>28)+(h>>14)+a*u,r[n++]=268435455&c}return i}function a(t){return or.charAt(t)}function c(t,e){var r=ar[t.charCodeAt(e)];return null==r?-1:r}function u(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function h(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function f(t){var e=n();return e.fromInt(t),e}function l(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,s=!1,o=0;--i>=0;){var a=8==n?255&t[i]:c(t,i);0>a?"-"==t.charAt(i)&&(s=!0):(s=!1,0==o?this[this.t++]=a:o+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=n,o>=this.DB&&(o-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&r.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function _(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,s="",o=this.t,c=this.DB-o*this.DB%e;if(o-->0)for(c<this.DB&&(r=this[o]>>c)>0&&(i=!0,s=a(r));o>=0;)e>c?(r=(this[o]&(1<<c)-1)<<e-c,r|=this[--o]>>(c+=this.DB-e)):(r=this[o]>>(c-=e)&n,0>=c&&(c+=this.DB,--o)),r>0&&(i=!0),i&&(s+=a(r));return i?s:"0"}function d(){var t=n();return r.ZERO.subTo(this,t),t}function y(){return this.s<0?this.negate():this}function m(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function v(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function g(){return this.t<=0?0:this.DB*(this.t-1)+v(this[this.t-1]^this.s&this.DM)}function b(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function w(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function E(t,e){var r,n=t%this.DB,i=this.DB-n,s=(1<<i)-1,o=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+o+1]=this[r]>>i|a,a=(this[r]&s)<<n;for(r=o-1;r>=0;--r)e[r]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function x(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&s)<<i,e[o-r]=this[o]>>n;n>0&&(e[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function S(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);i>r;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=0>n?-1:0,-1>n?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}function A(t,e){var n=this.abs(),i=t.abs(),s=n.t;for(e.t=s+i.t;--s>=0;)e[s]=0;for(s=0;s<i.t;++s)e[s+n.t]=n.am(0,i[s],e,s,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)}function T(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function k(t,e,i){var s=t.abs();if(!(s.t<=0)){var o=this.abs();if(o.t<s.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),c=this.s,u=t.s,h=this.DB-v(s[s.t-1]);h>0?(s.lShiftTo(h,a),o.lShiftTo(h,i)):(s.copyTo(a),o.copyTo(i));var f=a.t,l=a[f-1];if(0!=l){var p=l*(1<<this.F1)+(f>1?a[f-2]>>this.F2:0),_=this.FV/p,d=(1<<this.F1)/p,y=1<<this.F2,m=i.t,g=m-f,b=null==e?n():e;for(a.dlShiftTo(g,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),r.ONE.dlShiftTo(f,b),b.subTo(a,a);a.t<f;)a[a.t++]=0;for(;--g>=0;){var w=i[--m]==l?this.DM:Math.floor(i[m]*_+(i[m-1]+y)*d);if((i[m]+=a.am(0,w,i,g,0,f))<w)for(a.dlShiftTo(g,b),i.subTo(b,i);i[m]<--w;)i.subTo(b,i)}null!=e&&(i.drShiftTo(f,e),c!=u&&r.ZERO.subTo(e,e)),i.t=f,i.clamp(),h>0&&i.rShiftTo(h,i),0>c&&r.ZERO.subTo(i,i)}}}function j(t){var e=n();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e}function B(t){this.m=t}function R(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function I(t){return t}function q(t){t.divRemTo(this.m,null,t)}function C(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function D(t,e){t.squareTo(e),this.reduce(e)}function O(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function L(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t){var e=n();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e}function N(t){var e=n();return t.copyTo(e),this.reduce(e),e}function F(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++
}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function P(t,e){t.squareTo(e),this.reduce(e)}function z(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function U(){return 0==(this.t>0?1&this[0]:this.s)}function H(t,e){if(t>4294967295||1>t)return r.ONE;var i=n(),s=n(),o=e.convert(this),a=v(t)-1;for(o.copyTo(i);--a>=0;)if(e.sqrTo(i,s),(t&1<<a)>0)e.mulTo(s,o,i);else{var c=i;i=s,s=c}return e.revert(i)}function V(t,e){var r;return r=256>t||e.isEven()?new B(e):new L(e),this.exp(t,r)}function G(){var t=n();return this.copyTo(t),t}function K(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function X(){return 0==this.t?this.s:this[0]<<24>>24}function Z(){return 0==this.t?this.s:this[0]<<16>>16}function J(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function $(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=f(r),s=n(),o=n(),a="";for(this.divRemTo(i,s,o);s.signum()>0;)a=(r+o.intValue()).toString(t).substr(1)+a,s.divRemTo(i,s,o);return o.intValue().toString(t)+a}function W(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),s=!1,o=0,a=0,u=0;u<t.length;++u){var h=c(t,u);0>h?"-"==t.charAt(u)&&0==this.signum()&&(s=!0):(a=e*a+h,++o>=n&&(this.dMultiply(i),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),s&&r.ZERO.subTo(this,this)}function Y(t,e,n){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(r.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(r.ONE.shiftLeft(t-1),this);else{var i=new Array,s=7&t;i.length=(t>>3)+1,e.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}function te(){var t=this.t,e=new Array;e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(t-->0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);t>=0;)8>n?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(e[i++]=r);return e}function ee(t){return 0==this.compareTo(t)}function re(t){return this.compareTo(t)<0?this:t}function ne(t){return this.compareTo(t)>0?this:t}function ie(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;s>n;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function se(t,e){return t&e}function oe(t){var e=n();return this.bitwiseTo(t,se,e),e}function ae(t,e){return t|e}function ce(t){var e=n();return this.bitwiseTo(t,ae,e),e}function ue(t,e){return t^e}function he(t){var e=n();return this.bitwiseTo(t,ue,e),e}function fe(t,e){return t&~e}function le(t){var e=n();return this.bitwiseTo(t,fe,e),e}function pe(){for(var t=n(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function _e(t){var e=n();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function de(t){var e=n();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function ye(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function me(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+ye(this[t]);return this.s<0?this.t*this.DB:-1}function ve(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function ge(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=ve(this[r]^e);return t}function be(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function we(t,e){var n=r.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n}function Ee(t){return this.changeBit(t,ae)}function xe(t){return this.changeBit(t,fe)}function Se(t){return this.changeBit(t,ue)}function Ae(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);i>r;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=0>n?-1:0,n>0?e[r++]=n:-1>n&&(e[r++]=this.DV+n),e.t=r,e.clamp()}function Te(t){var e=n();return this.addTo(t,e),e}function ke(t){var e=n();return this.subTo(t,e),e}function je(t){var e=n();return this.multiplyTo(t,e),e}function Be(){var t=n();return this.squareTo(t),t}function Re(t){var e=n();return this.divRemTo(t,e,null),e}function Ie(t){var e=n();return this.divRemTo(t,null,e),e}function qe(t){var e=n(),r=n();return this.divRemTo(t,e,r),new Array(e,r)}function Ce(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function De(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Oe(){}function Le(t){return t}function Me(t,e,r){t.multiplyTo(e,r)}function Ne(t,e){t.squareTo(e)}function Fe(t){return this.exp(t,new Oe)}function Pe(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;i>n;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);i>n;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()}function ze(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Ue(t){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function He(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=n();return t.copyTo(e),this.reduce(e),e}function Ve(t){return t}function Ge(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ke(t,e){t.squareTo(e),this.reduce(e)}function Xe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Ze(t,e){var r,i,s=t.bitLength(),o=f(1);if(0>=s)return o;r=18>s?1:48>s?3:144>s?4:768>s?5:6,i=8>s?new B(e):e.isEven()?new Ue(e):new L(e);var a=new Array,c=3,u=r-1,h=(1<<r)-1;if(a[1]=i.convert(this),r>1){var l=n();for(i.sqrTo(a[1],l);h>=c;)a[c]=n(),i.mulTo(l,a[c-2],a[c]),c+=2}var p,_,d=t.t-1,y=!0,m=n();for(s=v(t[d])-1;d>=0;){for(s>=u?p=t[d]>>s-u&h:(p=(t[d]&(1<<s+1)-1)<<u-s,d>0&&(p|=t[d-1]>>this.DB+s-u)),c=r;0==(1&p);)p>>=1,--c;if((s-=c)<0&&(s+=this.DB,--d),y)a[p].copyTo(o),y=!1;else{for(;c>1;)i.sqrTo(o,m),i.sqrTo(m,o),c-=2;c>0?i.sqrTo(o,m):(_=o,o=m,m=_),i.mulTo(m,a[p],o)}for(;d>=0&&0==(t[d]&1<<s);)i.sqrTo(o,m),_=o,o=m,m=_,--s<0&&(s=this.DB-1,--d)}return i.revert(o)}function Je(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(0>s)return e;for(s>i&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function $e(t){if(0>=t)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this[n])%t;return r}function Qe(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return r.ZERO;for(var n=t.clone(),i=this.clone(),s=f(1),o=f(0),a=f(0),c=f(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);n.compareTo(i)>=0?(n.subTo(i,n),e&&s.subTo(a,s),o.subTo(c,o)):(i.subTo(n,i),e&&a.subTo(s,a),c.subTo(o,c))}return 0!=i.compareTo(r.ONE)?r.ZERO:c.compareTo(t)>=0?c.subtract(t):c.signum()<0?(c.addTo(t,c),c.signum()<0?c.add(t):c):c}function We(t){var e,r=this.abs();if(1==r.t&&r[0]<=cr[cr.length-1]){for(e=0;e<cr.length;++e)if(r[0]==cr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<cr.length;){for(var n=cr[e],i=e+1;i<cr.length&&ur>n;)n*=cr[i++];for(n=r.modInt(n);i>e;)if(n%cr[e++]==0)return!1}return r.millerRabin(t)}function Ye(t){var e=this.subtract(r.ONE),i=e.getLowestSetBit();if(0>=i)return!1;var s=e.shiftRight(i);t=t+1>>1,t>cr.length&&(t=cr.length);for(var o=n(),a=0;t>a;++a){o.fromInt(cr[Math.floor(Math.random()*cr.length)]);var c=o.modPow(s,this);if(0!=c.compareTo(r.ONE)&&0!=c.compareTo(e)){for(var u=1;u++<i&&0!=c.compareTo(e);)if(c=c.modPowInt(2,this),0==c.compareTo(r.ONE))return!1;if(0!=c.compareTo(e))return!1}}return!0}var tr,er=0xdeadbeefcafe,rr=15715070==(16777215&er);rr&&"undefined"!=typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=s,tr=30):rr&&"undefined"!=typeof navigator&&"Netscape"!=navigator.appName?(r.prototype.am=i,tr=26):(r.prototype.am=o,tr=28),r.prototype.DB=tr,r.prototype.DM=(1<<tr)-1,r.prototype.DV=1<<tr;var nr=52;r.prototype.FV=Math.pow(2,nr),r.prototype.F1=nr-tr,r.prototype.F2=2*tr-nr;var ir,sr,or="0123456789abcdefghijklmnopqrstuvwxyz",ar=new Array;for(ir="0".charCodeAt(0),sr=0;9>=sr;++sr)ar[ir++]=sr;for(ir="a".charCodeAt(0),sr=10;36>sr;++sr)ar[ir++]=sr;for(ir="A".charCodeAt(0),sr=10;36>sr;++sr)ar[ir++]=sr;B.prototype.convert=R,B.prototype.revert=I,B.prototype.reduce=q,B.prototype.mulTo=C,B.prototype.sqrTo=D,L.prototype.convert=M,L.prototype.revert=N,L.prototype.reduce=F,L.prototype.mulTo=z,L.prototype.sqrTo=P,Oe.prototype.convert=Le,Oe.prototype.revert=Le,Oe.prototype.mulTo=Me,Oe.prototype.sqrTo=Ne,Ue.prototype.convert=He,Ue.prototype.revert=Ve,Ue.prototype.reduce=Ge,Ue.prototype.mulTo=Xe,Ue.prototype.sqrTo=Ke;var cr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ur=(1<<26)/cr[cr.length-1];r.prototype.chunkSize=J,r.prototype.toRadix=Q,r.prototype.fromRadix=W,r.prototype.fromNumber=Y,r.prototype.bitwiseTo=ie,r.prototype.changeBit=we,r.prototype.addTo=Ae,r.prototype.dMultiply=Ce,r.prototype.dAddOffset=De,r.prototype.multiplyLowerTo=Pe,r.prototype.multiplyUpperTo=ze,r.prototype.modInt=$e,r.prototype.millerRabin=Ye,r.prototype.copyTo=u,r.prototype.fromInt=h,r.prototype.fromString=l,r.prototype.clamp=p,r.prototype.dlShiftTo=b,r.prototype.drShiftTo=w,r.prototype.lShiftTo=E,r.prototype.rShiftTo=x,r.prototype.subTo=S,r.prototype.multiplyTo=A,r.prototype.squareTo=T,r.prototype.divRemTo=k,r.prototype.invDigit=O,r.prototype.isEven=U,r.prototype.exp=H,r.prototype.toString=_,r.prototype.negate=d,r.prototype.abs=y,r.prototype.compareTo=m,r.prototype.bitLength=g,r.prototype.mod=j,r.prototype.modPowInt=V,r.prototype.clone=G,r.prototype.intValue=K,r.prototype.byteValue=X,r.prototype.shortValue=Z,r.prototype.signum=$,r.prototype.toByteArray=te,r.prototype.equals=ee,r.prototype.min=re,r.prototype.max=ne,r.prototype.and=oe,r.prototype.or=ce,r.prototype.xor=he,r.prototype.andNot=le,r.prototype.not=pe,r.prototype.shiftLeft=_e,r.prototype.shiftRight=de,r.prototype.getLowestSetBit=me,r.prototype.bitCount=ge,r.prototype.testBit=be,r.prototype.setBit=Ee,r.prototype.clearBit=xe,r.prototype.flipBit=Se,r.prototype.add=Te,r.prototype.subtract=ke,r.prototype.multiply=je,r.prototype.divide=Re,r.prototype.remainder=Ie,r.prototype.divideAndRemainder=qe,r.prototype.modPow=Ze,r.prototype.modInverse=Qe,r.prototype.pow=Fe,r.prototype.gcd=Je,r.prototype.isProbablePrime=We,r.prototype.square=Be,r.ZERO=f(0),r.ONE=f(1),r.valueOf=n,e.BigInteger=r},function(t){function e(t,e){var r;return r=e?new n(t,e):new n(t)}var r=function(){return this}(),n=r.WebSocket||r.MozWebSocket;t.exports=n?e:null,n&&(e.prototype=n.prototype)}]);